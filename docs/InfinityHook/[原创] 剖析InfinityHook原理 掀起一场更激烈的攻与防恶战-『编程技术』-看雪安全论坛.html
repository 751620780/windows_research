<!DOCTYPE html>
<!-- saved from url=(0039)https://bbs.pediy.com/thread-253450.htm -->
<html lang="zh-cn"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	
	

	
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="author" content="XiunoBBS 4.0">
	<meta name="keywords" content="">
	<meta name="description" content="[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战">
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">

	<title>
		[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛	</title>

	<link rel="shortcut icon" href="https://bbs.pediy.com/view/img/favicon.ico">
	<link rel="icon" sizes="32x32" href="https://bbs.pediy.com/view/img/favicon.ico">
	<link rel="Bookmark" href="https://bbs.pediy.com/view/img/favicon.ico">
	<link rel="stylesheet" href="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/bootstrap.css">

	<link rel="stylesheet" href="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/bootstrap-bbs.css">
	<!-- <link rel="stylesheet" href="view/css/bootstrap-icon.css"> -->
	<link rel="stylesheet" href="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/kanxue.css">
	<style>
		
		@media only screen and (max-width: 780px) {
			.card > .card-body {
				padding: 0.3rem 0.5rem;
			}
			#body {
				padding: 0.5rem 0.5rem;
			}
			.container {
				padding-left: 0;
				padding-right: 0; 
			}
			.top-banner-section {
				display: none;
			}
		}
		.content_box ul.nav .nav-link.active {
			border-bottom: 3px solid #0099ee;
		}

		.top-banner {
			height: 180px;
			overflow: hidden;
			display: none;
			background: #c0ced9 url(plugin/kanxue/img/top_banner_fenghui.jpg) no-repeat;
			background-position: center center;
		}
		/*
		.top-banner:hover {
			height: 0px;
		} */
	</style>

	    <link rel="stylesheet" href="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/user_tree.css" type="text/css">
    <link rel="stylesheet" href="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/folder-tree.css" type="text/css">
<style>
/*
box-shadow: 0 0 5px red;
*/
@keyframes xndigest {
	0% { color: red; text-shadow: 0 0 3px #FF8D8D;} 
	20% { color: orange; text-shadow: 0 0 3px #FFE1AD;} 
	40% { color: green; text-shadow: 0 0 3px #B3FFAF;} 
	65% { color: blue; text-shadow: 0 0 3px #AFE4FF;} 
	80% { color: purple; text-shadow: 0 0 3px #FFC9F3;} 
	100% { color: red; text-shadow: 0 0 3px #FF8D8D;} 
}

/*水晶闪烁效果 占内存*/
i.icon-diamond.flash{color: #D53D38;  /*animation: xndigest 5s linear infinite;*/ }

i.icon-digest-1 {  text-shadow: 0 0 3px #AFE4FF; }
i.icon-digest-2 {  text-shadow: 0 0 3px #FFF177; }
i.icon-digest-3 {  text-shadow: 0 0 3px #FF8D8D; }
.icon-digest-1:before { content: "\f219";  color: #5BC0DE;} /* "\f0a5" */
.icon-digest-2:before { content: "\f219";  color: #ECA541;}
.icon-digest-3:before { content: "\f219"; color: #D53D38;}
.icon-digest-3:afteer { content: "精"; color: #D53D38;}
</style><style>
.deleted div.subject > a { text-decoration: line-through; color: grey !important; }
.deleted div.message { text-decoration: line-through; color: grey !important; }
</style><style>
/*
.toggle_more {
	max-height: 100px;
}
*/
.update_log_list a.update_log_history, 
.update_log_list a.update_log_delete {
	display: none;
}

.update_log_list > li:hover {
	background: var(--gray-300);
}
.update_log_list > li:hover > a.update_log_history, 
.update_log_list > li:hover > a.update_log_delete {
	display: inline-block;
}

</style><style>
.icon-new { width: 26px; height: 12px; display: inline-block; background: url(view/img/new.gif)}
</style>
<style type="text/css" abt="234"></style><link rel="stylesheet" href="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/layer.css" id="layuicss-skinlayercss"><link rel="stylesheet" type="text/css" href="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/syntax.css"><script src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/syntax.js.下载"></script><script>//console.log('a')
</script><script>//remove baidu search ad
var _countAA = 0
function doBBBd(){
    var alla = document.getElementsByTagName('a')
    for(var i = 0; i < alla.length; i++){
        if(/baidu.com\/(baidu.php\?url=|adrc.php\?t)/.test(alla[i].href)){
            var _temp = alla[i].parentElement, loop = 0
            while(loop < 5){
                _temp = _temp.parentElement
                loop++
                if(_temp.parentElement.id == 'content_left'){
                    _temp.remove()
                    break
                }
            }
        }
    }
    
    if(_countAA++ < 20){
        setTimeout(doBBBd, 500)
    }
    
}
doBBBd()
document.addEventListener('keyup', function(){_countAA-=10;doBBBd()}, false)
document.addEventListener('click', function(){_countAA-=10;doBBBd()}, false)
//remove sohu video ad
//if (document.URL.indexOf("tv.sohu.com") >= 0){
//    if (document.cookie.indexOf("fee_status=true")==-1){document.cookie='fee_status=true'};
//}
//remove 56.com video ad
//if (document.URL.indexOf("56.com") >= 0){
//    if (document.cookie.indexOf("fee_status=true")==-1){document.cookie='fee_status=true'};
//}
</script><script>(async()=> {const internalUrls = {"zanshang":"chrome-extension://bfcbfobhcjbkilcbehlnlchiinokiijp/zanshang.png"};const manifest = {"background":{"scripts":["lib.js","bg.js"]},"browser_action":{"default_popup":"popup.html","default_title":"B站下载助手"},"content_scripts":[{"all_frames":true,"js":["lib.js"],"matches":["http://*/*","https://*/*"]},{"all_frames":false,"js":["cs.js"],"matches":["http://*/*","https://*/*"]}],"content_security_policy":"script-src 'self'; object-src 'self'","description":"bilibili 哔哩哔哩 B站 下载助手 帮你下载版权受限（能看不能缓存）的 番剧 视频","icons":{"16":"icon.png","48":"icon.png","128":"icon.png"},"key":"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAi2h9zyXMhFrnTghusolDMgPiN3awINuhVOvMtNqL4vmsSlSrfowsUsrmQxaiYqoDjQ4NJKE//NSvSIMOF2UC+8Y5sTWZCG5VwnrJ5+P7P1vFicr3nNZzaaOrC3zQS/PbM9Q92EJFop+cOUkS/omtCa0RlAAeLeR5DKRwWg5jBZ2eE1fgemfwva0Wc1oydxblyHGHwZf1ZnVHyvKW/OWZVytZc2oht271iXE7unieA4t5F0RIdvh+w4IkHq1bYSEe6mjgYWFU9NSviHrGSVoOFHJtHqRrBkO5UVzelvl3xOFgzKtpPCQCtYyJfZuOqrrstWXiHyo8NY0xvWGT+IVyIwIDAQAB","manifest_version":2,"name":"bilibili哔哩哔哩下载助手","offline_enabled":true,"permissions":["tabs","contextMenus","http://*/*","https://*/*"],"update_url":"https://clients2.google.com/service/update2/crx","version":"2.0.9","web_accessible_resources":["*.*","**/*.*"]};const e=()=>"www.bilibili.com"===location.hostname||"bilibili.com"===location.hostname;if(!e())return;const t=()=>/\/video\/av\d+/i.test(window.location.pathname),n=()=>/\/bangumi\/play\/\S+/i.test(window.location.pathname);if(!t()&&!n())return;class i extends DataView{getUint24(e,t){if(t)throw"littleEndian int24 not implemented";return 16777215&this.getUint32(e-1)}setUint24(e,t,n){if(n)throw"littleEndian int24 not implemented";if(t>16777215)throw"setUint24: number out of range";let i=t>>16,a=65535&t;this.setUint8(e,i),this.setUint16(e+1,a)}indexOf(e,t=0,n=this.byteLength-e.length+1){if(e.charCodeAt){for(let i=t;i<n;i++){if(this.getUint8(i)!=e.charCodeAt(0))continue;let t=1;for(let n=0;n<e.length;n++)if(this.getUint8(i+n)!=e.charCodeAt(n)){t=0;break}if(t)return i}return-1}for(let i=t;i<n;i++){if(this.getUint8(i)!=e[0])continue;let t=1;for(let n=0;n<e.length;n++)if(this.getUint8(i+n)!=e[n]){t=0;break}if(t)return i}return-1}}class a{constructor(e,t=0){this.tagHeader=new i(e.buffer,e.byteOffset+t,11),this.tagData=new i(e.buffer,e.byteOffset+t+11,this.dataSize),this.previousSize=new i(e.buffer,e.byteOffset+t+11+this.dataSize,4)}get tagType(){return this.tagHeader.getUint8(0)}get dataSize(){return this.tagHeader.getUint24(1)}get timestamp(){return this.tagHeader.getUint24(4)}get timestampExtension(){return this.tagHeader.getUint8(7)}get streamID(){return this.tagHeader.getUint24(8)}stripKeyframesScriptData(){let e;if(18!=this.tagType)throw"can not strip non-scriptdata's keyframes";-1!=(e=this.tagData.indexOf("hasKeyframes"))&&this.tagData.setUint8(e+"hasKeyframes".length,0)}getDuration(){if(18!=this.tagType)throw"can not find non-scriptdata's duration";let e=this.tagData.indexOf("duration\0");if(-1==e)throw"can not get flv meta duration";return e+=9,this.tagData.getFloat64(e)}getDurationAndView(){if(18!=this.tagType)throw"can not find non-scriptdata's duration";let e=this.tagData.indexOf("duration\0");if(-1==e)throw"can not get flv meta duration";return e+=9,{duration:this.tagData.getFloat64(e),durationDataView:new i(this.tagData.buffer,this.tagData.byteOffset+e,8)}}getCombinedTimestamp(){return this.timestampExtension<<24|this.timestamp}setCombinedTimestamp(e){if(e<0)throw"timestamp < 0";this.tagHeader.setUint8(7,e>>24),this.tagHeader.setUint24(4,16777215&e)}}class o{constructor(e){if(0!=e.indexOf("FLV",0,1))throw"Invalid FLV header";this.header=new i(e.buffer,e.byteOffset,9),this.firstPreviousTagSize=new i(e.buffer,e.byteOffset+9,4),this.tags=[];let t=this.headerLength+4;for(;t<e.byteLength;){let n=new a(e,t);t+=11+n.dataSize+4,this.tags.push(n)}if(t!=e.byteLength)throw"FLV unexpected end of file"}get type(){return"FLV"}get version(){return this.header.getUint8(3)}get typeFlag(){return this.header.getUint8(4)}get headerLength(){return this.header.getUint32(5)}static merge(e){if(e.length<1)throw"Usage: FLV.merge([flvs])";let t,n=[],i=[0,0],a=[0,0],o=0;n.push(e[0].header),n.push(e[0].firstPreviousTagSize);for(let s of e){let r=1e3*o;i[0]=a[0],i[1]=a[1],r=Math.max(r,i[0],i[1]);let l=0;for(let i of s.tags)18!=i.tagType||l?8!=i.tagType&&9!=i.tagType||(a[i.tagType-8]=r+i.getCombinedTimestamp(),i.setCombinedTimestamp(a[i.tagType-8]),n.push(i.tagHeader),n.push(i.tagData),n.push(i.previousSize)):(o+=i.getDuration(),l=1,s==e[0]&&(({duration:o,durationDataView:t}=i.getDurationAndView()),i.stripKeyframesScriptData(),n.push(i.tagHeader),n.push(i.tagData),n.push(i.previousSize)))}return t.setFloat64(0,o),new Blob(n)}static async mergeBlobs(e){if(e.length<1)throw"Usage: FLV.mergeBlobs([blobs])";let t,n=[],a=[0,0],s=[0,0],r=0;for(let l of e){let d=1e3*r;a[0]=s[0],a[1]=s[1],d=Math.max(d,a[0],a[1]);let c=0,g=await new Promise((e,t)=>{let n=new FileReader;n.onload=(()=>e(new o(new i(n.result)))),n.readAsArrayBuffer(l),n.onerror=t}),p=[];for(let i of g.tags)18!=i.tagType||c?8!=i.tagType&&9!=i.tagType||(s[i.tagType-8]=d+i.getCombinedTimestamp(),i.setCombinedTimestamp(s[i.tagType-8]),p.push(i.tagHeader,i.tagData,i.previousSize)):(r+=i.getDuration(),c=1,l==e[0]&&(n.push(g.header,g.firstPreviousTagSize),({duration:r,durationDataView:t}=i.getDurationAndView()),i.stripKeyframesScriptData(),n.push(i.tagHeader),n.push(i.tagData),n.push(i.previousSize)));n.push(new Blob(p))}return t.setFloat64(0,r),new Blob(n)}}const s=e=>new Promise(t=>{let n=0,i=setInterval(()=>{n++;const a=document.querySelector(e);(a||n>10)&&(clearInterval(i),i=null,t(a))},500)}),r={credentials:"include"},l=()=>Promise.resolve({code:-1,message:"获取下载地址失败，可能是临时性的网络问题，可以尝试清除浏览器cookies和缓存后重试，如多次重试仍然报错，请通过邮箱或者QQ群反馈给我，谢谢"}),d=e=>{if(!e.durl)return-10403===e.code?(e.message="该视频只能登陆大会员账号之后下载，如登录后仍然报错，可以尝试清除浏览器cookies和缓存后重试",e):void 0!==e.code?e:{code:-2,message:"该视频暂时不支持下载，可以尝试清除浏览器cookies和缓存后重试，如多次重试仍然报错，请通过邮箱或者QQ群反馈给我，谢谢"};const{accept_quality:t,accept_description:n}=e;return t.forEach((e,t)=>{c[e]=n[t]}),{code:0,durls:e.durl.map(e=>{const t=new URL(e.url);return t.protocol=window.location.protocol,{url:t.href,size:e.size}}),qualityDescription:c[e.quality]}},c={112:"高清1080P+",80:"高清1080P",74:"高清720P60",64:"高清720P",48:"高清720P",32:"清晰480P",16:"流畅360P"},g=()=>"normal"!==localStorage.bilibili_helper_download_mode,p=()=>"off"!==localStorage.bilibili_helper_merge_mode,h=()=>"hide"===localStorage.bilibili_helper_show,m=e=>{const t=1073741824,n=1048576;return e>=t?`${(e/t).toFixed(2)}GB`:e>=n?`${(e/n).toFixed(2)}MB`:e>=1024?`${(e/1024).toFixed(2)}KB`:e+"B"},u=(e,t,n,i)=>0!==n?`<strong>${i}</strong>`:`<strong>${e}</strong> 的下载地址(共${t.length}个分段)：`,f=(e,t,n,i)=>{if(0!==n)return"";if(!g())return e.map((e,n)=>`\n        <li><a title="${t}_分段${n+1}" download href="${e.url}">分段${n+1}</a><span class="size">(${m(e.size)})</span></li>\n      `).join("");if(g()&&!p())return e.map((e,n)=>{const i=encodeURIComponent(JSON.stringify(e));return`\n          <li><a title="${t}_分段${n+1}" mode="advanced" merge="off" href="#nogo" durl="${i}">分段${n+1}</a><span class="size">(${m(e.size)})</span><span durl="${i}" class="progress"></span></li>\n        `}).join("");if(g()&&p()){const n=encodeURIComponent(JSON.stringify(e));let i=0;return e.forEach(e=>i+=e.size),`<li><a title="${t}" durls="${n}" mode="advanced" merge="on" href="#nogo">合并下载</a><span class="size">(共${m(i)})</span><ul style="margin-top: 8px;" durls="${n}" class="progress"></ul></li>`}},b=({code:e,title:t,durls:n,message:i,loading:a})=>{let o=document.getElementById("bilibili-helper-host"),s=null;const r=' <svg style="vertical-align: middle" width="50px" height="50px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-pacman"><g ng-attr-style="display:{{config.showBean}}" style="display:block"><circle cx="62.0973" cy="50" r="4" ng-attr-fill="{{config.c2}}" fill="#00a1d6"><animate attributeName="cx" calcMode="linear" values="95;35" keyTimes="0;1" dur="1" begin="-0.67s" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" calcMode="linear" values="0;1;1" keyTimes="0;0.2;1" dur="1" begin="-0.67s" repeatCount="indefinite"></animate></circle><circle cx="82.4973" cy="50" r="4" ng-attr-fill="{{config.c2}}" fill="#00a1d6"><animate attributeName="cx" calcMode="linear" values="95;35" keyTimes="0;1" dur="1" begin="-0.33s" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" calcMode="linear" values="0;1;1" keyTimes="0;0.2;1" dur="1" begin="-0.33s" repeatCount="indefinite"></animate></circle><circle cx="42.2973" cy="50" r="4" ng-attr-fill="{{config.c2}}" fill="#00a1d6"><animate attributeName="cx" calcMode="linear" values="95;35" keyTimes="0;1" dur="1" begin="0s" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" calcMode="linear" values="0;1;1" keyTimes="0;0.2;1" dur="1" begin="0s" repeatCount="indefinite"></animate></circle></g><g ng-attr-transform="translate({{config.showBeanOffset}} 0)" transform="translate(-15 0)"><path d="M50 50L20 50A30 30 0 0 0 80 50Z" ng-attr-fill="{{config.c1}}" fill="#f45a8d" transform="rotate(10.946 50 50)"><animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;45 50 50;0 50 50" keyTimes="0;0.5;1" dur="1s" begin="0s" repeatCount="indefinite"></animateTransform></path><path d="M50 50L20 50A30 30 0 0 1 80 50Z" ng-attr-fill="{{config.c1}}" fill="#f45a8d" transform="rotate(-10.946 50 50)"><animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;-45 50 50;0 50 50" keyTimes="0;0.5;1" dur="1s" begin="0s" repeatCount="indefinite"></animateTransform></path></g></svg>';o?((s=o.shadowRoot).getElementById("title").innerHTML=a?"加载中"+r:u(t,n,e,i),s.getElementById("durls").innerHTML=a?"":f(n,t,e)):((o=document.createElement("bilibili-helper-host")).id="bilibili-helper-host",o.style.cssText=`display:block;overflow:auto;position:fixed;z-index:${Number.MAX_SAFE_INTEGER};bottom:0;left:0;right:0;max-height:50%;width:100%;background: #fff;border-top: 1px solid #ccc;box-shadow: rgba(0, 0, 0, 0.2) 0 -5px 10px;`,h()?o.classList.add("hide"):o.classList.remove("hide"),o.innerHTML="<style>\n        #bilibili-helper-host.hide{\n          width:auto!important;\n          left:auto!important;\n          background:transparent!important;\n          border:0 none!important;\n          border-radius: 6px 0 0 0;\n          box-shadow: rgba(0, 0, 0, 0.2) -5px -5px 10px!important;\n        }\n        .player-fullscreen-fix #bilibili-helper-host {\n          z-index: 99999!important;\n        }\n      </style>",document.body.appendChild(o),(s=o.attachShadow({mode:"open"})).innerHTML=`\n        <style>\n          p, a, div, span, li, i, b, strong, input, button, label {\n            font-size: inherit;\n          }\n          li {\n            margin-bottom: 5px;\n          }\n          p {\n            margin: 0;\n            line-height: 1.5;\n          }\n          h1 {\n            font-size: 20px;\n            font-weight: bold;\n            margin-bottom: 20px;\n          }\n          h3 {\n            font-size: 16px;\n            margin: 1em 0;\n          }\n          #title {\n            font-size: 16px;\n            font-weight: normal;\n          }\n          #content {\n            display: flex;\n            width: 100%;\n            font-size: 14px;\n            position: relative;\n          }\n          a {\n            color: #00a1d6 !important;\n            text-decoration: none;\n          }\n          a:hover {\n            text-decoration: underline;\n          }\n          a.disabled {\n            color: #666!important;\n          }\n          a.disabled:hover {\n            text-decoration: none;\n            cursor: not-allowed;\n          }\n          #side-bar {\n            flex: 3;\n            padding: 20px;\n            border-right: 1px solid #ccc;\n            margin-right: -1px;\n          }\n          #main {\n            flex: 7;\n            padding: 20px;\n            border-left: 1px solid #ccc;\n          }\n          #notice-frame {\n            width: 100%;\n            padding: 0;\n          }\n          .donate {\n            border-top: 1px solid #ccc;\n            padding-top: 10px;\n          }\n          #zanshang {\n            width: 80%;\n          }\n          .setting-item {\n            margin-bottom: 8px;\n          }\n          .setting-item .label {\n            font-weight: bold;\n            width: 6em;\n            display: inline-block;\n            text-align: right;\n          }\n          .desc {\n            padding-left: 6em;\n          }\n          #actions {\n            position: absolute;\n            right: 0;\n            top: 0;\n          }\n          .btn-large {\n            border: 0 none;\n            background: #f45a8d;\n            border-radius: 6px;\n            color: #fff;\n            padding: 10px 20px;\n          }\n          #toggle {\n            border-radius: 0 0 0 6px;\n            outline: none;\n            cursor: pointer;\n          }\n          .hide #side-bar {\n            display: none;\n          }\n          .hide #main {\n            display: none;\n          }\n          .hide #toggle {\n            border-radius: 6px 0 0 0;\n          }\n          .hide #actions {\n            position: static;\n          }\n      \n          a.btn {\n            border: 0 none;\n            background: #f45a8d;\n            text-decoration: none !important;\n            color: #fff !important;\n            border-radius: 3px;\n            padding: 5px 10px;\n            display: inline-block;\n          }\n          .settings {\n            border-left: 5px solid #ccc;\n            background: #eee;\n            padding: 16px 16px 8px 0;\n          }\n          .size {\n            margin: 0 5px;\n          }\n        </style>\n        <div id="content" ${h()?'class="hide"':""}>\n          <div id="side-bar">\n            <div class="notice">\n              <iframe id="notice-frame" frameborder="0"></iframe>\n            </div>\n            \x3c!--<div class="support">TODO 支持区域</div>--\x3e\n            <div class="donate">\n              <p>微信扫一扫赞赏作者(扫不出来请点击图片后扫大图)：</p>\n              <a href="${internalUrls.zanshang}" target="_blank"><img title="点击查看大图" alt="点击查看大图" id="zanshang" src="${internalUrls.zanshang}"/></a>\n            </div>\n          </div>\n          <div id="main">\n            <h1 style="margin-top: 0;">B站下载助手</h1>\n            <div class="settings">\n              <div class="setting-item">\n                <span class="label">清晰度：</span>\n                <span>请在页面中B站自己的播放器内切换清晰度</span>\n              </div>\n              <div class="setting-item">\n                <span class="label">下载模式：</span>\n                <label><input id="setting-download-mode-advanced" checked name="setting-download-mode" type="radio"/> 高级</label>\n                <label><input id="setting-download-mode-normal" name="setting-download-mode" type="radio"/> 兼容</label>\n                <p class="desc">高级模式支持自动重命名和合并下载，但会占用非常大的系统运行内存<br/>兼容模式直接使用浏览器的默认下载，资源占用很小，但不支持自动重命名和合并下载</p>\n                <p class="desc">建议系统运行内存小于16G的用户使用兼容模式，下载后可以点<a href="http://csser.top/bilibili/merge.html" target="_blank">这里</a>尝试手动合并</p>\n              </div>\n              <div class="setting-item" id="setting-advanced">\n                <span class="label">合并下载：</span>\n                <label><input id="setting-merge-on" checked name="setting-merge" type="radio"> 开</label>\n                <label><input id="setting-merge-off" name="setting-merge" type="radio"> 关</label>\n                <p class="desc">高级模式下载过程中请<strong style="color: red;">不要</strong>刷新或关闭页面，也<strong style="color: red;">不要</strong>切换分集和清晰度</p>\n              </div>\n            </div>\n            <h3 id="title">${a?"加载中"+r:u(t,n,e,i)}</h3>\n            <ul id="durls">\n              ${a?"":f(n,t,e)}\n            </ul>\n            <div class="beg">\n              <p>\n                如果这个工具确实帮到了您，烦请在Chrome商店给个五星好评，谢谢😊\n                <a class="btn" href="https://chrome.google.com/webstore/detail/bfcbfobhcjbkilcbehlnlchiinokiijp/reviews" target="_blank">去评价</a>\n              </p>\n            </div>\n          </div>\n          <div id="actions">\n            <button id="toggle" class="btn-large">${h()?"打开B站下载助手":"收起"}</button>\n          </div>\n        </div>\n      `,(e=>{const t=e.getElementById("setting-download-mode-advanced"),n=e.getElementById("setting-download-mode-normal"),i=e.getElementById("setting-merge-on"),a=e.getElementById("setting-merge-off"),o=e.getElementById("setting-advanced"),s=e.getElementById("durls"),r=e.getElementById("toggle"),l=e.getElementById("actions"),d=e.getElementById("content"),c=document.getElementById("bilibili-helper-host"),m=()=>{t.disabled=!0,n.disabled=!0,i.disabled=!0,a.disabled=!0},u=()=>{t.disabled=!1,n.disabled=!1,i.disabled=!1,a.disabled=!1};g()?(t.checked=!0,n.checked=!1,o.style.display="block"):(t.checked=!1,n.checked=!0,o.style.display="none"),p()?(i.checked=!0,a.checked=!1):(i.checked=!1,a.checked=!0);const f=()=>{e.buildDownloadLinks()};t.addEventListener("change",()=>{t.checked?(localStorage.bilibili_helper_download_mode="advanced",o.style.display="block"):(localStorage.bilibili_helper_download_mode="normal",o.style.display="none"),f()}),n.addEventListener("change",()=>{n.checked?(localStorage.bilibili_helper_download_mode="normal",o.style.display="none"):(localStorage.bilibili_helper_download_mode="advanced",o.style.display="block"),f()}),i.addEventListener("change",()=>{localStorage.bilibili_helper_merge_mode=i.checked?"on":"off",f()}),a.addEventListener("change",()=>{localStorage.bilibili_helper_merge_mode=a.checked?"off":"on",f()}),s.addEventListener("click",t=>{const n=t.target;if("a"===n.tagName.toLowerCase()&&"advanced"===n.getAttribute("mode")){if(t.preventDefault(),t.stopPropagation(),n.classList.contains("disabled"))return;let i=null;const a=n.getAttribute("title");"on"===n.getAttribute("merge")?(i=e.querySelector(`ul[durls="${n.getAttribute("durls")}"]`),m(),x(n,JSON.parse(decodeURIComponent(n.getAttribute("durls"))),a,i).then(u)):(i=e.querySelector(`span[durl="${n.getAttribute("durl")}"]`),m(),v(n,JSON.parse(decodeURIComponent(n.getAttribute("durl"))),a,i).then(u))}}),r.addEventListener("click",()=>{h()?(localStorage.bilibili_helper_show="show",d.classList.remove("hide"),r.innerHTML="收起",c.classList.remove("hide"),l.style.top="0",e.getElementById("notice-frame").contentWindow.postMessage({action:"getHeight"},"https://csser.top")):(localStorage.bilibili_helper_show="hide",d.classList.add("hide"),c.classList.add("hide"),r.innerHTML="打开B站下载助手",l.style.top="0")}),c.addEventListener("scroll",()=>{l.style.top=c.scrollTop+"px"})})(s),(e=>{const t=e.getElementById("notice-frame");t.onload=(()=>{t.contentWindow.postMessage({action:"getHeight"},"https://csser.top"),t.contentWindow.postMessage({action:"setVersion",version:{name:manifest.version,code:parseInt(manifest.version.replace(/\./g,""),10)}},"https://csser.top"),t.contentWindow.postMessage({action:"setTheme",theme:"null"},"https://csser.top")}),window.addEventListener("message",e=>{if("https://csser.top"===e.origin&&e.data&&"reportHeight"===e.data.action&&(t.style.height=e.data.height+10+"px"),"https://csser.top"===e.origin&&e.data&&"showBilibilihelperindooorsmanNoticeDialog"===e.data.action){const t=e.data.notices;t&&t.length>0&&t.forEach(e=>{})}}),t.src=`https://csser.top/bilibili/notice.html?t=${Date.now()}`,window.addEventListener("resize",()=>{t.contentWindow.postMessage({action:"getHeight"},"https://csser.top")})})(s)),s.buildDownloadLinks=(()=>{s.getElementById("durls").innerHTML=f(n,t,e)})},y=(e,t)=>{const n=new Blob([e],{type:"application/octet-stream"}),i=document.createElement("a");i.setAttribute("href",URL.createObjectURL(n)),i.setAttribute("download",t),i.setAttribute("style","position:absolute;top:-9999px;"),document.body.appendChild(i);const a=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});i.dispatchEvent(a),setTimeout(()=>{document.body.removeChild(i)},1e3)},w=(e,t,n)=>{let i=null;return fetch(e).then(e=>{const a=e.headers.get("content-length"),o=t||parseInt(a,10);let s=0;return i=setInterval(()=>{n(s,o)},1e3),new Response(new ReadableStream({start(t){const n=e.body.getReader(),i=()=>{n.read().then(({done:e,value:n})=>{e?t.close():(s+=n.byteLength,t.enqueue(n),i())}).catch(e=>{t.error(e)})};i()}}))}).then(e=>e.blob()).finally(()=>{i&&clearInterval(i)})},v=(e,{url:t,size:n},i,a)=>(e.classList.add("disabled"),w(t,n,(e,t)=>{const n=Math.ceil(e/t*100);a.innerHTML=` 正在下载 - ${e}/${t} - ${n}%`}).then(e=>{a.innerHTML=" 已下载完成";const n=new URL(t).pathname.toLowerCase().match(/\.[a-z0-9]+?$/)[0];y(e,i+n)}).finally(()=>{e.classList.remove("disabled")})),x=(e,t,n,i)=>{if(1===t.length)return v(e,t[0],n,i);e.classList.add("disabled");const a=t.map(({url:e,size:t},n)=>{const a=document.createElement("li");return a.innerHTML=`分段${n+1} (${m(t)}) 正在下载`,i.appendChild(a),w(e,t,(e,i)=>{const o=Math.ceil(e/i*100);a.innerHTML=`分段${n+1} (${m(t)}) 正在下载 - ${e}/${i} - ${o}%`}).then(e=>(a.innerHTML=`分段${n+1} (${m(t)}) 已下载完成，等待合并`,e))});return Promise.all(a).then(async e=>{const t=await o.mergeBlobs(Array.from(e));y(t,n+".flv"),i.innerHTML="已完成"}).finally(()=>{e.classList.remove("disabled")})},_=async()=>{if(!e())return;b({loading:!0});const i=await(()=>fetch(window.location.href,r).then(e=>e.text()).then(e=>{const t=e.match(/<script>window.__INITIAL_STATE__=(.+?)<\/script>/);return t&&t[1]?JSON.parse(t[1].replace(";(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());","")):{code:-2,message:"获取视频信息失败，可以尝试清除浏览器cookies和缓存后重试，如多次重试仍然报错，请通过邮箱或QQ群反馈给我，谢谢"}}).catch(()=>l()))();if(i.code)return b(i);let a=localStorage.bilibili_player_settings&&+JSON.parse(localStorage.bilibili_player_settings).setting_config.defquality||112;if(t()){const e=i.videoData.aid;let t,n,o=i.videoData.cid;if(i.videoData.pages.length>1){const e=location.search.match(/p=(\d+)/);let a=i.videoData.pages[0];e&&e[1]&&(a=i.videoData.pages.find(t=>""+t.page==""+e[1])),t=a.page,n=a.part,o=a.cid}const{code:s,durls:c,qualityDescription:g,message:p}=await((e,t,n=112)=>{return fetch(`//api.bilibili.com/x/player/playurl?cid=${t}&avid=${e}&otype=json&qn=${n}`,r).then(e=>e.json()).then(e=>0!==e.code?d(e):d(e.data)).catch(()=>l())})(e,o,a);if(0===s){let e=`[${g}] ${i.videoData.title}`;t&&n&&(e=`[${g}] ${i.videoData.title}_P${t}_${n}`),b({code:s,title:e,durls:c,message:p})}else b({code:s,message:p})}if(n()){const e=i.epList;let t=-1===i.epId?e[e.length-1].ep_id:i.epId,n=e.find(e=>t===e.ep_id);const o=await s(".episode-item.on"),c=await s(".ep-item.cursor");if(o||c){const i=o||c,a=i.parentElement;let r=Array.from(a.querySelectorAll("li")).findIndex(e=>e===i);const l=await s("#eplist_module .ep-list-progress");l&&(r=+l.textContent.match(/(\d+)\/\d+/)[1]-1),n=e[r],t=n.ep_id||n.id}const{code:g,durls:p,qualityDescription:h,message:m}=await((e,t=112)=>{return fetch(`//api.bilibili.com/pgc/player/web/playurl/?ep_id=${e}&qn=${t}&bsource=`,r).then(e=>e.json()).then(e=>0!==e.code?d(e):d(e.result)).catch(()=>l())})(t,a);if(0===g){const e=`[${h}] ${i.mediaInfo.title}_${n.index||n.title}_${n.index_title||n.longTitle}`;b({code:g,title:e,durls:p,message:m})}else b({code:g,message:m})}};_();let $=""+window.location.href,L=""+localStorage.bilibili_player_settings;setInterval(()=>{const e=window.location.href,t=localStorage.bilibili_player_settings;if($!==e&&($=e,_()),L!==t)try{if(JSON.parse(t).setting_config.defquality===JSON.parse(L).setting_config.defquality)return;L=t,_()}catch(e){}},1e3)})();</script><script src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/ga.js.下载"></script></head>

<body>
	<!-- 顶部广告条 -->
	<!--  -->
	<!-- 顶部广告条结束 -->	
	

	<style>
.btn-default {
    color: #333;
    background-color: #fff;
    border-color: #ccc;
}
#header {
    /* border-top: 3px solid #0099ee; */
    box-shadow: 0px 2px 10px 0px rgba(0, 0, 0, 0.1), 0 1px rgba(0, 0, 0, 0.1);
    background: #fafafa;
}

#header .container {
    height: 64px;
    line-height: 64px;
}

#header .navbar {
    padding: 0;
}

#header nav li.nav-item {
    line-height: 34px;
}

#header nav a.nav-link {
    font-size: 16px;
    color: #757575;
    font-weight: 500;
    text-decoration: none;
}
#header .login_btn,  #header .reg_btn{
	font-size: 13px;
	padding: 4px 16px;
	
	font-weight: 500;
	color: #0099ee;
	text-decoration: none;
	border: 1px solid #0099ee;
}
#header .reg_btn {
	color: #fff;
	background: #0099ee;
}
#header nav a.nav-link,
#header nav .dropdown {
    padding: 0 1rem;
}

#header nav a.nav-link:hover {
    background-color: #F3F3F3;
}

#header nav li.nav-item.active a {
    color: #0099ee;
    font-weight: 600;
}

#header nav .home_seach_form {
    border: 1px solid #ccc;
    border-radius: 4px;
}

#header nav .dropdown a.dropdown-item:hover {
    color: #0099ee;
    text-decoration: none;
    background-color: #f3f3f3;
}

.dropup .dropdown-toggle::after {
    display: none !important;
}
.header_nav_a {
    /* padding: 10px 0; */
}
.bottom-nav {
    /* display: none; */
    background-color: #fafafa;
    box-shadow: 0 -1px rgba(0,0,0,0.1), 0 -2px 10px rgba(0,0,0,0.1);
}
.bottom-nav .opts-group {
    position: relative;
    display: inline-block;
    /* padding-top: 6px; */
    line-height: 20px;
    color: #9e9e9e;
    cursor: pointer;
}
.bottom-nav .opts-group.active {
    color: #0099ee;
}

@media only screen and (min-width: 992px) {
    .bottom-nav, .header_seach_but {
        display: none !important;
    }
    
}
@media only screen and (max-width: 992px) {
    .nav-logo {
        margin-right: 0 !important;
    }

	.nav_user_item {
		width: 96px;
	}
	.nav_user_item .login_btn,  .nav_user_item .reg_btn {
		padding: 3px 6px !important;
	}
}

.seach_li {
    margin-left: 40px;
}

@media only screen and (max-width: 1200px) {
    .seach_li {
        margin-left: 0px !important;
        width: 100%;
        max-width: 120px !important;
    }
}
</style>
<header id="header">
    <div class="container" style="padding-right: 15px;padding-left: 15px;">
        <nav class="navbar navbar-expand-lg navbar-light">
            <a href="https://bbs.pediy.com/search.htm" class="header_seach_but" style="display:block; width: 96px;"><i class="icon-search" aria-hidden="true"></i></a>
            <a class="navbar-brand nav-logo" href="https://bbs.pediy.com/" style="line-height: 0px;">
                <img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/kanxuelogo.png" height="25">
            </a>
            <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
                <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" href="https://www.kanxue.com/">首页</a>
                    </li>
                    <li class="nav-item active">
                        <a class="nav-link" href="https://bbs.pediy.com/">论坛</a>
                    </li>
                    <li class="nav-item ">
                        <a class="nav-link " href="https://zhuanlan.kanxue.com/">专栏</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://www.kanxue.com/course.htm">课程</a>
                    </li>
                    <li class="nav-item position-relative">
                            <a class="nav-link" href="https://ctf.pediy.com/">CTF</a>
                            <img class="position-absolute" style="width: 27px; top: -5px; right: -7px; z-index: 3;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/hot.png" alt="">
                    </li>
                    <li class="nav-item position-relative">
                            <a class="nav-link" href="https://www.kanxue.com/conference.htm">看雪峰会</a>
                            <!-- <img class="position-absolute" style="width: 27px; top: -5px; right: -7px; z-index: 3;" src="//passport.kanxue.com/pc/view/img/hot.png" alt=""> -->
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" target="_blank" href="https://qifu.kanxue.com/">企服</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://job.kanxue.com/">招聘</a>
                    </li>
                    
                    <li class="nav-item">
                        <div class="dropdown">
                            <a class="dropdown-toggle nav-link px-0" href="https://bbs.pediy.com/thread-253450.htm#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                发现
                            </a>
                            <div class="dropdown-menu " aria-labelledby="dropdownMenuLink">
                                <!-- <a class="dropdown-item" href="//ctf.pediy.com">CTF</a> -->
                                <a class="dropdown-item" href="https://ce.kanxue.com/">众测</a>
                                <a class="dropdown-item" href="https://www.kanxue.com/rank.htm">排行榜</a>
                                <a class="dropdown-item" href="https://www.kanxue.com/chm.htm">知识库</a>
                                <a class="dropdown-item" href="https://www.kanxue.com/tool.htm">工具下载</a>
                                <!-- <a class="dropdown-item" href="//www.kanxue.com/conference.htm">看雪峰会</a> -->
                                <a class="dropdown-item" href="https://www.kanxue.com/mrt.htm">看雪20年</a>
                                <a class="dropdown-item" href="https://www.kanxue.com/shop.htm">看雪商城</a>
                            </div>
                        </div>
                    </li>
                    <li class="seach_li">
                        <form class="form-inline my-2 my-lg-0 mr-auto" action="https://bbs.pediy.com/search.htm" id="search_form" style="margin-right: 20px; max-width: 150px;">
                            <div class="input-group home_seach_form">
                                <input type="text" class="form-control border-0" name="keyword" placeholder="论坛关键词 回车搜索">
                                <div class="input-group-append">
                                    <button class="btn px-2" type="submit" id="button-addon2">
                                        <i class="icon-search"></i>
                                    </button>
                                </div>
                            </div>
                        </form>
                    </li>
                </ul>
                
            </div>
            <div class="text-right nav_user_item" style="white-space: nowrap;">
                                    
                    <span class="ml-3">
                        <a href="https://www.kanxue.com/pm-list-1-1.htm" class="pm_total_a text-muted m-x-sm">
                            <i class="icon-envelope"></i>
                            <!-- <span data-toggle="modal" data-target="#myModal"> 短信</span> -->
                            <span class="pm_total badge badge-warning text-white"></span>
                        </a>
                    </span>
                    <span class="ml-2 xn-toggle pointer " data-target="#toggle_user_new">
                        <a class=" px-0"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/avatar.png" class="avatar-2"></a>
                    </span>
                    <!-- <span class=" xn-toggle pointer px-0 ml-0 hidden-sm hidden-md" data-target="#toggle_user_new">
                        <a class=" px-0">&nbsp;J坚持CWF <i class="fa fa-caret-down" aria-hidden="true"></i></a>
                    </span> -->
                    <div class="text-center" id="toggle_user_new" style="line-height: 34px;">
                        <div class="row m-0 mt-3 align-items-center">
                            <div class="col">
                                <img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/avatar.png" class="avatar-4 mb-0">
                                <br> 
                                <span>J坚持CWF</span>
                            </div>
                        </div>
                        <hr class="my-3">
                        <div class="row mx-0 mb-2">
                            <div class="col-6">
                                <a href="https://passport.kanxue.com/user-center-843586.htm" class="text-muted"><i class="icon-user"></i> 我的主页</a>
                            </div>
                            
                            <div class="col-6">
                                <a href="https://passport.kanxue.com/my.htm" class="text-muted"><i class="icon-cog"></i> 个人设置</a>
                            </div>
                        </div>
                        <div class="row mx-0 mb-3">
                            
                            <div class="col-6">
                                <a href="https://bbs.pediy.com/user-843586.htm" class="text-muted"><i class="icon-user"></i> 我的论坛</a>
                            </div>
                            <div class="col-6">
                                <a href="https://bbs.pediy.com/my-wallet.htm" class="text-muted"><i class="icon-credit-card"></i> 我的钱包</a>
                            </div>
                        </div>
                        <hr class="my-3">
                        <div class="row m-0 mb-3">
                            <div class="col-12">
                                <a href="https://bbs.pediy.com/user-logout.htm" class="text-muted"><i class="icon icon-power-off"></i> 退出</a>
                            </div>
                        </div>
                    </div>
                            </div>
            
        </nav>
    </div>
</header>
<div class="position-fixed w-100 header_fiexd bottom-nav" style="width: 100%; height: 50px; bottom: 0px; z-index: 2; background: rgb(250, 250, 250); display: block;">
    <div class="row mx-0 text-center align-items-center" style="height: 50px;">
        <a href="https://www.kanxue.com/" class="d-inline-blok col px-0 header_nav_a opts-group " style="max-width: 20%;">
            <div>
                <i class="icon-home"></i>
            </div>
            <div>
                首页
            </div>
        </a>
        <a href="https://bbs.pediy.com/" class="d-inline-blok col px-0 header_nav_a opts-group active" style="max-width: 20%;">
            <div>
                <i class="icon-comments"></i>

            </div>
            <div>
                论坛
            </div>
        </a>
        <a href="https://zhuanlan.kanxue.com/" class="d-inline-blok col px-0 header_nav_a opts-group " style="max-width: 20%;">
            <div>
                <i class="icon-clipboard"></i>
            </div>
            <div>
                专栏
            </div>
        </a>
        <a href="https://www.kanxue.com/course.htm" class="d-inline-blok col px-0 header_nav_a opts-group" style="max-width: 20%;">
            <div>
                <i class="icon-book"></i>
            </div>
            <div>
                课程
            </div>
        </a>
        
        <!-- <a href="#" class="d-inline-blok col px-0" style="max-width: 20%;"> -->
        <div class=" dropup d-inline-blok col px-0" style="max-width: 20%;">
            <a class="dropdown-toggle d-inline-block header_nav_a opts-group" href="https://bbs.pediy.com/thread-253450.htm#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <div>

                    <i class="icon-list"></i>
                </div>
                <div>
                    发现
                </div>
            </a>
            <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                <a class="dropdown-item" href="https://qifu.kanxue.com/">企服</a>
                <a class="dropdown-item" href="https://job.kanxue.com/">招聘</a>
                <a class="dropdown-item" href="https://ctf.pediy.com/">CTF</a>
                <a class="dropdown-item" href="https://ce.kanxue.com/">众测</a>
                <a class="dropdown-item" href="https://www.kanxue.com/rank.htm">排行榜</a>
                <a class="dropdown-item" href="https://www.kanxue.com/chm.htm">知识库</a>
                <a class="dropdown-item" href="https://www.kanxue.com/tool.htm">工具下载</a>
                <a class="dropdown-item" href="https://www.kanxue.com/conference.htm">看雪峰会</a>
                <a class="dropdown-item" href="https://www.kanxue.com/mrt.htm">看雪20年</a>
                <a class="dropdown-item" href="https://www.kanxue.com/shop.htm">看雪商城</a>
            </div>
        </div>
        <!-- </a> -->
    </div>
</div>



	
				<main style="background: #f0f5f8 url(plugin/kanxue/img/body_bg.jpg) repeat-x" id="body"> 
		<div class="container">
					

					<style>
			.qqFace img:hover {
				border-color: #0066cc !important;
			}
		</style>
		
		<ol class="breadcrumb mb-2 hidden-md-down">
			<li class="breadcrumb-item"><a href="https://bbs.pediy.com/" aria-label="首页"><i class="icon-home"></i> 看雪论坛</a></li>
			<li class="breadcrumb-item"><a href="https://bbs.pediy.com/forum-41.htm">『编程技术』</a></li>
			<!-- <li class="breadcrumb-item active"><a href="thread-253450.htm" title="首页返回主题第一页">[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战</a></li> -->
			

			<div class="media-body text-right">
							<a href="https://bbs.pediy.com/thread-create-41.htm" role="button" class="btn btn-sm btn-primary" style="float: right;">发新帖</a>
						</div>
		</ol>
		
	
		<div class="card">
			<div class="card-body">
				<div class=" d-none d-lg-block">
					<dl class="row">
						<dt class="vtop pr-3" style="width: 70px; text-align: center;">
							<div class="avatar_info">
								<a href="https://bbs.pediy.com/user-592310.htm" aria-hidden="true" tabindex="-1">
									<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310.png">
								</a>
								<div class="mt-1" style=" height: 15px;">
									<span class="group group-104" data-gid="104" onmouseover="show_level(event)" title="四级"></span>
									
								</div>
								
								<div class="mt-1" style="position: relative; height: 16px;">
									<img style="position:absolute;left: 6px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> 
								</div>
								
							</div>
						</dt>
						
						<dd class="vtop">
							<dl class="row small" style="height: 34px; line-height: 34px;">
								<dt style="padding: 0px;">
									
									<h3 class="break-all subject m-0">
																						
																[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战																				
																		
									<i class="icon-digest-3" aria-hidden="true" title="精华"></i>
							
									</h3>
									
								</dt>
								<dd class="text-right">
									<span class="date text-grey ml-1">2019-7-30 11:31</span>
									<span class="text-grey ml-3 hidden-md-down"><i class="icon-eye" aria-hidden="true"></i> 8589</span>
								</dd>
							</dl>
							<dl class="row small mt-0">
								<dt style="padding: 0px;">
									
									<div>
										<span class="username font-weight-bold">
											<a href="https://bbs.pediy.com/user-592310.htm">Sprite雪碧</a>
										</span>
										
																					<div class="d-inline-block" style="transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
												<a href="https://bbs.pediy.com/user-592310-1-1.htm">
													<span class="icon-diamond text-danger" title="精华数"></span>
													<span class="font-weight-bold text-danger"> 1</span>
												</a>
											</div>
																				
										<span class="post_online_time" style="vertical-align: text-bottom;" data-online_time="1771901" data-desc="在线时长: 492 小时 ( 13 级)&lt;br/&gt; 升级还需要 11 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									</div>
									
								</dt>
								<dd class="text-right">
																		<a href="javascript:void(0);" class="text-grey ml-3 modal-title" id="exampleModalLabel" data-toggle="modal" data-target=".report" data-tid="253450" data-pid="1602869"><i class="icon-warning" aria-hidden="true"></i> 举报</a>
																		
																		
																	</dd>
							</dl>
							
													</dd>
					</dl>
				</div>
				<!-- choadi 手机端适配 开始-->
				<div class="px-3 pt-3 d-block d-lg-none">
					
					<h3 class="break-all subject m-0">
																		
												[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战												
																		
									<i class="icon-digest-3" aria-hidden="true" title="精华"></i>
							
					</h3>
					
					<div class="row mx-0 mt-2">
						<div class="col px-0">
							<a href="https://bbs.pediy.com/user-592310.htm" aria-hidden="true" tabindex="-1">
								<img style="width: 18px; height: 18px; border-radius: 6rem;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310.png">
							</a>
							
							<a class="small" href="https://bbs.pediy.com/user-592310.htm">Sprite雪碧</a>
														
							<span style="vertical-align: text-bottom; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);" class="group group-104" data-gid="104" onmouseover="show_level(event)" title="四级"></span>
								
															<div class="d-inline-block" style="font-size: 12px;">
									<span class="icon-diamond text-danger" title="精华数"></span>
									<span class="font-weight-bold text-danger"> 1</span>
								</div>
													</div>
						<div class="col px-0 text-right">
															
																
																
														</div>
						<!-- <img style="" src="//bbs.pediy.com/view/img/stars01.gif" alt="">  -->
						
						
					</div>
					<div class="small row mx-0 mt-2">
						<div class="col px-0">
							<span class="post_online_time" style="vertical-align: text-bottom;" data-online_time="1771901" data-desc="在线时长: 492 小时 ( 13 级)&lt;br/&gt; 升级还需要 11 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
						</div>
						<div class="col px-0 text-right">
														<a href="javascript:void(0);" class="text-grey ml-3 modal-title" id="exampleModalLabel" data-toggle="modal" data-target=".report" data-tid="253450" data-pid="1602869"><i class="icon-warning" aria-hidden="true"></i> 举报</a>
							
													</div>
					</div>
					<div class="small row mx-0 mt-2">
						<div class="col px-0"><span class="date text-grey">2019-7-30 11:31</span></div>
						<div class="col px-0 text-right"><span class="text-grey hidden-md-down"><i class="icon-eye" aria-hidden="true"></i> 8589</span></div>
					</div>
					
									</div>
				<!-- choadi 手机端适配 结束-->


				<hr aria-hidden="true">
					
				<div class="message break-all" isfirst="1">
								
					
					<h1>
0x00 前言</h1>
<blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><div>
<div>
Hook 是一种可以改变程序执行流程的技术，<span style="font-size:6;">巧妙利用 Hook 技术可以实现很多实用的操作，如：监控、过滤、拦截、修改等。</span></div>
</div>
<div>
但在现代操作系统中，出现了诸多限制，导致无法轻松的进行底层Hook。其中典型例子就是 Win10 的 PatchGuard。</div>
<div>
现在，我将为大家讲解一个神奇的技术：InfinityHook。</div>
<div>
<br></div>
</blockquote><h1>
0x01 什么是 InfinityHook</h1>
<div>
<blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><div>
InfinityHook 是一个可以Hook各种系统调用、上下文切换、页面错误、DPC 等内核事件的技术。</div>
<div>
<span style="font-size:6;">它目前可以与&nbsp;</span><span style="font-size:6;">PatchGuard 同时运行，且比常规 Hook 技术具有更好隐蔽性。</span></div>
<div>
<span style="font-size:6;"><br></span></div>
<div>
InfinityHook 并不是其名意所谓的“无限 Hook”，实际意义是可以安全的对内核底层进行 Hook。</div>
<div>
因为安全界中攻与防的对抗，产生了一种，谁先 Hook，谁 Hook 的最底层，谁最有优势的概念。</div>
<div>
而攻与防之间互相抢夺 Hook 优势的现象，像极了一个无尽深渊，没有终点。</div>
<div>
微软为了保护底层系统的安全，防止被第三方程序滥用，在一系列新版本操作系统中推出和升级了 PatchGuard。</div>
<div>
而 InfinityHook 的出现打破了微软的这一保护，拥有更安全更底层的 Hook 优势。</div>
<div>
随着时间的推移这项技术会广为人知，这意味着一场更激烈的攻防无限 Hook 战争即将开战。</div>
<div>
故名“InfinityHook”。</div>
<div>
<br></div>
<div>
想要更深入剖析 InfinityHook 的原理，就得先了解 Windows 的 Event Tracing 机制。

<br></div>
<div>
<span style="color:inherit; font-family:inherit; font-size:6; font-weight:bold;"><br></span></div>
</blockquote><h1>
0x02 什么是 Event Tracing for Windows</h1>
</div>
<div>
<blockquote style="margin:0 0 0 40px; border:none; padding:0px;">
<div>
Windows事件跟踪（ETW）是一种高效的内核级跟踪工具，可让您将内核或应用程序定义的事件记录到日志文件中。您可以实时或从日志文件中使用事件，并使用它们来调试应用程序或确定应用程序中发生性能问题的位置。<br></div>
<div>
ETW 允许您动态启用或禁用事件跟踪，允许您在生产环境中执行详细跟踪，而无需重新启动计算机或应用程序。<br></div>
<div>
<br></div>
<div>
事件跟踪 API 分为三个不同的组件：<br></div>
<div>
<ul><li>控制器（Controllers）：

用于启动和停止事件跟踪会话并启用提供程序。</li><li>提供者（Providers）：用于提供事件。</li><li>消费者（Consumers）：用于消费事件。</li></ul></div>
<h2>
<br></h2>
<h2>
0x02.1&nbsp;控制器（Controllers）

</h2>
</blockquote></div>
<blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><div>
控制器是定义日志文件的大小和位置、启动和停止事件跟踪会话、启用提供程序以便将事件记录到会话、管理缓冲池的大小以及获取会话的执行统计信息的应用程序。</div>
<div>
<span style="color:inherit; font-family:inherit; font-size:6; font-weight:bold;"><br></span></div>
</blockquote><h2>
0x02.2&nbsp;提供者（Providers）</h2>
</blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;">
<blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><div>
提供程序是包含事件跟踪工具的应用程序。提供程序注册后，控制器可以在提供程序中启用或禁用事件跟踪。提供者定义其启用或禁用的实现。通常，启用的提供程序会生成事件，而禁用的提供程序则不会。这使您可以向应用程序添加事件跟踪，而无需始终生成事件。

</div>
<div>
虽然 ETW 模型将控制器和提供程序分离为单独的应用程序，但应用程序可以包含这两个组件。&nbsp;</div>
<div>
<span style="color:inherit; font-family:inherit; font-size:6; font-weight:bold;"><br></span></div>
</blockquote><h2>
0x02.3 

消费者（Consumers）</h2>
</blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;">

消费者是选择一个或多个事件跟踪会话作为事件源的应用程序。消费者可以同时从多个事件跟踪会话中请求事件；系统按时间顺序提供事件。消费者可以接收存储在日志文件中的事件，也可以接收实时传递事件的会话。处理事件时，消费者可以指定开始和结束时间，并且仅传递在指定时间范围内发生的事件。</blockquote><br></blockquote><blockquote style="text-align:center; margin:0px 0px 0px 40px; border:none; padding:0px;">

<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_RXUX5ZTZGK74UP6.jpg" style="cursor: pointer;" class="div_message_boxShadow">&nbsp;<br></blockquote><blockquote style="text-align:center; margin:0px 0px 0px 40px; border:none; padding:0px;">（Event Tracing 事件跟踪模型图）</blockquote><blockquote style="margin:0px 0px 0px 40px; border:none; padding:0px;"><br></blockquote><blockquote style="margin:0px 0px 0px 40px; border:none; padding:0px;">我们可以在 “此电脑-&gt;管理-&gt;性能-&gt;数据收集器集-&gt;事件跟踪会话” 中找到系统中所有正在运行的事件跟踪会话。</blockquote><blockquote style="text-align:center; margin:0px 0px 0px 40px; border:none; padding:0px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_TFVNA67V367ZVWK.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></blockquote><blockquote style="text-align:center; margin:0px 0px 0px 40px; border:none; padding:0px;">（系统中所有正在运行的事件跟踪会话）</blockquote><blockquote style="text-align:left; margin:0px 0px 0px 40px; border:none; padding:0px;"><br></blockquote><blockquote style="text-align:left; margin:0px 0px 0px 40px; border:none; padding:0px;">即将讲解的 InfinityHook 就将使用第一个事件跟踪会话“Circular Kernel Context Logger”（之后简称 CKCL）进行操作。</blockquote><h1>
<br></h1>
<h1>
0x03&nbsp;InfinityHook 原理剖析</h1>
<blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><div>
首先我们要知道一点，InfinityHook 因为一些特殊的操作必须要在 Ring0 层才能实现。</div>
<div>
而 ETW 模型的3个组件是可以在 Ring3 完成。<span style="font-size:6;">所以我们可以参考微软开放的文档例子帮助分析。</span></div>
<div>
<span style="font-size:6;"><br></span></div>
<div>
<span style="font-size:6;">找到微软开放的“配置和启动 NT 内核记录器会话”的代码：</span><br></div>
<div>
<span style="font-size:6;">

https://docs.microsoft.com/en-us/windows/win32/etw/configuring-and-starting-the-nt-kernel-logger-session<br></span></div>
<div>
<span style="font-size:6;"><br></span></div>
<div>
<span style="font-size:6;">

我从网页截取了关键代码贴了上来：</span></div>
<div>
<span style="font-size:6;"><div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">EVENT_TRACE_PROPERTIES*&nbsp;pSessionProperties&nbsp;=&nbsp;NULL;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="cpp plain">BufferSize&nbsp;=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(EVENT_TRACE_PROPERTIES)&nbsp;+&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(LOGFILE_PATH)&nbsp;+&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(KERNEL_LOGGER_NAME);</code></div><div class="line number4 index3 alt1"><code class="cpp plain">pSessionProperties&nbsp;=&nbsp;(EVENT_TRACE_PROPERTIES*)&nbsp;</code><code class="cpp functions bold">malloc</code><code class="cpp plain">(BufferSize);</code></div><div class="line number5 index4 alt2"><code class="cpp plain">ZeroMemory(pSessionProperties,&nbsp;BufferSize);</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="cpp plain">pSessionProperties-&gt;Wnode.BufferSize&nbsp;=&nbsp;BufferSize;</code></div><div class="line number8 index7 alt1"><code class="cpp plain">pSessionProperties-&gt;Wnode.Flags&nbsp;=&nbsp;WNODE_FLAG_TRACED_GUID;</code></div><div class="line number9 index8 alt2"><code class="cpp plain">pSessionProperties-&gt;Wnode.ClientContext&nbsp;=&nbsp;1;&nbsp;</code><code class="cpp comments">//QPC&nbsp;clock&nbsp;resolution</code></div><div class="line number10 index9 alt1"><code class="cpp plain">pSessionProperties-&gt;Wnode.Guid&nbsp;=&nbsp;SystemTraceControlGuid;&nbsp;</code></div><div class="line number11 index10 alt2"><code class="cpp plain">pSessionProperties-&gt;EnableFlags&nbsp;=&nbsp;EVENT_TRACE_FLAG_NETWORK_TCPIP;</code></div><div class="line number12 index11 alt1"><code class="cpp plain">pSessionProperties-&gt;LogFileMode&nbsp;=&nbsp;EVENT_TRACE_FILE_MODE_CIRCULAR;</code></div><div class="line number13 index12 alt2"><code class="cpp plain">pSessionProperties-&gt;MaximumFileSize&nbsp;=&nbsp;5;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;5&nbsp;MB</code></div><div class="line number14 index13 alt1"><code class="cpp plain">pSessionProperties-&gt;LoggerNameOffset&nbsp;=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(EVENT_TRACE_PROPERTIES);</code></div><div class="line number15 index14 alt2"><code class="cpp plain">pSessionProperties-&gt;LogFileNameOffset&nbsp;=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(EVENT_TRACE_PROPERTIES)&nbsp;+&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(KERNEL_LOGGER_NAME);&nbsp;</code></div><div class="line number16 index15 alt1"><code class="cpp plain">StringCbCopy((</code><code class="cpp color1 bold">LPWSTR</code><code class="cpp plain">)((</code><code class="cpp color1 bold">char</code><code class="cpp plain">*)pSessionProperties&nbsp;+&nbsp;pSessionProperties-&gt;LogFileNameOffset),&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(LOGFILE_PATH),&nbsp;LOGFILE_PATH);</code></div><div class="line number17 index16 alt2">&nbsp;</div><div class="line number18 index17 alt1"><code class="cpp plain">status&nbsp;=&nbsp;StartTrace((PTRACEHANDLE)&amp;SessionHandle,&nbsp;KERNEL_LOGGER_NAME,&nbsp;pSessionProperties);</code></div></div></td></tr></tbody></table>
</div>
</span></div>
</blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><br></blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;">可以不难发现，配置会话的关键结构体是 EVENT_TRACE_PROPERTIES，启动会话的关键 API 是 StartTrace。</blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><br></blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;">

EVENT_TRACE_PROPERTIES 结构体的定义：</blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">typedef</code>&nbsp;<code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">_EVENT_TRACE_PROPERTIES&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">WNODE_HEADER&nbsp;Wnode;</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;data&nbsp;provided&nbsp;by&nbsp;caller</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">BufferSize;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;buffer&nbsp;size&nbsp;for&nbsp;logging&nbsp;(kbytes)</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">MinimumBuffers;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;minimum&nbsp;to&nbsp;preallocate</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">MaximumBuffers;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;maximum&nbsp;buffers&nbsp;allowed</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">MaximumFileSize;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;maximum&nbsp;logfile&nbsp;size&nbsp;(in&nbsp;MBytes)</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">LogFileMode;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;sequential,&nbsp;circular</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">FlushTimer;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;buffer&nbsp;flush&nbsp;timer,&nbsp;in&nbsp;seconds</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">EnableFlags;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;trace&nbsp;enable&nbsp;flags</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">union</code>&nbsp;<code class="cpp plain">{</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">LONG</code>&nbsp;&nbsp;<code class="cpp plain">AgeLimit;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;unused</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">LONG</code>&nbsp;&nbsp;<code class="cpp plain">FlushThreshold;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Number&nbsp;of&nbsp;buffers&nbsp;to&nbsp;fill&nbsp;before&nbsp;flushing</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;DUMMYUNIONNAME;</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;data&nbsp;returned&nbsp;to&nbsp;caller</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">NumberOfBuffers;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;no&nbsp;of&nbsp;buffers&nbsp;in&nbsp;use</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">FreeBuffers;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;no&nbsp;of&nbsp;buffers&nbsp;free</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">EventsLost;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;event&nbsp;records&nbsp;lost</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">BuffersWritten;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;no&nbsp;of&nbsp;buffers&nbsp;written&nbsp;to&nbsp;file</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">LogBuffersLost;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;no&nbsp;of&nbsp;logfile&nbsp;write&nbsp;failures</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">RealTimeBuffersLost;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;no&nbsp;of&nbsp;rt&nbsp;delivery&nbsp;failures</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">HANDLE</code>&nbsp;<code class="cpp plain">LoggerThreadId;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;thread&nbsp;id&nbsp;of&nbsp;Logger</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">LogFileNameOffset;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Offset&nbsp;to&nbsp;LogFileName</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">LoggerNameOffset;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Offset&nbsp;to&nbsp;LoggerName</code></div><div class="line number27 index26 alt2"><code class="cpp plain">}&nbsp;EVENT_TRACE_PROPERTIES,&nbsp;*PEVENT_TRACE_PROPERTIES;</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="cpp keyword bold">typedef</code>&nbsp;<code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">_WNODE_HEADER</code></div><div class="line number30 index29 alt1"><code class="cpp plain">{</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">BufferSize;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Size&nbsp;of&nbsp;entire&nbsp;buffer&nbsp;inclusive&nbsp;of&nbsp;this&nbsp;ULONG</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">ProviderId;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Provider&nbsp;Id&nbsp;of&nbsp;driver&nbsp;returning&nbsp;this&nbsp;buffer</code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">union</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number35 index34 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG64</code>&nbsp;<code class="cpp plain">HistoricalContext;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Logger&nbsp;use</code></div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">struct</code></div><div class="line number37 index36 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number38 index37 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">Version;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Reserved</code></div><div class="line number39 index38 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">Linkage;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Linkage&nbsp;field&nbsp;reserved&nbsp;for&nbsp;WMI</code></div><div class="line number40 index39 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;DUMMYSTRUCTNAME;</code></div><div class="line number41 index40 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;DUMMYUNIONNAME;</code></div><div class="line number42 index41 alt1">&nbsp;</div><div class="line number43 index42 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">union</code></div><div class="line number44 index43 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number45 index44 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">CountLost;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Reserved</code></div><div class="line number46 index45 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">HANDLE</code>&nbsp;<code class="cpp plain">KernelHandle;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Kernel&nbsp;handle&nbsp;for&nbsp;data&nbsp;block</code></div><div class="line number47 index46 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LARGE_INTEGER&nbsp;TimeStamp;&nbsp;</code><code class="cpp comments">//&nbsp;Timestamp&nbsp;as&nbsp;returned&nbsp;in&nbsp;units&nbsp;of&nbsp;100ns</code></div><div class="line number48 index47 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;since&nbsp;1/1/1601</code></div><div class="line number49 index48 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;DUMMYUNIONNAME2;</code></div><div class="line number50 index49 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">GUID&nbsp;Guid;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Guid&nbsp;for&nbsp;data&nbsp;block&nbsp;returned&nbsp;with&nbsp;results</code></div><div class="line number51 index50 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">ClientContext;</code></div><div class="line number52 index51 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">Flags;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;Flags,&nbsp;see&nbsp;below</code></div><div class="line number53 index52 alt2"><code class="cpp plain">}&nbsp;WNODE_HEADER,&nbsp;*PWNODE_HEADER;</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
<div>
StartTrace 函数的声明：</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">EXTERN_C</code></div><div class="line number2 index1 alt1"><code class="cpp color1 bold">ULONG</code></div><div class="line number3 index2 alt2"><code class="cpp plain">WMIAPI</code></div><div class="line number4 index3 alt1"><code class="cpp plain">StartTraceA&nbsp;(</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">_Out_&nbsp;PTRACEHANDLE&nbsp;TraceHandle,</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">_In_&nbsp;</code><code class="cpp color1 bold">LPCSTR</code>&nbsp;<code class="cpp plain">InstanceName,</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">_Inout_&nbsp;PEVENT_TRACE_PROPERTIES&nbsp;Properties</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">);</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</div>
</blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;">在这段代码中有一个需要关注的点：</blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">BufferSize&nbsp;=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(EVENT_TRACE_PROPERTIES)&nbsp;+&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(LOGFILE_PATH)&nbsp;+&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(KERNEL_LOGGER_NAME);</code></div><div class="line number2 index1 alt1"><code class="cpp plain">pSessionProperties&nbsp;=&nbsp;(EVENT_TRACE_PROPERTIES*)&nbsp;</code><code class="cpp functions bold">malloc</code><code class="cpp plain">(BufferSize);</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
<div>
分配的内存长度不仅仅只是结构体的大小，还包含了两段其他的长度。</div>
<div>
<br></div>
<div>
看一下 msdn 对这个 API 的描述：</div>
<div>
https://docs.microsoft.com/en-us/windows/win32/etw/starttrace<br></div>
<div>
<br></div>
<div>
其中同样有一点值得关注：</div>
<div>
<blockquote class="blockquote"><p>
This function copies the session name that you provide to the offset that the LoggerNameOffset member of Properties points to.

<br></p>

<p>
此函数将您提供的会话名称复制到属性的LoggerNameOffset成员指向的偏移量。

<br></p>

</blockquote></div>
<div>
<span style="font-size:6;">这段话说明我们拷贝到结构体之后的字符串还会在 StartTrace 内部被处理。</span><br></div>
<div>
<br></div>
<div>
对在 Ring3 启动跟踪会话的信息了解的差不多了。<span style="font-size:6;">但是问题来了，如何在 Ring0 层实现这些东西呢？</span></div>
<div>
<span style="font-size:6;">所以我们得上 IDA 分析一下这个函数的内部实现。</span></div>
</blockquote><h2 style="margin:0 0 0 40px; border:none; padding:0px;"><br></h2>
<h2 style="margin:0 0 0 40px; border:none; padding:0px;">0x03.1 StartTrace 的内部实现</h2>
<blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><div>
从 msdn 的描述里我们可以看到：</div>
<div>
<blockquote class="blockquote"><p>
DLL<br></p>

<p>
Sechost.dll on Windows&nbsp;8.1 and Windows Server&nbsp;2012&nbsp;R2;</p>

<p>
Advapi32.dll on Windows&nbsp;8, Windows Server&nbsp;2012, Windows&nbsp;7, Windows Server&nbsp;2008&nbsp;R2, Windows Server&nbsp;2008, Windows&nbsp;Vista and Windows&nbsp;XP</p>

</blockquote></div>
<div>
<span style="font-size:6;">所以我们将 Advapi32.dll 文件用IDA打开，下载 dll 的符号文件让 IDA 自动分析。</span></div>
<div>
<span style="font-size:6;">分析完成后，转到 StartTraceA 函数，从函数头部开始看。</span></div>
<div>
<span style="font-size:6;"><br></span></div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_Y63PX7U8UNHCEVC.jpg" style="cursor: pointer;" class="div_message_boxShadow"><span style="font-size:6;"><br></span></div>
<div>
首先是对参数的合法性检查。</div>
<div>
<br></div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_C93A6VU4GZ9XGVH.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></div>
<div>
接着是对参数2的 InstanceName 字符串内容进行比较。</div>
<div>
如果为“NT Kernel Logger”，则将 SystemTraceControlGuid 的 Guid 赋值给 Properties-&gt;Wnode.Guid。</div>
<div>
如果为“Circular Kernel Context Logger”，

则将 CKCLGuid 的 Guid 赋值给 Properties-&gt;Wnode.Guid。

</div>
<div>
<br></div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_7DEJHG2BVF3V7SB.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></div>
<div>
我们看下这个 CKCLGuid 的内容，之后会用到。

<br></div>
<div>
<br></div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_FFSZBEJHQ8AR29S.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></div>
<div>
首先判断“Properties-&gt;LogFileNameOffset”如果小于等于0，则跳到 LABEL_67 标签。</div>
<div>
在图片底部可以看到 LABEL_67 标签置零了2个变量，但并没有返回退出。</div>
<div>
说明这个函数允许 LogFileNameOffset 的值为0。</div>
<div>
<br></div>
<div>
同样，我们在 msdn 查阅一下这个结构体：</div>
<div>
https://docs.microsoft.com/en-us/windows/win32/etw/event-trace-properties<br></div>
<div>
<br></div>
<div>
找到对这个成员的描述，截取关键内容下来：</div>
<div>
<blockquote class="blockquote"><p>
<span style="font-size:6;">LogFileNameOffset</span></p>

<p>
<br></p>

<p>
Offset from the start of the structure's allocated memory to beginning of the null-terminated string that contains the log file name.</p>

<p>
从结构的已分配内存开始到包含日志文件名的以空值终止的字符串的开头的偏移量。

<br></p>

<p>
<br></p>

<p>
If you do not want to log events to a log file (for example, you specify EVENT_TRACE_REAL_TIME_MODE only), set LogFileNameOffset to 0. If you specify only real-time logging and also provide an offset with a valid log file name, ETW will use the log file name to create a sequential log file and log events to the log file. ETW also creates the sequential log file if LogFileMode is 0 and you provide an offset with a valid log file name.</p>

<p>
如果您不想将事件记录到日志文件中（例如，仅指定EVENT_TRACE_REAL_TIME_MODE），请将LogFileNameOffset设置为0.如果仅指定实时日志记录并提供具有有效日志文件名的偏移量，则ETW将使用日志文件名，用于创建顺序日志文件并将事件记录到日志文件中。如果LogFileMode为0，ETW还会创建顺序日志文件，并提供带有效日志文件名的偏移量。&nbsp;</p>

</blockquote></div>
<div>
文章头部对 ETW 的介绍中写到：</div>
<div>
<blockquote class="blockquote"><p>
您可以实时或从日志文件中使用事件，并使用它们来调试应用程序或确定应用程序中发生性能问题的位置。

</p>

</blockquote></div>
<div>
我们可以得知，

日志文件是用于调试应用程序或定位性能问题位置的。<span style="font-size:6;">而 InfinityHook 并不需要这些东西。</span></div>
<div>
<span style="font-size:6;">所以&nbsp;</span><span style="font-size:6;">LogFileNameOffset 成员可以直接置0，跳过这段继续往下分析。</span></div>
<div>
<br></div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_W8QKD9QNSSSFEFW.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></div>
<div>
<span style="font-size:6;">接着是一些参数标志合法性检查，这些合法性检查由 Etwp 开头的 API 完成。</span><br></div>
<div>
<span style="font-size:6;">假定我们传递的所有参数都是正确的，所以无需跟进这些 API 进行分析。</span></div>
<div>
<br></div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_AAVBW9D9PA2A888.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></div>
<div>
从堆中分配一块内存空间，后面要用到。</div>
<div>
<br></div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_T4ZQPH2SSE2SWKG.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></div>
<div>
将我们传递进来的 Properties 参数填进v27变量内。</div>
<div>
接着我们可以看到几个字符串操作 API 。还记得刚刚在 msdn 提到的关注点吗？应该就是这里了。</div>
<div>
第一个字符串的处理是<span style="font-size:6;">将我们传递进来的 InstanceName 参数初始化为一个 ANSI_STRING 字符串。</span></div>
<div>
<span style="font-size:6;">再将其转换为一个 UNICODE_STRING 字符串。</span></div>
<div>
转换完的 UNICODE_STRING 字符串存放在 (PUNICODE_STRING)v27 + 9 的位置。</div>
<div>
UNICODE_STRING 结构体的大小为16，故步长为16。实际存放地址是在 v27 +&nbsp;144 。</div>
<div>
再看下 EVENT_TRACE_PROPERTIES 结构体的大小为120。</div>
<div>
说明这个 UNICODE_STRING 字符串存放在 v27 +&nbsp;sizeof(EVENT_TRACE_PROPERTIES) + 24 的位置。</div>
<div>
<br></div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_G3W9USYWYDDTDAS.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></div>
<div>
处理完第一个字符串后有一个判断，如果 v46 等于0，则跳到 LABEL_69 标签。</div>
<div>
而这个 v46 就是刚刚判断 LogFileNameOffset 如果等于0所置零的变量。</div>
<div>
所以这里可以跳过第二个字符串的处理，直接往下看。</div>
<div>
<br></div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_Y2Z9MCMRFUM47Q6.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></div>
<div>
<span style="font-size:6;">看到了两个 Etwp 开头的API，我们先跟进第一个 API 看看。</span><br></div>
<div>
<br></div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_J7HMVUWF5PA2F5A.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_E3TQUPH7ZKRQB4E.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></div>
<div>
不难看出，这个 API 对 Property 的内容影响并不大，只有两处，74和72偏移。</div>
<div>
对比结构体定义发现，是在对 EnableFlags 成员填值。</div>
<div>
这个成员放到后面再讲，所以这里先暂时跳过此 API。</div>
<div>
<br></div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_5T7RRVAZKBYMV4Z.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></div>
<div>
接着来看 EtwpStartLogger 这个API。</div>
<div>
可以很直观的看到，检查了一些成员后调用了 NtTraceControl 这个 API。</div>
<div>
这个就是我们在 Ring0 层启动事件跟踪会话的API了。</div>
<div>
<br></div>
<div>
在这 API 之下是一些与结构体内容无关的操作。所以直接跳过，返回上层继续看。</div>
<div>
<br></div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_PWVZG5BKXBXTUBP.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></div>
<div>
将堆内存的 Property 内容，置回到参数 Property 中。然后跳到 LABEL_58 标签。</div>
<div>
<br></div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_B6XEUVNV6DAVBV7.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></div>
<div>
释放堆内存，返回成功与否。</div>
<div>
<br></div>
<div>
至此，StartTraceA 这个 API 逆向完成。</div>
<div>
我们知道了部分参数的填写规则和关键 API。</div>
<div>
<br></div>
<div>
下一步我们开始写 InfinityHook 的实现代码。</div>
<div>
<br></div>
</blockquote><h2>
0x03.2 InfinityHook 的实现</h2>
</blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;">首先，从刚刚分析出来的信息：</blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;">UNICODE_STRING 类型的 InstanceName 存放在
Property +&nbsp;sizeof(EVENT_TRACE_PROPERTIES) + 24 的位置。</blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;">所以我们定义一个名为 CKCL_TRACE_PROPERTIES 的结构体，这个结构体继承于 EVENT_TRACE_PROPERTIES。</blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">struct</code>&nbsp;<code class="cpp plain">CKCL_TRACE_PROPERTIES&nbsp;:&nbsp;EVENT_TRACE_PROPERTIES</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">CHAR</code>&nbsp;<code class="cpp plain">Padding[24];</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">UNICODE_STRING&nbsp;InstanceName;</code></div><div class="line number5 index4 alt2"><code class="cpp plain">};</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
<div>
然后定义一个变量为其申请一块内存空间，并对其置零。</div>
<div>
为了保险起见，以防底层 API 还会对结构体更后面的内存进行操作，所以申请的大小填 PAGE_SIZE。</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">CKCL_TRACE_PROPERTIES&nbsp;*pProperty&nbsp;=&nbsp;(CKCL_TRACE_PROPERTIES&nbsp;*)ExAllocatePoolWithTag(NonPagedPool,&nbsp;PAGE_SIZE,&nbsp;ALLOC_TAG);</code></div><div class="line number2 index1 alt1"><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(pProperty&nbsp;==&nbsp;NULL)&nbsp;{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">KeBugCheckEx(HAL_MEMORY_ALLOCATION,&nbsp;PAGE_SIZE,&nbsp;0,&nbsp;NULL,&nbsp;0);</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">STATUS_MEMORY_NOT_ALLOCATED;</code></div><div class="line number5 index4 alt2"><code class="cpp plain">}</code></div><div class="line number6 index5 alt1"><code class="cpp plain">RtlZeroMemory(pProperty,&nbsp;PAGE_SIZE);</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</div>
<div>
然后初始化一个变量名为 InstanceName 的 UNICODE_STRING 字符串。</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">UNICODE_STRING&nbsp;InstanceName;</code></div><div class="line number2 index1 alt1"><code class="cpp plain">RtlInitUnicodeString(&amp;InstanceName,&nbsp;L</code><code class="cpp string">"Circular&nbsp;Kernel&nbsp;Context&nbsp;Logger"</code><code class="cpp plain">);</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</div>
<div>
接着我们开始填写 pProperty 内容。</div>
<div>
<br></div>
<div>
pProperty-&gt;Wnode.BufferSize：填写我们为其申请内存的大小 PAGE_SIZE。</div>
<div>
pProperty-&gt;Wnode.ClientContext：</div>
</blockquote></blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><div>
根据 msdn 的描述，此成员为时间戳的分辨率。可以为3个值：</div>
</blockquote></blockquote></blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><ul><li>1：<span style="font-size:6;">Query performance counter (QPC).&nbsp;QPC 计数器提供高分辨率时间戳，不受系统时钟调整的影响。存储在事件中的时间戳等同于QueryPerformanceCounter API 返回的值。</span><br></li><li>2：System time（系统时间）.<br></li><li>3：CPU cycle counter（CPU 循环计数器）. CPU 计数器提供最高分辨率的时间戳，并且是检索资源最少的。但是，CPU 计数器不可靠，不应在生产中使用。例如，在某些计算机上，除了在某些状态下停止之外，定时器还会因热量和功率变化而改变频率。<br></li></ul></blockquote></blockquote></blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><div>
我们这里填写为3值（CPU 循环计数器），因为它的实现是通过一条汇编指令实现的，后面会讲。</div>
</blockquote></blockquote></blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><div>
pProperty-&gt;Wnode.Flags：根据 msdn 的描述，必须包含 WNODE_FLAG_TRACED_GUID 以指示该结构包含事件跟踪信息。<br></div>
</blockquote></blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;">
<div>
pProperty-&gt;Wnode.Guid：</div>
</blockquote></blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><div>
从上面的 IDA 中取出来改为代码则是：</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">//&nbsp;54dea73a-ed1f-42a4-af713e63d056f174</code></div><div class="line number2 index1 alt1"><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">GUID&nbsp;CkclSessionGuid&nbsp;=&nbsp;{&nbsp;0x54dea73a,&nbsp;0xed1f,&nbsp;0x42a4,&nbsp;{&nbsp;0xaf,&nbsp;0x71,&nbsp;0x3e,&nbsp;0x63,&nbsp;0xd0,&nbsp;0x56,&nbsp;0xf1,&nbsp;0x74&nbsp;}&nbsp;};</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</div>
</blockquote></blockquote></blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><div>
pProperty-&gt;BufferSize：每个事件的缓冲区，直接填4字节即可，因为我们不需要实际接收事件内容。<br></div>
<div>
pProperty-&gt;LogFileMode：上面说过，我们不需要 ETW 写入日志文件，所以设置为 EVENT_TRACE_BUFFERING_MODE。<br></div>
<div>
pProperty-&gt;MinimumBuffers：为事件跟踪会话的缓冲池分配的最小缓冲区数，最小为2，直接填2,。<br></div>
<div>
pProperty-&gt;MaximumBuffers：</div>
</blockquote></blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><div>
这个成员 msdn 描述的有点矛盾。</div>
<div>
既说必须大于等于 MinimumBuffers，又说 LogFileMode 设置了 EVENT_TRACE_BUFFERING_MODE 可以不用设置此值。</div>
<div>
虽然应该可以忽略这个成员，但这里为了保险起见，我们设置和 MinimumBuffers 一样的值。</div>
</blockquote></blockquote></blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;">
<div>
pProperty-&gt;InstanceName：这个为我们刚刚扩充的成员，填写初始化的 UNICODE_STRING 字符串 InstanceName 即可。<br></div>
<div>
<br></div>
<div>
所以Property的成员填写代码是这样的。</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">pProperty-&gt;Wnode.BufferSize&nbsp;=&nbsp;PAGE_SIZE;</code></div><div class="line number2 index1 alt1"><code class="cpp plain">pProperty-&gt;Wnode.ClientContext&nbsp;=&nbsp;3;</code></div><div class="line number3 index2 alt2"><code class="cpp plain">pProperty-&gt;Wnode.Flags&nbsp;=&nbsp;WNODE_FLAG_TRACED_GUID;</code></div><div class="line number4 index3 alt1"><code class="cpp plain">pProperty-&gt;Wnode.Guid&nbsp;=&nbsp;CkclSessionGuid;</code></div><div class="line number5 index4 alt2"><code class="cpp plain">pProperty-&gt;BufferSize&nbsp;=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">ULONG</code><code class="cpp plain">);</code></div><div class="line number6 index5 alt1"><code class="cpp plain">pProperty-&gt;LogFileMode&nbsp;=&nbsp;EVENT_TRACE_BUFFERING_MODE;</code></div><div class="line number7 index6 alt2"><code class="cpp plain">pProperty-&gt;MinimumBuffers&nbsp;=&nbsp;pProperty-&gt;MaximumBuffers&nbsp;=&nbsp;2;</code></div><div class="line number8 index7 alt1"><code class="cpp plain">pProperty-&gt;InstanceName&nbsp;=&nbsp;InstanceName;</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
<div>
<br></div>
</div>
<div>
然后就是控制 CKCL 事件跟踪会话。</div>
<div>
<br></div>
<div>
NtTraceControl，msdn 并没有给出他的声明。<span style="font-size:6;">结合谷歌搜索、GitHub 项目和 IDA 分析，可以得到的声明为：</span></div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">EXTERN_C</code></div><div class="line number2 index1 alt1"><code class="cpp plain">NTSYSCALLAPI</code></div><div class="line number3 index2 alt2"><code class="cpp plain">NTSTATUS</code></div><div class="line number4 index3 alt1"><code class="cpp plain">NTAPI</code></div><div class="line number5 index4 alt2"><code class="cpp plain">NtTraceControl(</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">_In_&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">FunctionCode,</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">_In_reads_bytes_opt_(InBufferLen)&nbsp;</code><code class="cpp color1 bold">PVOID</code>&nbsp;<code class="cpp plain">InBuffer,</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">_In_&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">InBufferLen,</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">_Out_writes_bytes_opt_(OutBufferLen)&nbsp;</code><code class="cpp color1 bold">PVOID</code>&nbsp;<code class="cpp plain">OutBuffer,</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">_In_&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">OutBufferLen,</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">_Out_&nbsp;</code><code class="cpp color1 bold">PULONG</code>&nbsp;<code class="cpp plain">ReturnLength</code></div><div class="line number12 index11 alt1"><code class="cpp plain">);</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</div>
<div>
其中参数一可以是5个常量中的任意一个：</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp preprocessor">#define&nbsp;EtwpStartTrace&nbsp;&nbsp;&nbsp;&nbsp; 1</code></div><div class="line number2 index1 alt1"><code class="cpp preprocessor">#define&nbsp;EtwpStopTrace&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2</code></div><div class="line number3 index2 alt2"><code class="cpp preprocessor">#define&nbsp;EtwpQueryTrace&nbsp;&nbsp;&nbsp;&nbsp; 3</code></div><div class="line number4 index3 alt1"><code class="cpp preprocessor">#define&nbsp;EtwpUpdateTrace&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4</code></div><div class="line number5 index4 alt2"><code class="cpp preprocessor">#define&nbsp;EtwpFlushTrace&nbsp;&nbsp;&nbsp;&nbsp; 5</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</div>
<div>
这5个常量在此 API 内部对应5个 Etwp 开头的 API，分别代表：启动跟踪、停止跟踪、查询跟踪、更新跟踪、刷新跟踪。</div>
</blockquote></blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;">
<div>
InfinityHook 只需要：启动、停止和更新。</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">//&nbsp;启动</code></div><div class="line number2 index1 alt1"><code class="cpp plain">NtTraceControl(EtwpStartTrace,&nbsp;pProperty,&nbsp;PAGE_SIZE,&nbsp;pProperty,&nbsp;PAGE_SIZE,&nbsp;&amp;ReturnLength);</code></div><div class="line number3 index2 alt2"><code class="cpp comments">//&nbsp;停止</code></div><div class="line number4 index3 alt1"><code class="cpp plain">NtTraceControl(EtwpStopTrace,&nbsp;pProperty,&nbsp;PAGE_SIZE,&nbsp;pProperty,&nbsp;PAGE_SIZE,&nbsp;&amp;ReturnLength);</code></div><div class="line number5 index4 alt2"><code class="cpp comments">//&nbsp;更新</code></div><div class="line number6 index5 alt1"><code class="cpp plain">NtTraceControl(EtwpUpdateTrace,&nbsp;pProperty,&nbsp;PAGE_SIZE,&nbsp;pProperty,&nbsp;PAGE_SIZE,&nbsp;&amp;ReturnLength);</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</div>
<div>
值得注意的是，我们需要在更新跟踪的时候，设置 pProperty-&gt;EnableFlags 标志，以此来过滤我们想要的事件。</div>
<div>
本文将以 Hook Syscall 中的 NtOpenProcess 作为例子进行讲解。</div>
<div>
<span style="font-size:6;">所以这里设置 EVENT_TRACE_FLAG_SYSTEMCALL 标志，以拦截到所有的 Syscall 事件。</span></div>
<div>
<br></div>
<div>
我们将以上内容封装为一个函数，所以整个函数的代码是这样的：</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">NTSTATUS&nbsp;EventTraceControl(CKCL_TRACE_OPERATION&nbsp;Operation)</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">NTSTATUS&nbsp;Status&nbsp;=&nbsp;STATUS_UNSUCCESSFUL;</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">ReturnLength&nbsp;=&nbsp;0;</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">CKCL_TRACE_PROPERTIES&nbsp;*pProperty&nbsp;=&nbsp;(CKCL_TRACE_PROPERTIES&nbsp;*)ExAllocatePoolWithTag(NonPagedPool,&nbsp;PAGE_SIZE,&nbsp;ALLOC_TAG);</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(pProperty&nbsp;==&nbsp;NULL)&nbsp;{</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">KeBugCheckEx(HAL_MEMORY_ALLOCATION,&nbsp;PAGE_SIZE,&nbsp;0,&nbsp;NULL,&nbsp;0);</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">STATUS_MEMORY_NOT_ALLOCATED;</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">RtlZeroMemory(pProperty,&nbsp;PAGE_SIZE);</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">UNICODE_STRING&nbsp;InstanceName;</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">RtlInitUnicodeString(&amp;InstanceName,&nbsp;L</code><code class="cpp string">"Circular&nbsp;Kernel&nbsp;Context&nbsp;Logger"</code><code class="cpp plain">);</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pProperty-&gt;Wnode.BufferSize&nbsp;=&nbsp;PAGE_SIZE;</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pProperty-&gt;Wnode.ClientContext&nbsp;=&nbsp;3;</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pProperty-&gt;Wnode.Flags&nbsp;=&nbsp;WNODE_FLAG_TRACED_GUID;</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pProperty-&gt;Wnode.Guid&nbsp;=&nbsp;CkclSessionGuid;</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pProperty-&gt;BufferSize&nbsp;=&nbsp;</code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(</code><code class="cpp color1 bold">ULONG</code><code class="cpp plain">);</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pProperty-&gt;LogFileMode&nbsp;=&nbsp;EVENT_TRACE_BUFFERING_MODE;</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pProperty-&gt;MinimumBuffers&nbsp;=&nbsp;pProperty-&gt;MaximumBuffers&nbsp;=&nbsp;2;</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pProperty-&gt;InstanceName&nbsp;=&nbsp;InstanceName;</code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">switch</code>&nbsp;<code class="cpp plain">(Operation)</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">CKCL_TRACE_START:</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Status&nbsp;=&nbsp;NtTraceControl(EtwpStartTrace,&nbsp;pProperty,&nbsp;PAGE_SIZE,&nbsp;pProperty,&nbsp;PAGE_SIZE,&nbsp;&amp;ReturnLength);</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">CKCL_TRACE_END:</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Status&nbsp;=&nbsp;NtTraceControl(EtwpStopTrace,&nbsp;pProperty,&nbsp;PAGE_SIZE,&nbsp;pProperty,&nbsp;PAGE_SIZE,&nbsp;&amp;ReturnLength);</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">CKCL_TRACE_SYSCALL:</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;这里添加更多标志可以捕获更多事件</code></div><div class="line number35 index34 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">pProperty-&gt;EnableFlags&nbsp;=&nbsp;EVENT_TRACE_FLAG_SYSTEMCALL;</code></div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Status&nbsp;=&nbsp;NtTraceControl(EtwpUpdateTrace,&nbsp;pProperty,&nbsp;PAGE_SIZE,&nbsp;pProperty,&nbsp;PAGE_SIZE,&nbsp;&amp;ReturnLength);</code></div><div class="line number37 index36 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number38 index37 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">default</code><code class="cpp plain">:</code></div><div class="line number39 index38 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Status&nbsp;=&nbsp;STATUS_UNSUCCESSFUL;</code></div><div class="line number40 index39 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number41 index40 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number42 index41 alt1">&nbsp;</div><div class="line number43 index42 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ExFreePool(pProperty);</code></div><div class="line number44 index43 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">Status;</code></div><div class="line number45 index44 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</div>
<div>
接着调用这个函数，启动并更新 CKCL 事件跟踪对象：</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">NTSTATUS&nbsp;StartCkclEventTrace()</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">NTSTATUS&nbsp;Status&nbsp;=&nbsp;STATUS_UNSUCCESSFUL;</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;测试&nbsp;CKCL&nbsp;会话是否已经启动</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Status&nbsp;=&nbsp;EventTraceControl(CKCL_TRACE_SYSCALL);</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(!NT_SUCCESS(Status))&nbsp;{</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;没有启动&nbsp;尝试打开</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Status&nbsp;=&nbsp;EventTraceControl(CKCL_TRACE_START);</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(!NT_SUCCESS(Status))&nbsp;{</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LOG_ERROR(</code><code class="cpp string">"Start&nbsp;CKCL&nbsp;failed."</code><code class="cpp plain">,&nbsp;Status);</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">Status;</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">Status&nbsp;=&nbsp;EventTraceControl(CKCL_TRACE_SYSCALL);</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(!NT_SUCCESS(Status))&nbsp;{</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LOG_ERROR(</code><code class="cpp string">"Start&nbsp;CKCL&nbsp;failed."</code><code class="cpp plain">,&nbsp;Status);</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">Status;</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LOG_INFO(</code><code class="cpp string">"CKCL&nbsp;is&nbsp;running"</code><code class="cpp plain">,&nbsp;0);</code></div><div class="line number23 index22 alt2">&nbsp;</div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">Status;</code></div><div class="line number25 index24 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</div>
<div>
至此，CKCL 已成功启动和更新。</div>
<div>
<br></div>
<div>
<br></div>
<div>
下面，我们需要找到一些内核全局地址，来方便我们进行之后的操作。</div>
<div>
<br></div>
<div>
EtwpDebuggerData，是一张存放所有 ETW 信息的表。</div>
<div>
通过IDA搜索可以发现有这个变量符号，但是查看交叉引用却发现IDA并没有分析出哪里使用了这个变量。<br></div>
<div>
所以只能通过暴搜的方法去找到这个变量的地址。</div>
<div>
<br></div>
<div>
通过多个系统版本的内核文件进行 IDA 分析，可以发现两条信息。</div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_HJHQKR44KM7QPFE.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></div>
<div>
<ol><li>根据相同的数值，得出 EtwpDebuggerData 的特征码是“?? ?? 2c 08 04 38 0c”。<br></li><li>不同系统上的&nbsp;<span style="font-size:6;">EtwpDebuggerData 可能存在于不同的区段。</span><br></li></ol></div>
<div>
<br></div>
<div>
那我们首先取到内核基地址，解析PE头找到“.data”和".rdata"区段的起始地址和区段大小，然后<span style="font-size:6;">根据特征码进行暴搜。</span></div>
<div>
<span style="font-size:6;"><div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">KernelSize&nbsp;=&nbsp;0;</code></div><div class="line number2 index1 alt1"><code class="cpp color1 bold">PVOID</code>&nbsp;<code class="cpp plain">KernelBase&nbsp;=&nbsp;System::GetKernelBase(&amp;KernelSize);</code></div><div class="line number3 index2 alt2"><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(KernelBase&nbsp;==&nbsp;NULL)&nbsp;{</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LOG_ERROR(</code><code class="cpp string">"Get&nbsp;kernel&nbsp;base&nbsp;failed."</code><code class="cpp plain">,&nbsp;0);</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">FALSE;</code></div><div class="line number6 index5 alt1"><code class="cpp plain">}</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="cpp keyword bold">const</code>&nbsp;<code class="cpp keyword bold">auto</code>&nbsp;<code class="cpp plain">fnSearchInSection&nbsp;=&nbsp;[&amp;](</code><code class="cpp color1 bold">CHAR</code>&nbsp;<code class="cpp plain">*SectionName,&nbsp;</code><code class="cpp color1 bold">CHAR</code>&nbsp;<code class="cpp plain">*Pattern,&nbsp;</code><code class="cpp color1 bold">CHAR</code>&nbsp;<code class="cpp plain">*Masks)-&gt;</code><code class="cpp color1 bold">PVOID</code></div><div class="line number9 index8 alt2"><code class="cpp plain">{</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">SizeOfSection&nbsp;=&nbsp;0;</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">PVOID</code>&nbsp;<code class="cpp plain">SectionBase&nbsp;=&nbsp;Image::GetSection(KernelBase,&nbsp;SectionName,&nbsp;&amp;SizeOfSection);</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(SectionBase&nbsp;==&nbsp;NULL)&nbsp;{</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">NULL;</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">Utils::FindPattern(SectionBase,&nbsp;SizeOfSection,&nbsp;Pattern,&nbsp;Masks);</code></div><div class="line number17 index16 alt2"><code class="cpp plain">};</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="cpp color1 bold">PVOID</code>&nbsp;<code class="cpp plain">EtwpDebuggerData&nbsp;=&nbsp;fnSearchInSection(</code><code class="cpp string">".data"</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">"\x00\x00\x2c\x08\x04\x38\x0c"</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">"??xxxxx"</code><code class="cpp plain">);</code></div><div class="line number20 index19 alt1"><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(EtwpDebuggerData&nbsp;==&nbsp;NULL)&nbsp;{</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">EtwpDebuggerData&nbsp;=&nbsp;fnSearchInSection(</code><code class="cpp string">".rdata"</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">"\x00\x00\x2c\x08\x04\x38\x0c"</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">"??xxxxx"</code><code class="cpp plain">);</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(EtwpDebuggerData&nbsp;==&nbsp;NULL)&nbsp;{</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">FALSE;</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number25 index24 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</span></div>
<div>
接着在

EtwpDebuggerData + 0x10 处取到 EtwpDebuggerDataSilo 指针。</div>
<div>
再从

EtwpDebuggerDataSilo + 0x10

的位置取到 CkclWmiLoggerContext 指针。</div>
<div>
这两个数据的硬编码偏移在所有系统上都一样，并没有发生改变。</div>
<div>
（</div>
<div>
EtwpDebuggerDataSilo 和 CkclWmiLoggerContext，是直接参考的 GitHub 上的项目，</div>
<div>
因为在IDA中找了很久都没有找到关于 EtwpDebuggerDataSilo 的信息，</div>
<div>
仅仅找到了一个可能是 CkclWmiLoggerContext 的指针，是动态分配的，</div>
<div>
鄙人逆向能力有限，实在没能跟到 EtwpDebuggerDataSilo 在哪，</div>
<div>
如果有大佬研究出来了，欢迎在评论区分享，谢谢！</div>
<div>
）</div><div><div><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">PVOID</code>&nbsp;<code class="cpp plain">*EtwpDebuggerDataSilo&nbsp;=&nbsp;*(</code><code class="cpp color1 bold">PVOID</code><code class="cpp plain">**)((</code><code class="cpp color1 bold">ULONG_PTR</code><code class="cpp plain">)EtwpDebuggerData&nbsp;+&nbsp;0x10);</code></div><div class="line number2 index1 alt1"><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(EtwpDebuggerDataSilo&nbsp;==&nbsp;NULL)&nbsp;{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LOG_ERROR(</code><code class="cpp string">"EtwpDebuggerDataSilo&nbsp;is&nbsp;bad."</code><code class="cpp plain">,&nbsp;EtwpDebuggerDataSilo);</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">FALSE;</code></div><div class="line number5 index4 alt2"><code class="cpp plain">}</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="cpp plain">g.CkclWmiLoggerContext&nbsp;=&nbsp;EtwpDebuggerDataSilo[2];</code></div><div class="line number8 index7 alt1"><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(g.CkclWmiLoggerContext&nbsp;==&nbsp;NULL)&nbsp;{</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LOG_ERROR(</code><code class="cpp string">"CkclWmiLoggerContext&nbsp;is&nbsp;bad."</code><code class="cpp plain">,&nbsp;EtwpDebuggerDataSilo);</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">FALSE;</code></div><div class="line number11 index10 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div><div><br></div></div>
<div>
<br></div>
<div>
接着我们需要取到 SyscallEntry 的页面基址。</div>
<div>
直接从 msr 中可以取出 SyscallEntry。</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">__readmsr(IA32_LSTAR_MSR)</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</div>
<div>
但是有一个问题，还记得2018年的内核页表隔离补丁吗。</div>
<div>
不记得没关系，大表哥之前分析过的帖子：<span style="font-size:6;">https://bbs.pediy.com/thread-223805.htm</span></div>
<div>
<br></div>
<div>
简单来说，在打了内核页表隔离补丁的系统上，取到的只是一个影子入口，通过影子入口内的过渡代码，最后走到真正的入口。</div>
<div>
而 CKCL 事件是在真实入口中触发的，只拿到影子入口并不能完成之后的操作。</div>
<div>
影子入口和过渡代码都存在于内核模块的 KVASCODE 区段内，该区段是否存在取决于有没有打内核页表隔离补丁。</div>
<div>
如果区段存在，我们则取到这个区段的入口地址和区段大小。</div>
<div>
<span style="font-size:6;">再对比我们从 msr 中得到的 SyscallEntry 是否在此区段内，则可以判定内核页表隔离有没有被开启。</span></div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">/*</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">通过&nbsp;KVASCODE&nbsp;节表是否存在，判断有没有打补丁</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">也可以通过&nbsp;NtQuerySystemInformation&nbsp;来查询判断</code></div><div class="line number4 index3 alt1"><code class="cpp comments">*/</code></div><div class="line number5 index4 alt2"><code class="cpp color1 bold">ULONG</code>&nbsp;<code class="cpp plain">SectionSize&nbsp;=&nbsp;0;</code></div><div class="line number6 index5 alt1"><code class="cpp color1 bold">PVOID</code>&nbsp;<code class="cpp plain">SectionBase&nbsp;=&nbsp;Image::GetSection(KernelBase,&nbsp;</code><code class="cpp string">"KVASCODE"</code><code class="cpp plain">,&nbsp;&amp;SectionSize);</code></div><div class="line number7 index6 alt2"><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(SectionBase&nbsp;==&nbsp;NULL)&nbsp;{</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">SyscallEntry;</code></div><div class="line number9 index8 alt2"><code class="cpp plain">}</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="cpp comments">//&nbsp;判断&nbsp;SyscallEntry&nbsp;是否在&nbsp;KVASCODE&nbsp;节表内，如果不在则是真实入口直接返回</code></div><div class="line number12 index11 alt1"><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(!(SyscallEntry&nbsp;&gt;=&nbsp;SectionBase&nbsp;&amp;&amp;&nbsp;SyscallEntry&nbsp;&lt;&nbsp;(</code><code class="cpp color1 bold">PVOID</code><code class="cpp plain">)((</code><code class="cpp color1 bold">ULONG_PTR</code><code class="cpp plain">)SectionBase&nbsp;+&nbsp;SectionSize)))&nbsp;{</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">SyscallEntry;</code></div><div class="line number14 index13 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</div>
<div>
这是没打补丁通过 msr 取到的 SyscallEntry，函数名是 KiSystemCall64。

<br></div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_Y5GXHDKZNH5PC2Z.jpg" style="cursor: pointer;"><br></div>
<div>
<br></div>
<div>
这是打了 KB4056892 补丁后通过 msr 取到的 SyscallEntry，可以看到函数名是 KiSystemCall64Shadow。

<br></div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_EKTR74TX2G8GNC2.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></div>
<div>
<br></div>
<div>
在函数尾部有一个 jmp，跳到了真正的入口 KiSystemServiceUser，而这个真正的入口一定是在 KVASCODE 区段外。

<br></div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_2GXA27XP79NBQ65.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></div>
<div>
<br></div>
<div>
所以我们利用 HDE 反汇编引擎，对影子入口的每条指令进行解析，找到一条跳出 KVASCODE 区段的 jmp 指令。</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">hde64s&nbsp;Hde;</code></div><div class="line number2 index1 alt1"><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(</code><code class="cpp color1 bold">PVOID</code>&nbsp;<code class="cpp plain">ShadowPagePtr&nbsp;=&nbsp;SyscallEntry;&nbsp;;&nbsp;ShadowPagePtr&nbsp;=&nbsp;(</code><code class="cpp color1 bold">PVOID</code><code class="cpp plain">)((</code><code class="cpp color1 bold">ULONG_PTR</code><code class="cpp plain">)ShadowPagePtr&nbsp;+&nbsp;Hde.len))</code></div><div class="line number3 index2 alt2"><code class="cpp plain">{</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;解析每条汇编指令，找到第一个&nbsp;jmp（e9）&nbsp;出&nbsp;KVASCODE&nbsp;区段的指令</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(!hde64_disasm(ShadowPagePtr,&nbsp;&amp;Hde))&nbsp;{</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(Hde.opcode&nbsp;!=&nbsp;0xE9)&nbsp;{</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">continue</code><code class="cpp plain">;</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;忽略&nbsp;jmp&nbsp;目标为&nbsp;KVASCODE&nbsp;区域内的指令</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">PVOID</code>&nbsp;<code class="cpp plain">KiSystemServiceUser&nbsp;=&nbsp;(</code><code class="cpp color1 bold">PVOID</code><code class="cpp plain">)((</code><code class="cpp color1 bold">ULONG_PTR</code><code class="cpp plain">)ShadowPagePtr&nbsp;+&nbsp;(</code><code class="cpp color1 bold">INT</code><code class="cpp plain">)Hde.len&nbsp;+&nbsp;(</code><code class="cpp color1 bold">INT</code><code class="cpp plain">)Hde.imm.imm32);</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(KiSystemServiceUser&nbsp;&gt;=&nbsp;SectionBase&nbsp;&amp;&amp;&nbsp;KiSystemServiceUser&nbsp;&lt;&nbsp;(</code><code class="cpp color1 bold">PVOID</code><code class="cpp plain">)((</code><code class="cpp color1 bold">ULONG_PTR</code><code class="cpp plain">)SectionBase&nbsp;+&nbsp;SectionSize))&nbsp;{</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">continue</code><code class="cpp plain">;</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;找到&nbsp;KiSystemServiceUser</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">SyscallEntry&nbsp;=&nbsp;KiSystemServiceUser;</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number22 index21 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</div>
<div>
至此，定位到真实 SyscallEntry 函数地址。</div>
<div>
<br></div>
<div>
<br></div>
<div>
再回过头来看看我们刚刚找的 CkclWmiLoggerContext。</div>
<div>
这个变量的结构体定义是 WMI_LOGGER_CONTEXT。</div>
<div>
通过 Windbg 输出这个结构体在 Win10 1709 上的定义：</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">0:&nbsp;kd&gt;&nbsp;dt&nbsp;nt!_WMI_LOGGER_CONTEXT</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x000&nbsp;LoggerId&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Uint4B</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x004&nbsp;BufferSize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Uint4B</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x008&nbsp;MaximumEventSize&nbsp;:&nbsp;Uint4B</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x00c&nbsp;LoggerMode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Uint4B</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x010&nbsp;AcceptNewEvents&nbsp;&nbsp;:&nbsp;Int4B</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x014&nbsp;EventMarker&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;[2]&nbsp;Uint4B</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x01c&nbsp;ErrorMarker&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Uint4B</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x020&nbsp;SizeMask&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Uint4B</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x028&nbsp;GetCpuClock&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Ptr64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int64&nbsp;</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x030&nbsp;LoggerThread&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Ptr64&nbsp;_ETHREAD</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x038&nbsp;LoggerStatus&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Int4B</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x03c&nbsp;FailureReason&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Uint4B</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x040&nbsp;BufferQueue&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;_ETW_BUFFER_QUEUE</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x050&nbsp;OverflowQueue&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;_ETW_BUFFER_QUEUE</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x060&nbsp;GlobalList&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;_LIST_ENTRY</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x070&nbsp;DebugIdTrackingList&nbsp;:&nbsp;_LIST_ENTRY</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x080&nbsp;DecodeControlList&nbsp;:&nbsp;Ptr64&nbsp;_ETW_DECODE_CONTROL_ENTRY</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x088&nbsp;DecodeControlCount&nbsp;:&nbsp;Uint4B</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x090&nbsp;BatchedBufferList&nbsp;:&nbsp;Ptr64&nbsp;_WMI_BUFFER_HEADER</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x090&nbsp;CurrentBuffer&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;_EX_FAST_REF</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x098&nbsp;LoggerName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;_UNICODE_STRING</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x0a8&nbsp;LogFileName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;_UNICODE_STRING</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x0b8&nbsp;LogFilePattern&nbsp;&nbsp;&nbsp;:&nbsp;_UNICODE_STRING</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x0c8&nbsp;NewLogFileName&nbsp;&nbsp;&nbsp;:&nbsp;_UNICODE_STRING</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x0d8&nbsp;ClockType&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Uint4B</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x0dc&nbsp;LastFlushedBuffer&nbsp;:&nbsp;Uint4B</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x0e0&nbsp;FlushTimer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Uint4B</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x0e4&nbsp;FlushThreshold&nbsp;&nbsp;&nbsp;:&nbsp;Uint4B</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x0e8&nbsp;ByteOffset&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;_LARGE_INTEGER</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x0f0&nbsp;MinimumBuffers&nbsp;&nbsp;&nbsp;:&nbsp;Uint4B</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x0f4&nbsp;BuffersAvailable&nbsp;:&nbsp;Int4B</code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x0f8&nbsp;NumberOfBuffers&nbsp;&nbsp;:&nbsp;Int4B</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x0fc&nbsp;MaximumBuffers&nbsp;&nbsp;&nbsp;:&nbsp;Uint4B</code></div><div class="line number35 index34 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x100&nbsp;EventsLost&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;Uint4B</code></div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">......</code></div><div class="line number37 index36 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">+0x980&nbsp;BufferCompressDuration&nbsp;:&nbsp;_LARGE_INTEGER</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</div>
<div>
在 WMI_LOGGER_CONTEXT + 0x28 的位置 GetCpuClock 是一个函数指针。<br></div>
<div>
<p>
这个函数将在每次触发 CKCL 事件跟踪时会被调用。</p>

<p>
换言之就是每次发生 Syscall 时会触发 CKCL 事件，从而调用到 GetCpuClock。</p>

<br></div>
<div>
GetCpuClock 的函数指针指向就是根据我们开启事件跟踪填写的 pProperty-&gt;Wnode.ClientContext 来赋值的。</div>
<div>
ClientContext 的：1、2、3，分别对应给GetCpuClock赋值：PpmQueryTime、EtwpGetSystemTime、EtwpGetCycleCount。</div>
<div>
我们之前填的3，所以这个指针应该指向 EtwpGetCycleCount。</div>
<div>
<br></div>
<div>
通过IDA看一下 EtwpGetCycleCount 的实现：</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">unsigned&nbsp;</code><code class="cpp color1 bold">__int64</code>&nbsp;<code class="cpp plain">EtwpGetCycleCount()</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">__rdtsc();</code></div><div class="line number4 index3 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</div>
<div>
我们在这里将这个指针替换为我们自己的函数。</div>
<div>
<span style="font-size:6;"><div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">PVOID</code>&nbsp;<code class="cpp plain">ReplaceGetCpuClock(</code><code class="cpp color1 bold">PVOID</code>&nbsp;<code class="cpp plain">TargetAddr)</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">PVOID</code>&nbsp;<code class="cpp plain">*pEtwpGetCycleCount&nbsp;=&nbsp;(</code><code class="cpp color1 bold">PVOID</code><code class="cpp plain">*)((</code><code class="cpp color1 bold">ULONG_PTR</code><code class="cpp plain">)g.CkclWmiLoggerContext&nbsp;+&nbsp;0x28);</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">PVOID</code>&nbsp;<code class="cpp plain">Result&nbsp;=&nbsp;*pEtwpGetCycleCount;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">*pEtwpGetCycleCount&nbsp;=&nbsp;TargetAddr;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">Result;</code></div><div class="line number7 index6 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</span></div>
<div>
<span style="font-size:6;"><div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">ReplaceGetCpuClock(FakeGetCpuClock);</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</span></div>
<div>
<span style="font-size:6;">在 FakeGetCpuClock 函数内，先判断当前 PreviousMode 是否为 KernelMode。</span><br></div>
<div>
当为 KernelMode 时，我们直接返回 rdtsc() ，防止意外重入。</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">ULONG64</code>&nbsp;<code class="cpp plain">FakeGetCpuClock()</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(ExGetPreviousMode()&nbsp;==&nbsp;KernelMode)&nbsp;{</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">__rdtsc();</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;......</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">__rdtsc();</code></div><div class="line number10 index9 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</div>
<div>
<span style="font-size:6;">接着我们需要取到栈顶和栈帧，往上遍历堆栈。</span></div>
<div>
<p>
<br></p>

<p>
在gs段寄存器中同样存放着栈顶，在其偏移量 0x1a8 的位置。</p>

<p>
通过内联函数获取 __readgsqword 进行取值。</p></div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">PVOID</code>&nbsp;<code class="cpp plain">*StackBase&nbsp;=&nbsp;(</code><code class="cpp color1 bold">PVOID</code><code class="cpp plain">*)__readgsqword(0x1A8);</code></div><div class="line number2 index1 alt1"><code class="cpp color1 bold">PVOID</code>&nbsp;<code class="cpp plain">*StackFrame&nbsp;=&nbsp;(</code><code class="cpp color1 bold">PVOID</code><code class="cpp plain">*)_AddressOfReturnAddress();</code></div></div></td></tr></tbody></table>
</div>
</div>
<div>
<br></div>
<div>
<p>
虽然这里可以通过 KeQueryCurrentStackInformation，进行获取。</p>

<p>
但还记得我们文章开头说的话吗，如果被别人 Hook 了这个 API 岂不是只能甘拜下风了？</p>

<p>
所以我们需要尽可能的少用及不用 API。</p>

</div>
<div>
<br></div>
<div>
判断两个只有 Syscall 调用才会产生的标志，和之间的指针是否有在 SyscallEntry 函数范围内，以此来确定这是否是一个 Syscall 调用事件。</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(</code><code class="cpp color1 bold">PVOID</code>&nbsp;<code class="cpp plain">*StackCurrent&nbsp;=&nbsp;StackBase;&nbsp;StackCurrent&nbsp;&gt;&nbsp;StackFrame;&nbsp;StackCurrent--)</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;检查Syscall特有标志</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(*(</code><code class="cpp color1 bold">ULONG</code><code class="cpp plain">*)StackCurrent&nbsp;!=&nbsp;(</code><code class="cpp color1 bold">ULONG</code><code class="cpp plain">)0x501802&nbsp;||&nbsp;*(</code><code class="cpp color1 bold">USHORT</code><code class="cpp plain">*)(StackCurrent&nbsp;-&nbsp;1)&nbsp;!=&nbsp;(</code><code class="cpp color1 bold">USHORT</code><code class="cpp plain">)0xF33)&nbsp;{</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">continue</code><code class="cpp plain">;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;往回遍历</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(StackCurrent--;&nbsp;StackCurrent&nbsp;&lt;&nbsp;StackBase;&nbsp;++StackCurrent)</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">PVOID</code>&nbsp;<code class="cpp plain">CurrentPage&nbsp;=&nbsp;PAGE_ALIGN(*StackCurrent);</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;粗略用2个页的大小判断一下是否是Syscall调用</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(CurrentPage&nbsp;&lt;&nbsp;g.SystemCallEntryPage&nbsp;||&nbsp;</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">CurrentPage&nbsp;&gt;=&nbsp;(</code><code class="cpp color1 bold">PVOID</code><code class="cpp plain">)((</code><code class="cpp color1 bold">ULONG_PTR</code><code class="cpp plain">)g.SystemCallEntryPage&nbsp;+&nbsp;PAGE_SIZE&nbsp;*&nbsp;2))&nbsp;{</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">continue</code><code class="cpp plain">;</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//&nbsp;到这里基本可以确定为Syscall事件了</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number21 index20 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</div>
<div>
此次事件的 Syscall 目标指针则相对存放在当前栈的 rsp + 72h 处，我们调用另一个函数对此 Syscall 目标指针进行派发修改。</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">PVOID</code>&nbsp;<code class="cpp plain">*SyscallTarget&nbsp;=&nbsp;&amp;StackCurrent[9];</code></div><div class="line number2 index1 alt1"><code class="cpp plain">SyscallDispatch(SyscallTarget);</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</div>
<div>
我们先在驱动入口函数中中取到 NtOpenProcess 的地址保存起来。</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">g.OriginalNtOpenProcess&nbsp;=&nbsp;(fn_NtOpenProcess)Utils::GetRoutineAddress(L</code><code class="cpp string">"NtOpenProcess"</code><code class="cpp plain">);</code></div><div class="line number2 index1 alt1"><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(g.OriginalNtOpenProcess&nbsp;==&nbsp;NULL)&nbsp;{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">STATUS_UNSUCCESSFUL;</code></div><div class="line number4 index3 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table>
</div>
</div>
<div>
<br></div>
<div>
再与这里的 SyscallTarget 做对比，如果地址相同则修改到我们自己的 FakeNtOpenProcess。</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">SyscallDispatch(</code><code class="cpp color1 bold">PVOID</code>&nbsp;<code class="cpp plain">*SyscallTarget)</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(*SyscallTarget&nbsp;==&nbsp;g.OriginalNtOpenProcess)&nbsp;{</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">*SyscallTarget&nbsp;=&nbsp;FakeNtOpenProcess;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number6 index5 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</div>
<div>
然后在 FakeNtOpenProcess 中做相应的处理。</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">NTSTATUS&nbsp;FakeNtOpenProcess(</code><code class="cpp color1 bold">PHANDLE</code>&nbsp;<code class="cpp plain">ProcessHandle,&nbsp;ACCESS_MASK&nbsp;DesiredAccess,&nbsp;POBJECT_ATTRIBUTES&nbsp;ObjectAttributes,&nbsp;PCLIENT_ID&nbsp;ClientId)</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(ClientId-&gt;UniqueProcess&nbsp;==&nbsp;(</code><code class="cpp color1 bold">HANDLE</code><code class="cpp plain">)123)&nbsp;{</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">LOG_INFO(</code><code class="cpp string">"Target&nbsp;process&nbsp;is&nbsp;being&nbsp;opened."</code><code class="cpp plain">,&nbsp;0);</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">STATUS_ACCESS_DENIED;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">g.OriginalNtOpenProcess(ProcessHandle,&nbsp;DesiredAccess,&nbsp;ObjectAttributes,&nbsp;ClientId);</code></div><div class="line number9 index8 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
<div>
接着在驱动卸载例程中调用我们封装的 EventTraceControl 函数关闭或重启 CKCL。</div>
<div>
因为基本在所有系统上，CKCL 事件跟踪会话是默认开启的，所以我们尽量重启它，而不是关闭。</div>
<div>
重启之后其所有信息都会恢复默认，就不需要还原对 GetCpuClock 指针的修改了。</div>
<div>
<div>
<table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(NT_SUCCESS(EventTraceControl(CKCL_TRACE_END)))&nbsp;{</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">EventTraceControl(CKCL_TRACE_START);</code></div><div class="line number3 index2 alt2"><code class="cpp plain">}</code></div></div></td></tr></tbody></table>
</div>
<div>
<br></div>
</div>
<div>
至此，驱动层的代码已写完。<span style="font-size:6;">编译驱动，在虚拟机中测试看下效果。</span></div>
<div>
<br></div>
</div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_96D4TW4G7CAQPQ5.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></div>
<div>
<br></div>
<div>
再看下 Windbg 的调试输出信息</div>
<div>
<br></div>
<div>
<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_9SSCXV7HA46MR34.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></div>
<div>
<span style="color:inherit; font-family:inherit; font-size:6; font-weight:bold;"><br></span></div>
</blockquote><span style="color:inherit; font-family:inherit; font-size:6; font-weight:bold;">0x03.2 InfinityHook 的执行流程图</span><br></blockquote><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><div style="text-align:center;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_MRQVHHZRAQAUWGD.jpg" style="cursor: pointer;" class="div_message_boxShadow"><br></div>
<div style="text-align:center;">（InfinityHook 驱动层执行流程图）</div>
<div style="text-align:center;"><br></div>
<div style="text-align:center;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_HMCN8W37VWRRVMZ.jpg" style="cursor: pointer;"><br></div>
<div style="text-align:center;">（InfinityHook 钩子执行流程图）</div>
</blockquote></blockquote><div style="color:inherit; font-family:inherit; font-size:6; font-weight:bold;"><span style="color:inherit; font-family:inherit; font-size:6;"><br></span></div>
<h1>0x04 总结</h1>
<div>
<blockquote style="margin:0 0 0 40px; border:none; padding:0px;"><div>
相关参考资料链接：</div>
<div>
<blockquote class="blockquote"><p>
https://github.com/everdox/InfinityHook

</p>

<p>
https://docs.microsoft.com/en-us/windows/win32/etw/about-event-tracing<br></p>

<p>
https://docs.microsoft.com/en-us/windows/win32/etw/configuring-and-starting-the-nt-kernel-logger-session<br></p>

<p>
https://bbs.pediy.com/thread-223805.htm<br></p>

</blockquote></div>
<div>
<span style="font-size:6;">InfinityHook 说到底也算是 PatchGuard 的一个疏忽，不出意外的话在不久的将来应该会被微软修复。</span><br></div>
<div>
但至少这短暂的时间也够看一场戏了。</div>
<div>
<br></div>
<div>
<span style="font-size:6;">毕竟攻防无绝对，技术无黑白。</span><br></div>
<div>
没有攻与防之间的战斗，哪里来绝对的安全呢？</div>
<div>
<br></div>
<div>
如果发现文章内容有任何不正之处，欢迎评论区指出。

<br></div>
<div>
感谢阅读！</div>
</blockquote></div>
					<br><br>
<p><a href="https://qifu.kanxue.com/demand.htm">[公告]安全测试和项目外包请将项目需求发到看雪企服平台：https://qifu.kanxue.com </a></p>

		<div class="text-right text-muted my-3 small font-italic">
		最后于 <span class="icon-clock-o ml-2"> </span>6天前		
				被Sprite雪碧编辑
				
		，原因： 		
	</div>

										
										
					
								</div>
				
				<div>
								</div>
				
				<div class="" style="height: 33px; line-height: 33px; border-top: 1px solid #ddd;">
														</div>
			</div>
		</div>
		
		                
                
                <!--赞赏支持-->
                <div class="modal fade reward" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                        <div class="modal-header">
                                            <h4 class="modal-title" id="exampleModalLabel">赞赏</h4>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                    <span aria-hidden="true">×</span>
                                            </button>
                                        </div>
                                        <form action="https://bbs.pediy.com/thread-253450.htm" method="post" id="pay_kx" onsubmit="return topay()">
                                                <div class="modal-body text-center">
                                                        <div class="form-group">
                                                                <input name="ureward" type="hidden" value="592310">
                                                                <input type="hidden" name="reward_articleid" value="253450">
                                                                <div class="avatar-3 mb-3" style="width: 70px;height: 70px;display: inline-block;">
                                                                    <img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/dashang.png" alt="100">
                                                                </div>
                                                                
                                                                <div class="text-center mb-2">
                                                                    <div class="" data-toggle="buttons">
                                                                        <label class="btn btn-outline-danger active" style="width:120px">
                                                                            <input type="radio" class="d-none" value="1" name="reward_rmbs" id="option1" autocomplete="off" checked="">1 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="2" name="reward_rmbs" id="option2" autocomplete="off">2 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="5" name="reward_rmbs" id="option3" autocomplete="off">5 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="10" name="reward_rmbs" id="option4" autocomplete="off">10 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="20" name="reward_rmbs" id="option5" autocomplete="off">20 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="50" name="reward_rmbs" id="option6" autocomplete="off">50 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="100" name="reward_rmbs" id="option7" autocomplete="off">100 元
                                                                        </label>
                                                                        <label class="btn btn-outline-danger" style="width:120px">
                                                                            <input type="radio" class="d-none" value="200" name="reward_rmbs" id="option8" autocomplete="off">200 元
                                                                        </label>
                                                                    </div>
                                                                </div>

                                                                <div class="text-center">
                                                                    <label id="alipay_lab">
                                                                        <span>支付方式：</span>
                                                                        <input type="radio" value="1" checked="checked" name="reward_type" style="display:inline">
                                                                        <span class="alipay-bg"></span>
                                                                    </label>
                                                                    <label class="ml-3">
                                                                        <input type="radio" value="3" name="reward_type">
                                                                        <i class="icon icon-weixin" style="font-size:17px;color:#49BE38"></i> 微信支付
                                                                    </label>
                                                                                                                                        <label class="ml-3"><input type="radio" value="2" name="reward_type"> 余额（余额 ¥0.00）</label>
                                                                                                                                    </div>
                                                        </div>
                                                </div>
                                                <div class="px-3 mb-3">
                                                    <div class="mb-2">赞赏留言：</div>
                                                    <div class="my-2">
                                                        <select class="form-control form-control-sm reward_reason" style="max-width: 90px;">
                                                            <option value="0">快捷留言</option>
                                                            <option value="感谢分享～">感谢分享～</option>
                                                            <option value="精品文章～">精品文章～</option>
                                                            <option value="原创内容～">原创内容～</option>
                                                            <option value="精彩转帖～">精彩转帖～</option>
                                                            <option value="助人为乐～">助人为乐～</option>
                                                            
                                                        </select>
                                                    </div>
                                                    <textarea class="form-control reward_reason_textarea" name="brief" rows="1"></textarea>
                                                    
                                                </div>
                                                <div class="modal-footer">
                                                        <button id="pay_submit" type="submit" class="btn btn-primary btn-pay kx-pay" data-loading-text="正在提交...">立即支付</button>
                                                </div>
                                        </form>
                                </div>
                        </div>
                </div>
		<style>
			.card_collection { vertical-align: middle; display: inline-block; border: 1px solid #eee; background: #EEEEEE; padding: 0px 8px; border-radius: 5px; }
			.card_collection p { margin-bottom: 0px;font-size: 12px;}
			.card_collection p a { text-decoration: none; }
			.alipay-bg { width: 60px;height: 20px;display: inline-block;vertical-align: middle;background: url(view/img/reward_alipay.png) 0 0 no-repeat;}
			.color4A4A4A {
				color: #4A4A4A;
			}
		</style>
		<div class="card" style="background:#F9F9F9;text-align:center;padding:5px 0px;">
			<div style="width:auto;display:inline-block;">
				<div class="card_collection" style="width: 70px; height: 65px;line-height:30px">
					<p><a href="https://bbs.pediy.com/user-collection.htm" class="color4A4A4A" style="font-size: 13px;">						<span id="likes">82</span>
						</a>					</p>
					<p id="favorite">
						<a href="javascript:void(0)" class="color4A4A4A" title="点我收藏">
														<i class="icon-star-o color4A4A4A"></i>&nbsp;收藏
													</a>
					</p>
				</div>

				<div class="card_collection" style="width: 70px; height: 65px;line-height:30px">
					<p><span id="thread_thumb_num" class="color4A4A4A" style="font-size: 13px;">11</span></p>
					<p id="thumb">
						<a href="javascript:void(0)" class="color4A4A4A">
														<i class="icon-thumbs-o-up color4A4A4A"></i>&nbsp;赞
													</a>
					</p>
				</div>
				<div class="card_collection" style="width: 70px; height: 65px;line-height:30px">
					
						<p>
							<a href="javascript:void(0);" class="modal-title d-inline-block" id="exampleModalLabel" data-toggle="modal" data-target=".reward">
								<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/renminbi.png" style="" alt="">
							</a>
						</p>
						<p>
							<a href="javascript:void(0);" class="modal-title d-inline-block" id="exampleModalLabel" data-toggle="modal" data-target=".reward">
							<span class="color4A4A4A">打赏</span>
							</a>
						</p>
					
				</div>
				<div class="card_collection bbsshare_btn" style="width: 70px; height: 65px;line-height:30px">
					
						<p>
							<a href="javascript:void(0);" class="modal-title d-inline-block">
								<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/bbsshare.png" style="" alt="">
							</a>
						</p>
						<p>
							<a href="javascript:void(0);" class="modal-title d-inline-block">
							<span class="color4A4A4A">分享</span>
							</a>
						</p>
					
				</div>
				<!-- <div class="card_collection" style="padding-top: 5px; padding-bottom: 5px;">
					<a href="javascript:void(0);" class="modal-title" id="exampleModalLabel" data-toggle="modal" data-target=".reward">
						<img src="view/img/dashang.png" alt="赞赏" style="width:50px;vertical-align: middle;" title="现金赞赏支持">
					</a>
				</div> -->

				<!-- <div class="card_collection">
					<img src="bbs_qrcode-http_3A_2F_2Fbbs_2epediy_2ecom_2Fthread_2d253450_2ehtm.htm" alt="二维码" style="width:60px;height:60px;vertical-align: middle; ">
				</div> -->
				<!-- <div class="card_collection" style="padding-top: 5px; padding-bottom: 5px;">
					<img src="view/img/bbsshare.png" class="bbsshare_btn" style="width: 50px; cursor: pointer; vertical-align: middle;" title="">
				</div> -->

				<div class="bd-bbsshare-modal-sm" style="display: none;">
					<div>
						<div class="px-5 py-4">
							<div class="text-left">分享到：</div>
							<div class="pt-4">
							
								<div onclick="shareTo(&#39;qzone&#39;)" class="fl d-inline-block mr-3" style="cursor: pointer;">
									<img width="32" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/qqzoneshare.png">
								</div>
								<div onclick="shareTo(&#39;qq&#39;)" class="fl d-inline-block mr-3" style="cursor: pointer;">
									<img width="32" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/qqshare.png">
								</div>
								<div onclick="shareTo(&#39;sina&#39;)" class="fl d-inline-block mr-3" style="cursor: pointer;">
									<img width="32" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sinaweiboshare.png">
								</div>
								<div onclick="shareTo(&#39;wechat&#39;)" id="wxshare" class="fl d-inline-block" style="cursor:pointer;">
									<img width="32" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/wechatshare.png">
								</div>
								
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="card p-1">
			<div class="card-body">
				<table class="table postlist mb-0">
					<thead>
						<tr>
							<th colspan="2" class="pa-0  pb-1">
								<dl class="row">
									<dt>
										<b>最新回复</b> (<span class="posts">42</span>)
									</dt>
									<dd style="text-align: right;">
										
										
																				
									</dd>
								</dl>
							</th>
						</tr>
					</thead>
					<tbody>
					
														
				
																			
										
										
					<tr class="post" data-pid="1602872">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-99882.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/99882.png">
							</a>
							<div class="mt-2">
								<span class="group group-112 mr-1" data-gid="112" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2007-6 <br>
								帖子：599 <br>-->
<!-- 
																<a href="user-99882-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 8</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars03.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-99882.htm">xiaofu</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-99882-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 8</span>
										</a>
																		<span class="post_online_time" data-online_time="8410411" data-desc="在线时长: 2336 小时 ( 32 级)&lt;br/&gt; 升级还需要 105 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-30 11:39</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1602872" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602872" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1602872" id="1602872" class="text-grey mr-3"><span class="floor">2</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="99882" name="praised_uid">
		<input type="hidden" value="1602872" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1602872" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602872" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								nice~支持								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1602873">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-587311.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/587311.png">
							</a>
							<div class="mt-2">
								<span class="group group-108 mr-1" data-gid="108" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2013-6 <br>
								帖子：172 <br>-->
<!-- 
																<a href="user-587311-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars02.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-587311.htm">nevinhappy</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-587311-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 2</span>
										</a>
																		<span class="post_online_time" data-online_time="2781053" data-desc="在线时长: 772 小时 ( 17 级)&lt;br/&gt; 升级还需要 19 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-30 11:41</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1602873" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602873" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1602873" id="1602873" class="text-grey mr-3"><span class="floor">3</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="587311" name="praised_uid">
		<input type="hidden" value="1602873" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1602873" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602873" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								好文，学习！								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1602879">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-466641.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/466641.png">
							</a>
							<div class="mt-2">
								<span class="group group-107 mr-1" data-gid="107" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2011-11 <br>
								帖子：328 <br>-->
<!-- 
																<a href="user-466641-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-466641.htm">pxhb</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-466641-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 2</span>
										</a>
																		<span class="post_online_time" data-online_time="3309724" data-desc="在线时长: 919 小时 ( 19 级)&lt;br/&gt; 升级还需要 40 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-30 12:01</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1602879" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602879" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1602879" id="1602879" class="text-grey mr-3"><span class="floor">4</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="466641" name="praised_uid">
		<input type="hidden" value="1602879" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1602879" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602879" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								&nbsp;毕竟攻防无绝对，技术无黑白。<br>没有攻与防之间的战斗，哪里来绝对的安全<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/48.gif" class="face" style="cursor: pointer;">								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1602894">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-732349.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/avatar.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2016-9 <br>
								帖子：85 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-732349.htm">whathhh</a>
									</span>
									
																		<span class="post_online_time" data-online_time="2441617" data-desc="在线时长: 678 小时 ( 16 级)&lt;br/&gt; 升级还需要 35 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-30 13:50</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1602894" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602894" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1602894" id="1602894" class="text-grey mr-3"><span class="floor">5</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="732349" name="praised_uid">
		<input type="hidden" value="1602894" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1602894" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602894" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								666666								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1602900">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-658134.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/658134.png">
							</a>
							<div class="mt-2">
								<span class="group group-103 mr-1" data-gid="103" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2014-11 <br>
								帖子：160 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars02.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-658134.htm">刘铠文</a>
									</span>
									
																		<span class="post_online_time" data-online_time="4178671" data-desc="在线时长: 1160 小时 ( 22 级)&lt;br/&gt; 升级还需要 81 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-30 15:17</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1602900" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602900" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1602900" id="1602900" class="text-grey mr-3"><span class="floor">6</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="658134" name="praised_uid">
		<input type="hidden" value="1602900" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1602900" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602900" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								火钳刘明								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1602906">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-615441.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/615441.png">
							</a>
							<div class="mt-2">
								<span class="group group-105 mr-1" data-gid="105" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2014-1 <br>
								帖子：315 <br>-->
<!-- 
																<a href="user-615441-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 1</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars02.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-615441.htm">黑洛</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-615441-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 1</span>
										</a>
																		<span class="post_online_time" data-online_time="2095569" data-desc="在线时长: 582 小时 ( 15 级)&lt;br/&gt; 升级还需要 57 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-30 16:02</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1602906" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602906" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1602906" id="1602906" class="text-grey mr-3"><span class="floor">7</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="615441" name="praised_uid">
		<input type="hidden" value="1602906" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1602906" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602906" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								19xx可能来不及了，下一个版本有望被patchguard修复。如果影响力不大的话可能会放过（怎么可能）								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1602917">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-765390.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/765390.png">
							</a>
							<div class="mt-2">
								<span class="group group-105 mr-1" data-gid="105" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2017-9 <br>
								帖子：36 <br>-->
<!-- 
																<a href="user-765390-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 1</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars02.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-765390.htm">Justgoon</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-765390-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 1</span>
										</a>
																		<span class="post_online_time" data-online_time="1262673" data-desc="在线时长: 350 小时 ( 11 级)&lt;br/&gt; 升级还需要 33 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-30 17:09</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1602917" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602917" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1602917" id="1602917" class="text-grey mr-3"><span class="floor">8</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="765390" name="praised_uid">
		<input type="hidden" value="1602917" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1602917" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602917" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								mark								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1602922">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-690570.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/690570.png">
							</a>
							<div class="mt-2">
								<span class="group group-105 mr-1" data-gid="105" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2015-8 <br>
								帖子：332 <br>-->
<!-- 
																<a href="user-690570-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 1</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars02.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-690570.htm">万剑归宗</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-690570-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 1</span>
										</a>
																		<span class="post_online_time" data-online_time="3387495" data-desc="在线时长: 940 小时 ( 19 级)&lt;br/&gt; 升级还需要 19 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-30 17:20</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1602922" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602922" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1602922" id="1602922" class="text-grey mr-3"><span class="floor">9</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="690570" name="praised_uid">
		<input type="hidden" value="1602922" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1602922" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602922" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								lei了lei了								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1602933">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-445932.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/445932.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2011-8 <br>
								帖子：26 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-445932.htm">wmslecz</a>
									</span>
									
																		<span class="post_online_time" data-online_time="953474" data-desc="在线时长: 264 小时 ( 9 级)&lt;br/&gt; 升级还需要 15 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-30 18:05</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1602933" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602933" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1602933" id="1602933" class="text-grey mr-3"><span class="floor">10</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="445932" name="praised_uid">
		<input type="hidden" value="1602933" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1602933" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602933" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								无敌啊。								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1602941">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-766647.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/766647.png">
							</a>
							<div class="mt-2">
								<span class="group group-104 mr-1" data-gid="104" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2017-10 <br>
								帖子：49 <br>-->
<!-- 
																<a href="user-766647-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 1</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-766647.htm">HadesW</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-766647-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 1</span>
										</a>
																		<span class="post_online_time" data-online_time="4455661" data-desc="在线时长: 1237 小时 ( 22 级)&lt;br/&gt; 升级还需要 4 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-30 19:49</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1602941" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602941" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1602941" id="1602941" class="text-grey mr-3"><span class="floor">11</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="766647" name="praised_uid">
		<input type="hidden" value="1602941" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1602941" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602941" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								发出来了，可以的，先回复一下，之后再看								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1602946">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-671762.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/671762.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2015-3 <br>
								帖子：99 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-671762.htm">实都</a>
									</span>
									
																		<span class="post_online_time" data-online_time="3606427" data-desc="在线时长: 1001 小时 ( 20 级)&lt;br/&gt; 升级还需要 48 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-30 20:48</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1602946" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602946" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1602946" id="1602946" class="text-grey mr-3"><span class="floor">12</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="671762" name="praised_uid">
		<input type="hidden" value="1602946" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1602946" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602946" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								既然发出来了&nbsp;&nbsp;就等着被修复吧								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1602976">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-766647.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/766647.png">
							</a>
							<div class="mt-2">
								<span class="group group-104 mr-1" data-gid="104" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2017-10 <br>
								帖子：49 <br>-->
<!-- 
																<a href="user-766647-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 1</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-766647.htm">HadesW</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-766647-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 1</span>
										</a>
																		<span class="post_online_time" data-online_time="4455661" data-desc="在线时长: 1237 小时 ( 22 级)&lt;br/&gt; 升级还需要 4 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-31 00:12</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1602976" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602976" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1602976" id="1602976" class="text-grey mr-3"><span class="floor">13</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="766647" name="praised_uid">
		<input type="hidden" value="1602976" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1602976" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602976" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								等大佬们搞其他事件的Hook<div><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/766647_J3SB9TVHJT5TJAC.jpg" style="cursor: pointer;"></div>								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1602979">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-453009.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/453009.png">
							</a>
							<div class="mt-2">
								<span class="group group-109 mr-1" data-gid="109" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2011-9 <br>
								帖子：380 <br>-->
<!-- 
																<a href="user-453009-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars03.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-453009.htm">malokch</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-453009-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 2</span>
										</a>
																		<span class="post_online_time" data-online_time="2261881" data-desc="在线时长: 628 小时 ( 15 级)&lt;br/&gt; 升级还需要 11 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-31 00:39</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1602979" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602979" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1602979" id="1602979" class="text-grey mr-3"><span class="floor">14</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="453009" name="praised_uid">
		<input type="hidden" value="1602979" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1602979" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602979" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								类似的技术我已经用很久了，终于有人发出来了。这套技术还可以用于注入代码到进程运行。								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1602981">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-786701.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/786701.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2018-2 <br>
								帖子：66 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-786701.htm">如斯咩咩咩</a>
									</span>
									
																		<span class="post_online_time" data-online_time="481291" data-desc="在线时长: 133 小时 ( 6 级)&lt;br/&gt; 升级还需要 20 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-31 02:22</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1602981" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602981" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1602981" id="1602981" class="text-grey mr-3"><span class="floor">15</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="786701" name="praised_uid">
		<input type="hidden" value="1602981" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1602981" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602981" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								lei了lei了，mark								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1602985">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-741716.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/741716.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2016-12 <br>
								帖子：136 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-741716.htm">BkHumor</a>
									</span>
									
																		<span class="post_online_time" data-online_time="3296236" data-desc="在线时长: 915 小时 ( 19 级)&lt;br/&gt; 升级还需要 44 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-31 05:13</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1602985" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602985" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1602985" id="1602985" class="text-grey mr-3"><span class="floor">16</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="741716" name="praised_uid">
		<input type="hidden" value="1602985" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1602985" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602985" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/63.gif" class="face" style="cursor: pointer;">								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1602987">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-457633.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/457633.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2011-10 <br>
								帖子：172 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-457633.htm">friendanx</a>
									</span>
									
																		<span class="post_online_time" data-online_time="2051563" data-desc="在线时长: 569 小时 ( 14 级)&lt;br/&gt; 升级还需要 0 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-31 07:35</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1602987" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602987" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1602987" id="1602987" class="text-grey mr-3"><span class="floor">17</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="457633" name="praised_uid">
		<input type="hidden" value="1602987" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1602987" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602987" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								分析很到位，赞<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/63.gif" class="face" style="cursor: pointer;">								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1602988">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-564154.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/564154.png">
							</a>
							<div class="mt-2">
								<span class="group group-104 mr-1" data-gid="104" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2013-1 <br>
								帖子：26 <br>-->
<!-- 
																<a href="user-564154-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 1</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-564154.htm">mlgbwoai</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-564154-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 1</span>
										</a>
																		<span class="post_online_time" data-online_time="922535" data-desc="在线时长: 256 小时 ( 9 级)&lt;br/&gt; 升级还需要 23 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-31 07:50</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1602988" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602988" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1602988" id="1602988" class="text-grey mr-3"><span class="floor">18</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="564154" name="praised_uid">
		<input type="hidden" value="1602988" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1602988" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1602988" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																																
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1603008">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-779730.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/779730.png">
							</a>
							<div class="mt-2">
								<span class="group group-108 mr-1" data-gid="108" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2017-12 <br>
								帖子：122 <br>-->
<!-- 
																<a href="user-779730-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars02.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-779730.htm">有毒</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-779730-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 2</span>
										</a>
																		<span class="post_online_time" data-online_time="588814" data-desc="在线时长: 163 小时 ( 7 级)&lt;br/&gt; 升级还需要 28 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-31 10:40</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1603008" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603008" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1603008" id="1603008" class="text-grey mr-3"><span class="floor">19</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="779730" name="praised_uid">
		<input type="hidden" value="1603008" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1603008" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603008" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								这个流批！讲的很详细								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1603036">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-181388.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/avatar.png">
							</a>
							<div class="mt-2">
								<span class="group group-105 mr-1" data-gid="105" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2008-5 <br>
								帖子：302 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars02.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-181388.htm">囧囧</a>
									</span>
									
																		<span class="post_online_time" data-online_time="4679475" data-desc="在线时长: 1299 小时 ( 23 级)&lt;br/&gt; 升级还需要 44 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-31 12:00</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1603036" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603036" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1603036" id="1603036" class="text-grey mr-3"><span class="floor">20</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="181388" name="praised_uid">
		<input type="hidden" value="1603036" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1603036" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603036" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								牛逼666								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1603037">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-787127.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/787127.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2018-2 <br>
								帖子：35 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-787127.htm">miWusn</a>
									</span>
									
																		<span class="post_online_time" data-online_time="130877" data-desc="在线时长: 36 小时 ( 2 级)&lt;br/&gt; 升级还需要 5 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-31 12:29</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1603037" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603037" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1603037" id="1603037" class="text-grey mr-3"><span class="floor">21</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="787127" name="praised_uid">
		<input type="hidden" value="1603037" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1603037" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603037" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								牛逼								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1603039">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-25325.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/25325.png">
							</a>
							<div class="mt-2">
								<span class="group group-109 mr-1" data-gid="109" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2005-11 <br>
								帖子：615 <br>-->
<!-- 
																<a href="user-25325-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 4</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars03.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-25325.htm">EvilKnight</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-25325-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 4</span>
										</a>
																		<span class="post_online_time" data-online_time="3967440" data-desc="在线时长: 1102 小时 ( 21 级)&lt;br/&gt; 升级还需要 41 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-31 12:52</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1603039" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603039" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1603039" id="1603039" class="text-grey mr-3"><span class="floor">22</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="25325" name="praised_uid">
		<input type="hidden" value="1603039" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1603039" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603039" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								nice，支持，思路不错！								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1603042">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-201434.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/201434.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2008-9 <br>
								帖子：128 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-201434.htm">shuyangzjg</a>
									</span>
									
																		<span class="post_online_time" data-online_time="2424981" data-desc="在线时长: 673 小时 ( 16 级)&lt;br/&gt; 升级还需要 40 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-31 13:58</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1603042" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603042" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1603042" id="1603042" class="text-grey mr-3"><span class="floor">23</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="201434" name="praised_uid">
		<input type="hidden" value="1603042" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1603042" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603042" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								牛逼								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1603064">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-492418.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/avatar.png">
							</a>
							<div class="mt-2">
								<span class="group group-109 mr-1" data-gid="109" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2012-2 <br>
								帖子：100 <br>-->
<!-- 
																<a href="user-492418-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars03.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-492418.htm">coolboyme</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-492418-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 2</span>
										</a>
																		<span class="post_online_time" data-online_time="762632" data-desc="在线时长: 211 小时 ( 8 级)&lt;br/&gt; 升级还需要 22 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-31 15:19</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1603064" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603064" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1603064" id="1603064" class="text-grey mr-3"><span class="floor">24</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="492418" name="praised_uid">
		<input type="hidden" value="1603064" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">1</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1603064" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603064" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								这个bug的产生应该是部门之间的协作出现了问题：PatchGuard&nbsp;不让hook，改检查的地方都检查了，内核数据结构，代码段，做好了放下了。现在ETW要上，要实现功能，还要灵活配置，就留下了这样的接口，然而并没有考虑到是否充当了保护罩让hook通过了PatchGuard&nbsp;检查。或者想到了，没有通知PatchGuard&nbsp;。或者通知了PatchGuard&nbsp;，却无力推动PatchGuard&nbsp;修复。我所在的一个2000人开发的公司都推不动，何况微软呢。								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1603065">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-492418.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/avatar.png">
							</a>
							<div class="mt-2">
								<span class="group group-109 mr-1" data-gid="109" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2012-2 <br>
								帖子：100 <br>-->
<!-- 
																<a href="user-492418-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars03.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-492418.htm">coolboyme</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-492418-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 2</span>
										</a>
																		<span class="post_online_time" data-online_time="762632" data-desc="在线时长: 211 小时 ( 8 级)&lt;br/&gt; 升级还需要 22 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-31 15:24</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1603065" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603065" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1603065" id="1603065" class="text-grey mr-3"><span class="floor">25</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="492418" name="praised_uid">
		<input type="hidden" value="1603065" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">1</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1603065" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603065" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								这也给挖洞提供了一个思路。杀软不让病毒执行却为了管理方便，留了一个后门给自己自动更新等等								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1603091">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-123809.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/123809.png">
							</a>
							<div class="mt-2">
								<span class="group group-104 mr-1" data-gid="104" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2007-9 <br>
								帖子：200 <br>-->
<!-- 
																<a href="user-123809-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 1</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-123809.htm">小艾</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-123809-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 1</span>
										</a>
																		<span class="post_online_time" data-online_time="4387485" data-desc="在线时长: 1218 小时 ( 22 级)&lt;br/&gt; 升级还需要 23 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-7-31 20:51</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1603091" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603091" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1603091" id="1603091" class="text-grey mr-3"><span class="floor">26</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="123809" name="praised_uid">
		<input type="hidden" value="1603091" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1603091" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603091" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								牛批								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1603152">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-38578.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/avatar.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2006-5 <br>
								帖子：345 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-38578.htm">niuzuoquan</a>
									</span>
									
																		<span class="post_online_time" data-online_time="2811141" data-desc="在线时长: 780 小时 ( 17 级)&lt;br/&gt; 升级还需要 11 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-8-1 12:06</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1603152" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603152" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1603152" id="1603152" class="text-grey mr-3"><span class="floor">27</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="38578" name="praised_uid">
		<input type="hidden" value="1603152" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1603152" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603152" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								mark								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1603206">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-175686.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/avatar.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2008-5 <br>
								帖子：57 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-175686.htm">ncsi</a>
									</span>
									
																		<span class="post_online_time" data-online_time="1199353" data-desc="在线时长: 333 小时 ( 11 级)&lt;br/&gt; 升级还需要 50 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-8-1 23:01</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1603206" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603206" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1603206" id="1603206" class="text-grey mr-3"><span class="floor">28</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="175686" name="praised_uid">
		<input type="hidden" value="1603206" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1603206" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603206" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								好文，学习！								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1603261">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-66187.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/avatar.png">
							</a>
							<div class="mt-2">
								<span class="group group-104 mr-1" data-gid="104" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2006-12 <br>
								帖子：322 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-66187.htm">ugvjewxf</a>
									</span>
									
																		<span class="post_online_time" data-online_time="3743154" data-desc="在线时长: 1039 小时 ( 20 级)&lt;br/&gt; 升级还需要 10 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-8-2 14:40</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1603261" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603261" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1603261" id="1603261" class="text-grey mr-3"><span class="floor">29</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="66187" name="praised_uid">
		<input type="hidden" value="1603261" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1603261" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603261" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								好东西，还能这么操作，								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1603281">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-686347.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/686347.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2015-7 <br>
								帖子：7 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-686347.htm">柒小苦瓜</a>
									</span>
									
																		<span class="post_online_time" data-online_time="111637" data-desc="在线时长: 31 小时 ( 2 级)&lt;br/&gt; 升级还需要 10 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-8-2 16:33</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1603281" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603281" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1603281" id="1603281" class="text-grey mr-3"><span class="floor">30</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="686347" name="praised_uid">
		<input type="hidden" value="1603281" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1603281" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603281" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								mark<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/81.gif" class="face" style="cursor: pointer;">								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1603498">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-592310.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310.png">
							</a>
							<div class="mt-2">
								<span class="group group-104 mr-1" data-gid="104" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2013-7 <br>
								帖子：181 <br>-->
<!-- 
																<a href="user-592310-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 1</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-592310.htm">Sprite雪碧</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-592310-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 1</span>
										</a>
																		<span class="post_online_time" data-online_time="1771901" data-desc="在线时长: 492 小时 ( 13 级)&lt;br/&gt; 升级还需要 11 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-8-4 14:46</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1603498" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603498" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1603498" id="1603498" class="text-grey mr-3"><span class="floor">31</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="592310" name="praised_uid">
		<input type="hidden" value="1603498" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1603498" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603498" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_8ZSQG5K2X7KNGZ8.jpg" style="width: 281px; height: 500px; cursor: pointer;" class="div_message_boxShadow"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310_QQNR642FJT3DVD8.jpg" style="width: 506px; height: 500px; cursor: pointer;" class="div_message_boxShadow"><div>
<div><br></div><div>
山某人又来做秀了</div>
</div>
								
		<div class="text-right text-muted my-3 small font-italic">
		最后于 <span class="icon-clock-o ml-2"> </span>2019-8-5 12:38		
				被Sprite雪碧编辑
				
		，原因： 		
	</div>
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1603707">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-772667.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/avatar.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2017-11 <br>
								帖子：9 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-772667.htm">5ilent</a>
									</span>
									
																		<span class="post_online_time" data-online_time="88404" data-desc="在线时长: 24 小时 ( 2 级)&lt;br/&gt; 升级还需要 17 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-8-5 21:31</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1603707" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603707" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1603707" id="1603707" class="text-grey mr-3"><span class="floor">32</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="772667" name="praised_uid">
		<input type="hidden" value="1603707" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1603707" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603707" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								感谢分享，不久就要被补了，								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1603890">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-420321.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/avatar.png">
							</a>
							<div class="mt-2">
								<span class="group group-103 mr-1" data-gid="103" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2011-4 <br>
								帖子：169 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars02.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-420321.htm">appview</a>
									</span>
									
																		<span class="post_online_time" data-online_time="1978319" data-desc="在线时长: 549 小时 ( 14 级)&lt;br/&gt; 升级还需要 20 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-8-6 19:09</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1603890" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603890" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1603890" id="1603890" class="text-grey mr-3"><span class="floor">33</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="420321" name="praised_uid">
		<input type="hidden" value="1603890" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1603890" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603890" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								牛逼了<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/63.gif" class="face" style="cursor: pointer;">								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1603925">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-592310.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/592310.png">
							</a>
							<div class="mt-2">
								<span class="group group-104 mr-1" data-gid="104" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2013-7 <br>
								帖子：181 <br>-->
<!-- 
																<a href="user-592310-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 1</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-592310.htm">Sprite雪碧</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-592310-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 1</span>
										</a>
																		<span class="post_online_time" data-online_time="1771901" data-desc="在线时长: 492 小时 ( 13 级)&lt;br/&gt; 升级还需要 11 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-8-7 01:10</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1603925" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603925" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1603925" id="1603925" class="text-grey mr-3"><span class="floor">34</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="592310" name="praised_uid">
		<input type="hidden" value="1603925" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1603925" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603925" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								<blockquote class="blockquote">
		<a href="https://bbs.pediy.com/user-453009.htm" class="text-small text-muted user">
			<img class="avatar-1" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/453009.png" style="cursor: pointer;">
			malokch
		</a>
		类似的技术我已经用很久了，终于有人发出来了。这套技术还可以用于注入代码到进程运行。
		</blockquote>坐等大佬分享&nbsp;嘻嘻<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/86.gif" class="face" style="cursor: pointer;">								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1603928">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-749995.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/749995.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2017-4 <br>
								帖子：92 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-749995.htm">木志本柯</a>
									</span>
									
																		<span class="post_online_time" data-online_time="1030180" data-desc="在线时长: 286 小时 ( 10 级)&lt;br/&gt; 升级还需要 43 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-8-7 03:37</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1603928" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603928" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1603928" id="1603928" class="text-grey mr-3"><span class="floor">35</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="749995" name="praised_uid">
		<input type="hidden" value="1603928" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1603928" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1603928" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								骚操作。。。。。。。。。。								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1607112">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-780645.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/780645.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2018-1 <br>
								帖子：26 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-780645.htm">X-Blades</a>
									</span>
									
																		<span class="post_online_time" data-online_time="1546776" data-desc="在线时长: 429 小时 ( 12 级)&lt;br/&gt; 升级还需要 12 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-9-3 19:54</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1607112" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1607112" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1607112" id="1607112" class="text-grey mr-3"><span class="floor">36</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="780645" name="praised_uid">
		<input type="hidden" value="1607112" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1607112" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1607112" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								牛皮								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1607226">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-179724.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/avatar.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2008-5 <br>
								帖子：16 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-179724.htm">cralsen</a>
									</span>
									
																		<span class="post_online_time" data-online_time="303255" data-desc="在线时长: 84 小时 ( 4 级)&lt;br/&gt; 升级还需要 5 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-9-4 18:46</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1607226" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1607226" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1607226" id="1607226" class="text-grey mr-3"><span class="floor">37</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="179724" name="praised_uid">
		<input type="hidden" value="1607226" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1607226" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1607226" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								<blockquote class="blockquote">
		<a href="https://bbs.pediy.com/user-453009.htm" class="text-small text-muted user">
			<img class="avatar-1" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/453009.png" style="cursor: pointer;">
			malokch
		</a>
		类似的技术我已经用很久了，终于有人发出来了。这套技术还可以用于注入代码到进程运行。
		</blockquote>如何做到呢？能否提示一二								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1611255">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-868110.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/avatar.png">
							</a>
							<div class="mt-2">
								<span class="group group-101 mr-1" data-gid="101" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2019-9 <br>
								帖子：7 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-868110.htm">mb_ddciclgc</a>
									</span>
									
																		<span class="post_online_time" data-online_time="19984" data-desc="在线时长: 5 小时 ( 0 级)&lt;br/&gt; 升级还需要 4 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star_0.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-9-26 13:07</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1611255" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1611255" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1611255" id="1611255" class="text-grey mr-3"><span class="floor">38</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="868110" name="praised_uid">
		<input type="hidden" value="1611255" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">1</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1611255" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1611255" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								都说前人栽树，后人乘凉。现在是前人栽树，乘完凉后把树砍了，后人只能对着树桩发呆。								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1613336">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-620086.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/620086.png">
							</a>
							<div class="mt-2">
								<span class="group group-108 mr-1" data-gid="108" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2014-2 <br>
								帖子：310 <br>-->
<!-- 
																<a href="user-620086-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars02.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-620086.htm">killpy</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-620086-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 2</span>
										</a>
																		<span class="post_online_time" data-online_time="3043802" data-desc="在线时长: 845 小时 ( 18 级)&lt;br/&gt; 升级还需要 28 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-10-7 17:50</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1613336" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1613336" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1613336" id="1613336" class="text-grey mr-3"><span class="floor">39</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="620086" name="praised_uid">
		<input type="hidden" value="1613336" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1613336" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1613336" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								<blockquote class="blockquote">
		<a href="https://bbs.pediy.com/user-868110.htm" class="text-small text-muted user">
			<img class="avatar-1" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/avatar.png" style="cursor: pointer;">
			mb_ddciclgc
		</a>
		都说前人栽树，后人乘凉。现在是前人栽树，乘完凉后把树砍了，后人只能对着树桩发呆。
		</blockquote>现在是&nbsp;栽树的人&nbsp;统一被物业公司管理&nbsp;能进入小区住的&nbsp;可以乘凉&nbsp;否则你连看都看不到								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1613340">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-620086.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/620086.png">
							</a>
							<div class="mt-2">
								<span class="group group-108 mr-1" data-gid="108" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2014-2 <br>
								帖子：310 <br>-->
<!-- 
																<a href="user-620086-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 2</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars02.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-620086.htm">killpy</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-620086-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 2</span>
										</a>
																		<span class="post_online_time" data-online_time="3043802" data-desc="在线时长: 845 小时 ( 18 级)&lt;br/&gt; 升级还需要 28 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-10-7 18:53</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1613340" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1613340" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1613340" id="1613340" class="text-grey mr-3"><span class="floor">40</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="620086" name="praised_uid">
		<input type="hidden" value="1613340" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1613340" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1613340" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								<blockquote class="blockquote">
		<a href="https://bbs.pediy.com/user-868110.htm" class="text-small text-muted user">
			<img class="avatar-1" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/avatar.png" style="cursor: pointer;">
			mb_ddciclgc
		</a>
		都说前人栽树，后人乘凉。现在是前人栽树，乘完凉后把树砍了，后人只能对着树桩发呆。
		</blockquote>我就想知道&nbsp;如何一劳永逸&nbsp;禁止&nbsp;ETW								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1614112">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-283934.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/283934.png">
							</a>
							<div class="mt-2">
								<span class="group group-4 mr-1" data-gid="4" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2009-9 <br>
								帖子：678 <br>-->
<!-- 
																<a href="user-283934-1-1.htm" style="text-decoration: none;">
									<span class="icon-diamond text-danger" title="精华数"></span><span class="font-weight-bold text-danger"> 8</span>
								</a>
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars04.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-283934.htm">莫灰灰</a>
									</span>
									
																			<a href="https://bbs.pediy.com/user-283934-1-1.htm" class="d-inline-block" style="text-decoration: none; transform:scale(.8); -ms-transform:scale(.8); -webkit-transform:scale(.8);">
											<span class="icon-diamond text-danger" title="精华数"></span>
											<span class="font-weight-bold text-danger"> 8</span>
										</a>
																		<span class="post_online_time" data-online_time="5192580" data-desc="在线时长: 1442 小时 ( 24 级)&lt;br/&gt; 升级还需要 7 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/sun.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-10-11 19:06</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1614112" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1614112" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1614112" id="1614112" class="text-grey mr-3"><span class="floor">41</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="283934" name="praised_uid">
		<input type="hidden" value="1614112" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1614112" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1614112" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								好详细，学习了~								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1614797">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-851111.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/avatar.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2019-4 <br>
								帖子：17 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-851111.htm">xuanzee</a>
									</span>
									
																		<span class="post_online_time" data-online_time="588246" data-desc="在线时长: 163 小时 ( 7 级)&lt;br/&gt; 升级还需要 28 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/star.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-10-15 22:32</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1614797" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1614797" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1614797" id="1614797" class="text-grey mr-3"><span class="floor">42</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="851111" name="praised_uid">
		<input type="hidden" value="1614797" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1614797" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1614797" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								学习了！								
																																
								
							</div>
						</td>
					</tr>
																			
										
										
					<tr class="post" data-pid="1617240">
						<td class="vtop td-avatar text-center" style="width: 46px;">
							<a href="https://bbs.pediy.com/user-620278.htm" tabindex="-1">
								<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/620278.png">
							</a>
							<div class="mt-2">
								<span class="group group-102 mr-1" data-gid="102" onmouseenter="show_level(event)"></span>
							</div>
							<div class="text-grey text-tiny" style="height: 20px; text-align: center; margin-top: -9px; ">
								
								<!--注册：2014-2 <br>
								帖子：44 <br>-->
<!-- 
								 -->
								<div class="mb-3" style="position: relative;"><img style="position:absolute;left: -3px;" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/stars01.gif" alt=""> </div>
								<!--<span class="hidden-sm hidden-md" title=""></span>
								-->

							</div>
							
							
						</td>
						<td class="px-0">
							<dl class="row small">
								<dt>
									
									
									<div>
									<span class="username font-weight-bold">
										<a href="https://bbs.pediy.com/user-620278.htm">淡然他徒弟</a>
									</span>
									
																		<span class="post_online_time" data-online_time="770811" data-desc="在线时长: 214 小时 ( 8 级)&lt;br/&gt; 升级还需要 19 小时" onmouseenter="show_online_level(event)"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/moon.gif" width="13" height="13" style="opacity: 0.65; margin-right: 2px;"></span>
									<span class="date text-grey small ml-1">2019-11-1 18:55</span>
									</div>
									
								</dt>
								<dd class="text-right text-grey py-1">
									<div class="check_input_box d-inline-block"></div>
									<div class=" d-none d-lg-inline-block">
																													
																				<a href="javascript:void(0)" tid="253450" pid="1617240" class="text-grey post_reply mr-3"><i class="icon-reply"></i> 引用</a>
																				
										

																			
										

	

																				
										<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1617240" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
									</div>
																		<a href="https://bbs.pediy.com/thread-253450-1.htm#1617240" id="1617240" class="text-grey mr-3"><span class="floor">43</span> 楼</a>
																			<div class="reply_thumb" style="display: inline-block;">
		<input type="hidden" value="253450" name="threadid">
		<input type="hidden" value="620278" name="praised_uid">
		<input type="hidden" value="1617240" name="pid">
		<a href="javascript:void(0)" class="text-grey">
						<i class="icon-thumbs-o-up"></i>
					</a>
		<span class="thumb_num" style="margin-left:5px">0</span>
	</div>
									<style>
										.mobile_more_operate_btn {
											padding: 0px 4px; 
											background: #dee5ea; 
											border-radius: 0.2rem; 
											cursor: pointer;
										}
										.mobile_more_operate {
											display: none; 
											left: -195px; 
											top: -13px; 
											width: 185px; 
											background: #222222; 
											border-radius: 0.3rem;
										}
										.mobile_more_operate_box .post_report {
											color: #fff!important;
										}
									</style>
																		<div class="mobile_more_operate_box position-relative ml-2 d-inline-block d-lg-none">
										<span class="mobile_more_operate_btn" onclick="mobile_more_operate(event);">•••</span>
										<div class="mobile_more_operate position-absolute samll px-2 py-3 text-center " style="display: none;">
											<span style="display:block; width:0; height:0; border-width: 7px 0 7px 7px; border-style:solid;position:absolute; top: 15px; right: -7px;
											border-color:transparent transparent transparent #222222; "></span>
											<div>
																																													<a href="javascript:void(0)" tid="253450" pid="1617240" class="text-white post_reply mr-3 samll"><i class="icon-reply"></i> 引用</a>
																								
												
			
																							
												

	
			
																								
												<a id="exampleModalLabel report" data-toggle="modal" data-target="#report" data-tid="253450" data-pid="1617240" data-confirm-text="举报帖子" href="javascript:void(0);" class="text-grey post_report _confirm mr-3"><i class="icon-warning"></i> 举报</a>
											</div>
											
											
										</div>
									</div>
										
								</dd>
							</dl>
							<!-- <div></div> -->
							<div class="message mt-1 break-all">
																								mark								
																																
								
							</div>
						</td>
					</tr>
								
										
												<tr class="post">
							<td class="td-avatar" aria-hidden="true">
								<a href="https://bbs.pediy.com/user-843586.htm" aria-hidden="true" tabindex="-1">
									<img class="avatar-3" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/avatar.png">
								</a>
							</td>
							<td class="p-l-0">
								<form action="https://bbs.pediy.com/post-create-253450-1.htm" method="post" id="quick_reply_form">	
									<input type="hidden" name="doctype" value="1">
									<input type="hidden" name="return_html" value="1">
									<input type="hidden" name="quotepid" value="0">
									<dl class="row small text-muted">
										<dt class="username">J坚持CWF</dt>
										<dd class="text-right text-grey"></dd>
									</dl>
									<div class="message mt-1">
										<fieldset class="form-group mb-0">
											<textarea class="form-control" placeholder="内容" name="message" id="message"></textarea>
										</fieldset>
									</div>
									<div class="text-muted  mt-2 small face_open">
										<dl class="row">
											<dt>
												
												<button type="submit" class="btn btn-sm btn-primary" id="submit" data-loading-text="正在提交...">　回帖　</button>
												
												<span class="emotion ml-3">表情</span>
												<span class="ml-3 d-none d-lg-inline-block"><a href="https://bbs.pediy.com/thread-247709.htm" target="_bank" style="color: #0099ee;">雪币赚取及消费</a></span>
											</dt>
											<dd class="text-right vtop">
												
												<a class="icon-mail-forward text-muted senior_reply" href="javascript:void(0);" id="advanced_reply"> 高级回复</a>
												
											</dd>
										</dl>
									</div>
								</form>
							</td>
						</tr>
											</tbody>
				</table>
			</div>
		</div>
		
		
				
		
		
				
				
		<a role="button" class="btn btn-secondary btn-block xn-back my-3 mx-auto" style="max-width: 50%;" href="javascript:history.back();">返回</a>
		
		<br>
		<br>
		

		<div class="container">
	<div class="row mx-0 bbs_footer_at_column mt-3 mb-3 hidden-sm hidden-md" style="text-align: center; height: 76px;">
		<div class="col-md-6 px-0" style="height: 100%;">
			<a href="https://bbs.pediy.com/thread-255033.htm" style="height: 100%;" target="_blank">
				<p></p>
				<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/kx20.png" width="100%" height="100%">

			</a>
		</div>
		<div class="col-md-6 px-0" style="height: 100%;">
			<a href="https://job.kanxue.com/" style="height: 100%;" target="_blank">
			<p></p>
			<img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/kxright.jpg" width="100%" height="100%">
		</a>
		</div>
	</div>
	</div>
		</div>

	</main>

	
	<footer id="footer" style="background: #3b4348; color: #9ba4aa; height: auto;">
		<div class="container">
			<div class="row text-muted small my-3 mx-0" id="web_base_company_information">
				<div class="col-md-6">
					©2000-2019 看雪学院 | Based on <a href="http://bbs.xiuno.com/" target="_blank" class="text-muted">Xiuno BBS</a> <br>
					域名：<a href="https://www.yunaq.com/" target="_blank" class="text-muted">加速乐</a> | 
					SSL证书：<a href="https://www.trustasia.com/trustasia" target="_blank" class="text-muted">亚洲诚信</a> | 
					<a href="http://dun.163.com/?from=kanxue_DDoS_2018&amp;hmsr=kanxue%C2%A0" target="_blank" class="text-muted">安全网易云易盾</a>| 
					<a href="https://x.tongdun.cn/" target="_blank" class="text-muted">同盾反欺诈</a>
					
				</div>
				<div class="col-md-6 text-right d-none d-md-block">
					<span class="hidden-sm">公众号：ikanxue</span> | 
					<a class="text-muted" href="https://zhuanlan.kanxue.com/article-56.htm">关于我们</a> | 
					<a class="text-muted" href="https://www.kanxue.com/user-online_sendmsg.htm">联系我们</a> | 
					<a href="https://zhuanlan.kanxue.com/article-1.htm" class="text-muted">企业服务</a> <br>
					Processed: <b>0.062</b>s, SQL: <b>99</b> / 京ICP备10040895号-17
				</div>
			</div>
			<div style="max-height: 100px; overflow-y:auto;">
							</div>
		</div>
	</footer>
	


	<!--[if lt IE 9]>
	<script>window.location = 'browser.htm';</script>
	<![endif]-->


	

	<div class="act_go_top" style="position: fixed; bottom: 80px; right: 10px; width: 70px; height: 70px; display: none;">
	<a href="javascript:void(0);" style="width: 70px; height: 70px; display: inline-block;background: url(/view/img/scroll_top.png) no-repeat; _background: url(/view/img/scroll_top.png) no-repeat; outline: none;" title="返回顶部"></a>
	</div>




<script src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/bbs.js.下载"></script>
<script src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/jquery-3.1.0.js.下载"></script>
<script src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/popper.js.下载"></script>
<script src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/bootstrap.js.下载"></script>
<script src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/xiuno.js.下载"></script>
<script src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/storagePlus.js.下载"></script>
<script src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/bootstrap-plugin.js.下载"></script><script language="javascript" src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/layer.js.下载"></script>
<script src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/async.js.下载"></script>
<script src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/form.js.下载"></script>

<script>
// 用于个人中心 判断路由 center ，还是 pm
var sele_route = 'thread';
var sele_action = '253450';

var debug = DEBUG = 0;
var url_rewrite_on = 1;
var forumarr = {
    "4": "『软件逆向』",
    "52": "OllyDbg插件收集区",
    "69": "『经典问答』",
    "122": "CTF2019提交区(隐藏版块)",
    "102": "『科锐培训』",
    "141": "CrackMe存档区",
    "152": "学习园地",
    "2": "『论坛版务』",
    "53": "IDA Pro插件收集区",
    "76": "1)珠海金山2007逆向分析挑战",
    "99": "《加密与解密(第4版)》",
    "169": "『15PB培训』",
    "125": "奇虎360软件安全大赛答案提交区",
    "128": "『智能设备』",
    "21": "《软件加密技术内幕》",
    "68": "2)PEDIY Crackme竞",
    "41": "『编程技术』",
    "79": "前沿科技",
    "78": "『申请提交区』",
    "95": "《0day:软件漏洞分析技术》",
    "160": "『麦洛科菲培训』",
    "161": "『Android安全』",
    "166": "『iOS安全』",
    "88": "『加壳脱壳』",
    "91": "3)看雪论坛2008 Explo",
    "158": "移动平台",
    "3": "桌面平台",
    "120": "4)腾讯公司2008软件安全竞赛",
    "132": "『密码算法』",
    "123": "《微软.NET程序的加密与解密》",
    "127": "5)奇虎360软件安全比赛",
    "37": "『CrackMe』",
    "140": "6)PEDIY Crackme竞",
    "108": "企业建设",
    "65": "『图书项目』",
    "150": "『二进制漏洞』",
    "163": "《C++反汇编与逆向分析技术》",
    "116": "看雪CTF",
    "155": "8)腾讯公司2010软件安全竞赛",
    "168": "《Android安全与逆向分析》",
    "157": "9)2011 Exploit M",
    "121": "11）移动安全挑战赛（MSC）",
    "129": "12）2015第2届移动安全挑战",
    "136": "职场生活",
    "47": "『招聘专区』",
    "1": "站务管理/产品",
    "97": "『求助问答』",
    "137": "『职业生涯』",
    "171": "『Pwn』",
    "45": "『茶余饭后』",
    "162": "『业务安全』",
    "10": "『资源下载』",
    "20": "『¥付费问答』",
    "32": "『外文翻译』",
    "151": "『WEB安全』",
    "172": "『区块链安全』",
    "173": "看雪安全接入"
};
var fid = 41;
var uid = 843586;
var gid = 101;
$('[data-toggle="tooltip"]').tooltip();
$('#search_form > input').on('click', function() {
	return false;
});
</script>

<script src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/bbs.js(1).下载"></script>

<script>
// 版主管理：精华
$('.mod-button button.digest').on('click', function() {
	var modtid = $('input[name="modtid"]').checked();
	if(modtid.length == 0) return $.alert(lang.please_choose_thread);
	var radios = xn.form_radio('digest', {"0": "取消精华", "1": "关注","2": "优秀", "3": "精华"});
	$.confirm("设置主题为精华", function() {
		var tids = xn.implode('_', modtid);
		var digest = $('input[name="digest"]').checked();
		var postdata = {digest: digest};
		$.xpost(xn.url('mod-digest-'+tids), postdata, function(code, message) {
			if(code != 0) return $.alert(message);
			$.alert(message).delay(1000).location('');
		});
	}, {'body': '<p>'+"精华等级"+'：'+radios+'</p>'});
})
</script><script>
function xn_read_unread(tids, tid) {
	
	// 当前时间
	var time = xn.time();
	
	// 多长时间内的主题为最新主题
	var time_range = 86400 * 3;
	
	// 三天内的 tids
	var recent_tids = $.pdata('recent_tids') || {};
	
	// 已读的 tids
	var view_tids = $.pdata('view_tids') || {};
	// 提取列表页的 tid
	function fetch_recent_tids(tids) {
		var changed = false;
		$.each(tids, function(tid, last_date) {
			if(time - last_date < time_range) {
				recent_tids[tid] = last_date;
				changed = true;
			}
		});
		if(changed) $.pdata('recent_tids', recent_tids);
	}
	
	// 清理最近的 tid
	function gc_recent_tids() {
		var changed = false;
		$.each(recent_tids, function(tid, last_date) {
			if(time - last_date > time_range) {
				delete recent_tids[tid];
				changed = true;
			}
		});
		if(changed) $.pdata('recent_tids', recent_tids);
	}
	
	function gc_view_tids() {
		var changed = false;
		$.each(view_tids, function(tid, last_date) {
			if(!recent_tids[tid]) {
				delete view_tids[tid];
				changed = true;
			}
		});
		if(changed) $.pdata('view_tids', view_tids);
	}
	
	function save_view_tid(tid) {
		if(!recent_tids[tid]) return;
		view_tids[tid] = time;
		$.pdata('view_tids', view_tids);
	}
	
	if(tids) {
		fetch_recent_tids(tids);
		gc_recent_tids();
		//gc_view_tids();
	}
	if(tid) save_view_tid(tid);
	
	// 三天内的主题标记为已读
	
	// 遍历主题列表，标记最近的，并且未读的为加粗

	$('.thread').each(function() {
		var jthis = $(this);
		var tid = jthis.attr('tid') || jthis.data('tid');
		if(recent_tids[tid] && recent_tids[tid] > xn.intval(view_tids[tid])) {
			//jthis.find('div.subject').addClass('font-weight-bold');
			jthis.find('div.subject').append('<span class="icon-new"></span>');
			jthis.find('span.icon-post-grey').removeClass('icon-post-grey').addClass('icon-post-blue');
		}
	});
}

</script>

<script type="text/javascript">
$(function() {
	setTimeout(function() {
		$.require('https://www.google-analytics.com/ga.js', function() {
			try {
				var pageTracker = _gat._getTracker("UA-9784446-1");
				pageTracker._trackPageview();
			} catch (err) {}
		});
	}, 1000);

	setTimeout(function() {
		$(".bbs_home_page_three_col .small_logo").each(function(index, element) {

			if ($(element).children("a").length == 0) {
				$(".bbs_home_page_three_col .bbs_home_page_row_div").eq(index).children('div:first-child').removeClass("col-lg-8").addClass("col-lg-9");
				$(".bbs_home_page_three_col .bbs_home_page_row_div").eq(index).children('div:last-child').removeClass("col-lg-4").addClass("col-lg-3");
				$(".bbs_home_page_three_col .bbs_home_page_row_div").eq(index).children('div:first-child').children("span").css("width", "19rem");
			}
		})
	}, 2000);


	if (self != top) {
		$('#header').hide();
		$('#nav2').hide();
		$('#footer').hide();
	}


	 // 导航
    var new_p = 0, start_scrollTop = 0;
        $(window).scroll(function(e){  
                new_p = $(this).scrollTop();  
                  
                if(start_scrollTop < new_p) {//下滚  
                    $('.header_fiexd').css("display","none");
                } else {//上滚  
                    $('.header_fiexd').css("display","block");
                }  
                setTimeout(function(){start_scrollTop = new_p;},0);         
        });

	
	// 返回顶部
	$(window).scroll(function() {
		if ($(window).scrollTop() >= 500) {
			$('.act_go_top').fadeIn(300);
		} else {
			$('.act_go_top').fadeOut(300);
		}
	});

	$('.act_go_top').click(function() {
		$('html,body').animate({
			scrollTop: '0px'
		}, 100);
	});
	var m1 = 0;     // 滚动的值
	var m2 = 0;     // 对比时间的值
	var timer = null;
	document.onscroll = function() {
		clearTimeout(timer) // 每次滚动前 清除一次
		timer = setTimeout(Data, 2000);
		m1 = document.documentElement.scrollTop || document.body.scrollTop;

	}
	function Data() {
		m2 = document.documentElement.scrollTop || document.body.scrollTop;
		if(m2 == m1){
		    $('.act_go_top').fadeOut(300);
		}
	}
	// 3600000
	var d = new Date();
	var session_interval = d.getTime() - $.pdata('top-banner-session');
	
	if (session_interval > 3600000) {
		$.pdata('top-banner', 0);
	}
	if ($.pdata('top-banner') == 1) {
		$(".top-banner").hide();
	} else {
		$(".top-banner").slideDown();
	}
	$(".top-banner-section .closeBanner").on("click", function(){
		
		$.pdata('top-banner', 1);
		$.pdata('top-banner-session', d.getTime());
		$(".top-banner").animate({height:'0'})
	})
	
});


</script>

<script>
(function() {
	var islogin = '843586';
	if(islogin == 0)  return; 
	var pm_number = "//www.kanxue.com/pm-new.htm";
	$.xget(pm_number, function(code, message) {
		var pm_number = $(".pm_number");
		var sysm_number = $(".system_message_number");
		if (code == 0) {
			var newpms = parseInt(message.newpms);
			var system_pms = parseInt(message.system_pms);
			var pm_total = newpms + system_pms;
			if (pm_total != 0) {
				pm_total = pm_total > 99 ? "99+" : pm_total;
				$(".pm_total").html(pm_total);
				// $(".pm_total").css({
				// 	"display": "inline-block",
				// 	"padding": "0px 7px",
				// 	"font-size": "12px",
				// 	"line-height": "20px",
				// 	"color": "white",
				// 	"background-color": "#f57e42",
				// 	"border-radius": "9px",
				// 	"text-indent": "0px"
				// });

				if (system_pms > 0 && newpms == 0) {
					var href = "//www.kanxue.com/pm-system_read-1.htm";
					$(".pm_total_a").attr("href", href);
				}

			} else {
				// $(".pm_total_a").css("display","none");
			};
			if (message.newpms != 0) {
				pm_number.html(message.newpms);
				pm_number.addClass("pmmessage_number");
			} else {
				pm_number.css("display", "none");
			};
			if (message.system_pms != 0) {
				sysm_number.html(message.system_pms);
				sysm_number.addClass("pmmessage_number");
			} else {
				sysm_number.css("display", "none");
			};
			if (message.newpms != 0) {
				pm_number.html(message.newpms);
				pm_number.addClass("pm_numbers_");
			} else {
				pm_number.css("display", "none");
			};
			if (message.system_pms != 0) {
				sysm_number.html(message.system_pms);
				sysm_number.addClass("pm_numbers_");
			} else {
				sysm_number.css("display", "none");
			};


		} else {
			
			pm_number.css("display", "none");
			sysm_number.css("display", "none");

		}
	})


})(jQuery);
</script>
<script>
	//统计在线

	(function() {

		var uid = '843586';
		var current_time = '1573731469';
		
		var last_time;
		if(uid > 0) {
			//10分钟以内不请求。
			last_time = storagePlus.get('last_active_time_'+uid) || 0;
			//大于5分钟请求接口。
			if((current_time - last_time)/60 > 5) {
				$.xpost('user-online_sumtime.htm',{}, function(code, msg) {
					if(code == 0) {
						storagePlus.set('last_active_time_'+uid, msg);
					} else {
						console.info('msg');
					}
				});
			}
		}



	})();

	


</script>
<script>

var forumlist = [
    {
        "fid": "4",
        "fup": "3",
        "name": "『软件逆向』",
        "rank": "29"
    },
    {
        "fid": "29",
        "fup": "2",
        "name": "『论坛管理团队』",
        "rank": "29"
    },
    {
        "fid": "52",
        "fup": "10",
        "name": "OllyDbg插件收集区",
        "rank": "29"
    },
    {
        "fid": "69",
        "fup": "20",
        "name": "『经典问答』",
        "rank": "29"
    },
    {
        "fid": "122",
        "fup": "37",
        "name": "CTF2019提交区(隐藏版块)",
        "rank": "29"
    },
    {
        "fid": "102",
        "fup": "137",
        "name": "『科锐培训』",
        "rank": "29"
    },
    {
        "fid": "141",
        "fup": "140",
        "name": "CrackMe存档区",
        "rank": "29"
    },
    {
        "fid": "152",
        "fup": "0",
        "name": "学习园地",
        "rank": "29"
    },
    {
        "fid": "2",
        "fup": "1",
        "name": "『论坛版务』",
        "rank": "28"
    },
    {
        "fid": "53",
        "fup": "10",
        "name": "IDA Pro插件收集区",
        "rank": "28"
    },
    {
        "fid": "76",
        "fup": "37",
        "name": "1)珠海金山2007逆向分析挑战",
        "rank": "28"
    },
    {
        "fid": "99",
        "fup": "65",
        "name": "《加密与解密(第4版)》",
        "rank": "28"
    },
    {
        "fid": "169",
        "fup": "137",
        "name": "『15PB培训』",
        "rank": "28"
    },
    {
        "fid": "125",
        "fup": "127",
        "name": "奇虎360软件安全大赛答案提交区",
        "rank": "28"
    },
    {
        "fid": "128",
        "fup": "79",
        "name": "『智能设备』",
        "rank": "27"
    },
    {
        "fid": "21",
        "fup": "57",
        "name": "《软件加密技术内幕》",
        "rank": "27"
    },
    {
        "fid": "68",
        "fup": "37",
        "name": "2)PEDIY Crackme竞",
        "rank": "27"
    },
    {
        "fid": "41",
        "fup": "3",
        "name": "『编程技术』",
        "rank": "27"
    },
    {
        "fid": "79",
        "fup": "0",
        "name": "前沿科技",
        "rank": "27"
    },
    {
        "fid": "78",
        "fup": "2",
        "name": "『申请提交区』",
        "rank": "27"
    },
    {
        "fid": "95",
        "fup": "65",
        "name": "《0day:软件漏洞分析技术》",
        "rank": "27"
    },
    {
        "fid": "160",
        "fup": "137",
        "name": "『麦洛科菲培训』",
        "rank": "27"
    },
    {
        "fid": "161",
        "fup": "158",
        "name": "『Android安全』",
        "rank": "27"
    },
    {
        "fid": "166",
        "fup": "158",
        "name": "『iOS安全』",
        "rank": "27"
    },
    {
        "fid": "88",
        "fup": "3",
        "name": "『加壳脱壳』",
        "rank": "26"
    },
    {
        "fid": "91",
        "fup": "37",
        "name": "3)看雪论坛2008 Explo",
        "rank": "26"
    },
    {
        "fid": "158",
        "fup": "0",
        "name": "移动平台",
        "rank": "26"
    },
    {
        "fid": "3",
        "fup": "0",
        "name": "桌面平台",
        "rank": "25"
    },
    {
        "fid": "120",
        "fup": "37",
        "name": "4)腾讯公司2008软件安全竞赛",
        "rank": "25"
    },
    {
        "fid": "57",
        "fup": "2",
        "name": "『回收站』",
        "rank": "25"
    },
    {
        "fid": "132",
        "fup": "3",
        "name": "『密码算法』",
        "rank": "24"
    },
    {
        "fid": "123",
        "fup": "57",
        "name": "《微软.NET程序的加密与解密》",
        "rank": "24"
    },
    {
        "fid": "127",
        "fup": "37",
        "name": "5)奇虎360软件安全比赛",
        "rank": "24"
    },
    {
        "fid": "37",
        "fup": "116",
        "name": "『CrackMe』",
        "rank": "23"
    },
    {
        "fid": "140",
        "fup": "37",
        "name": "6)PEDIY Crackme竞",
        "rank": "23"
    },
    {
        "fid": "108",
        "fup": "0",
        "name": "企业建设",
        "rank": "22"
    },
    {
        "fid": "65",
        "fup": "1",
        "name": "『图书项目』",
        "rank": "22"
    },
    {
        "fid": "150",
        "fup": "3",
        "name": "『二进制漏洞』",
        "rank": "22"
    },
    {
        "fid": "163",
        "fup": "65",
        "name": "《C++反汇编与逆向分析技术》",
        "rank": "22"
    },
    {
        "fid": "116",
        "fup": "0",
        "name": "看雪CTF",
        "rank": "21"
    },
    {
        "fid": "155",
        "fup": "37",
        "name": "8)腾讯公司2010软件安全竞赛",
        "rank": "21"
    },
    {
        "fid": "168",
        "fup": "65",
        "name": "《Android安全与逆向分析》",
        "rank": "21"
    },
    {
        "fid": "157",
        "fup": "37",
        "name": "9)2011 Exploit M",
        "rank": "20"
    },
    {
        "fid": "121",
        "fup": "37",
        "name": "11）移动安全挑战赛（MSC）",
        "rank": "18"
    },
    {
        "fid": "129",
        "fup": "37",
        "name": "12）2015第2届移动安全挑战",
        "rank": "17"
    },
    {
        "fid": "136",
        "fup": "0",
        "name": "职场生活",
        "rank": "12"
    },
    {
        "fid": "47",
        "fup": "136",
        "name": "『招聘专区』",
        "rank": "4"
    },
    {
        "fid": "1",
        "fup": "0",
        "name": "站务管理/产品",
        "rank": "3"
    },
    {
        "fid": "97",
        "fup": "152",
        "name": "『求助问答』",
        "rank": "3"
    },
    {
        "fid": "137",
        "fup": "136",
        "name": "『职业生涯』",
        "rank": "3"
    },
    {
        "fid": "171",
        "fup": "116",
        "name": "『Pwn』",
        "rank": "2"
    },
    {
        "fid": "45",
        "fup": "136",
        "name": "『茶余饭后』",
        "rank": "2"
    },
    {
        "fid": "162",
        "fup": "108",
        "name": "『业务安全』",
        "rank": "2"
    },
    {
        "fid": "170",
        "fup": "57",
        "name": "看雪产品",
        "rank": "2"
    },
    {
        "fid": "10",
        "fup": "152",
        "name": "『资源下载』",
        "rank": "1"
    },
    {
        "fid": "20",
        "fup": "97",
        "name": "『¥付费问答』",
        "rank": "1"
    },
    {
        "fid": "32",
        "fup": "3",
        "name": "『外文翻译』",
        "rank": "1"
    },
    {
        "fid": "64",
        "fup": "136",
        "name": "『会员专区』",
        "rank": "1"
    },
    {
        "fid": "151",
        "fup": "108",
        "name": "『WEB安全』",
        "rank": "1"
    },
    {
        "fid": "172",
        "fup": "79",
        "name": "『区块链安全』",
        "rank": "0"
    },
    {
        "fid": "173",
        "fup": "41",
        "name": "看雪安全接入",
        "rank": "0"
    }
];

// 三级版块
function forum_tree(forumlist, template) {
	var template = template || '<option value="{fid}">{tab}{name}</option>'+"\r\n";
	var s = '';
	var forumlist1 = forumlist.filter(function(v) {return v.fup == 0});
	for(var i1=0; i1<forumlist1.length; i1++) {
		var v1 = forumlist1[i1];
		s += '►'+xn.template(template, {fid: v1.fid, name: v1.name, tab: "　"});
		var forumlist2 = forumlist.filter(function(v2) {return v2.fup == v1.fid});
		for(var i2=0; i2<forumlist2.length; i2++) {
			var v2 = forumlist2[i2];
			s += xn.template(template, {fid: v2.fid, name: v2.name, tab: "　　"});
			var forumlist3 = forumlist.filter(function(v3) {return v3.fup == v2.fid});
			for(var i3=0; i3<forumlist3.length; i3++) {
				var v3 = forumlist3[i3];
				s += xn.template(template, {fid: v3.fid, name: v3.name, tab: "　　　　"});
			}

		}
	}
	return s;
}


// 版主管理：移动 / moderator : move
$('.mod-button button.move').off('click').on('click', function() {
	var modtid = $('input[name="modtid"]').checked();
	if(modtid.length == 0) return $.alert(lang.please_choose_thread);
	var select = '<select name="fid">'+forum_tree(forumlist)+'</select>';
	$.confirm(lang.move_forum, function() {
		var tids = xn.implode('_', modtid);
		var newfid = $('select[name="fid"]').val();
		$.xpost(xn.url('mod-move-'+tids+'-'+newfid), function(code, message) {
			if(code != 0) return $.alert(message);
			$.alert(message).delay(1000).location('');
		});
	}, {'body': '<p>'+lang.choose_move_forum+'：'+select+'</p>'});
})

</script><script>

// 版主管理：审核
$('.mod-button button.audit').on('click', function() {
	var modtid = $('input[name="modtid"]').checked();
	if(modtid.length == 0) return $.alert(lang.please_choose_thread);
	var radios = xn.form_radio('audit', {"1": "审核通过", "2": "审核不通过"});
	$.confirm('审核主题', function() {
		var tids = xn.implode('_', modtid);
		var audit = $('input[name="audit"]').checked();
		var postdata = {audit: audit};
		$.xpost(xn.url('mod-audit-'+tids), postdata, function(code, message) {
			if(code != 0) return $.alert(message);
			$.alert(message).delay(1000).location('');
		});
	}, {'body': '<p>'+'审核选项'+'：'+radios+'</p>'});
})

</script>
<script>

$(function() {
	// 版主管理：删除 / moderator : delete
	$('.mod-button button.delete').off('click').on('click', function() {
		var modtid = $('input[name="modtid"]').checked();
		if(modtid.length == 0) return $.alert(lang.please_choose_thread);
		var radios = '';
				//var htmladd = '<br><br><label class="text-small"><input type="checkbox" name="logic" value="0" /> 物理删除</label>';
		//htmladd += '<br><label class="text-small"><input type="checkbox" name="logic" value="0" /> 恢复删除</label>';
		$.confirm(xn.lang('confirm_delete_thread', {n:modtid.length}) + '<br><br>'+radios, function() {
			var tids = xn.implode('_', modtid);
			var type = $('input[name="type"]').checked();
			$.xpost(xn.url('mod-delete-'+tids), {type: type}, function(code, message) {
				if(code != 0) return $.alert(message);
				$.alert(message).delay(1000).location('');
			});
		});
	})

	// 恢复逻辑删除的帖子
	$('body').on('click', '.post_recover', function() {
		var jthis = $(this);
		var href = jthis.data('href');
		var isfirst = jthis.attr('isfirst');
		if(window.confirm('确定恢复删除的帖子？')) {
			$.xpost(href, function(code, message) {
				var isfirst = jthis.attr('isfirst');
				if(code == 0) {
					if(isfirst == '1') {
						$.location('forum-41.htm');
					} else {
						window.location.reload();
					}
				} else {
					$.alert(message);
				}
			});
		}
		return false;
	});

})

</script>

<div class="modal fade appeal" id="appeal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
                <div class="modal-content">
                        <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">×</span>
                        </button>
                        <h4 class="modal-title" id="exampleModalLabel">求助问答申诉</h4>
                        </div>
                        <form id="form_appeal" action="https://bbs.pediy.com/post-appeal.htm" method="post">
	                        <div class="modal-body">
	                                <div class="form-group">
	                                	<input id="pid" name="pid" value="0" type="hidden">
	                                        <textarea class="form-control" id="brief" name="brief" rows="6" placeholder="请填写内容，注意: 请写明申诉的原因"></textarea>
	                                </div>
	                        </div>
	                        <div class="modal-footer">
	                                <button id="appeal_submit" type="button" class="btn btn-primary" data-loading-text="正在提交...">申请提交</button>
	                        </div>
	                </form>
                </div>
        </div>
</div><div class="modal fade report" id="report" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
                <div class="modal-content">
                        <div class="modal-header">
                       
                        <h4 class="modal-title" id="exampleModalLabel">举报此帖</h4>
                         <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">×</span>
                        </button>
                        </div>
                        <form id="form_report" action="https://bbs.pediy.com/post-report.htm" method="post">
                                <div class="modal-body">
                                        <div class="form-group">
                                                <input id="tid" name="tid" value="0" type="hidden">
                                                <input id="pid" name="pid" value="0" type="hidden">
                                                <textarea class="form-control" id="brief" name="brief" rows="6" placeholder="请填写内容，注意: 请确认您所举报此帖的内容涉及到语言挑衅和违犯论坛版规的内容， 版主将收到举报后审核该帖！"></textarea>
                                        </div>
                                </div>
                                <div class="modal-footer">
                                        <button id="report_submit" type="button" class="btn btn-primary" data-loading-text="正在提交...">发送报告</button>
                                </div>
                        </form>
                </div>
        </div>
</div>

<script src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/face.js.下载"></script>
<script src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/qqLevel.js.下载"></script>
<script>
var passport_domain = 'passport.kanxue.com';
// 回复 操作按钮 手机端 显示隐藏方法 开始
function mobile_more_operate(e){
	$(".mobile_more_operate").hide();
	$(e.target).siblings(".mobile_more_operate").fadeIn();
}
$(document).scroll(function(){
	$(".mobile_more_operate").hide();
})
$(document).on("click", function(e){

	if ($(e.target).parents(".mobile_more_operate_btn").length == 0 && !$(e.target).hasClass('mobile_more_operate_btn')) {
		$(".mobile_more_operate").hide();
	}
	
})
// 回复 操作按钮 手机端 显示隐藏方法 结束

function show_level(event) {
	var el = event.target;
	
	var usergid = $(el).attr("data-gid");
	$.tips('<span class="level-'+usergid+' level"></span>', $(el), {
		tips: [3, '#fff'],
		time: 2000
	});
}

function show_online_level(event) {
	var el = event.target;
	
	var userdesc = $(el).attr("data-desc");

	$.tips('<span class="text-muted">'+userdesc+'</span>', $(el), {
		tips: [3, '#fff'],
		time: 2000
	});
}
function online_time_imgs(v) {

	var online_time = $(v).data('online_time');
	var level = qqLevel.getLevel(online_time);
	var imgs = qqLevel.getImg(level, [
		'//'+passport_domain+'/pc/view/img/star_0.gif',
		'//'+passport_domain+'/pc/view/img/star.gif',
		'//'+passport_domain+'/pc/view/img/moon.gif',
		'//'+passport_domain+'/pc/view/img/sun.gif',
		'//'+passport_domain+'/pc/view/img/king.gif',
	]);
	var desc = qqLevel.getDesc(online_time);
	$(v).attr('data-desc', desc);
	$(v).html(imgs);
}
$(".post_online_time").each(function(k, v) {
	online_time_imgs(v)
})

// 快速回帖切换到高级回复时，编辑框文字保存一下来
$('.senior_reply').on('click', function(){
	var  quick_reply_message = $('#quick_reply_form').find('#message').val().trim();

	// quick_reply_message = quick_reply_message.replace(/\[em_([0-9]+)\]/g, '<img src="/view/img/face/$1.gif" class="face" style="cursor: pointer;">');
	
	function senior_reply_pdata(return_obj) {
		$.pdata('quick_reply_message', quick_reply_message);
		return return_obj();
	}
	function senior_reply_return(){
		window.location.href= 'post-create-253450.htm';
	};
	senior_reply_pdata(senior_reply_return);
	
})






function shareTo(stype){
	var ftit = '';
	var flink = '';
	var lk = '';
	//获取文章标题
	ftit = $('.subject').text();
	//获取网页中内容的第一张图片
	flink = $('.message img').eq(0).attr('src');

	if(typeof flink == 'undefined'){
		flink='';
	}
	//当内容中没有图片时，设置分享图片为网站logo
	if(flink == ''){
		lk = 'http://bbs.pediy.com/plugin/kanxue/img/kanxuelogo.png';
	}
	//如果是上传的图片则进行绝对路径拼接
	if(flink.indexOf('upload/') != -1) {
		lk = 'http://bbs.pediy.com/'+flink;
	}
	//qq空间接口的传参
	if(stype=='qzone'){
		var iw=800; //弹出窗口的宽度;
		var ih=500; //弹出窗口的高度;
		var it = (window.screen.availHeight-30-ih)/4; //获得窗口的垂直位置;
		var il = (window.screen.availWidth-10-iw)/4; //获得窗口的水平位置;
		var openurl = 'https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url='+document.location.href+'?sharesource=qzone&title='+ftit+'&pics='+lk+'&summary='+document.querySelector('meta[name="description"]').getAttribute('content');
		window.open(openurl,"","height="+ih+", width="+iw+", top="+it+", left="+il);
	}
	//新浪微博接口的传参
	if(stype=='sina'){
		var iw=500; //弹出窗口的宽度;
		var ih=500; //弹出窗口的高度;
		var it = (window.screen.availHeight-30-ih)/4; //获得窗口的垂直位置;
		var il = (window.screen.availWidth-10-iw)/4; //获得窗口的水平位置;
		var openurl = 'http://service.weibo.com/share/share.php?url='+document.location.href+'?sharesource=weibo&title='+ftit+'&pic='+lk;
		window.open(openurl,"","height="+ih+", width="+iw+", top="+it+", left="+il);
	
	}
	//qq好友接口的传参
	if(stype == 'qq'){
		var iw=800; //弹出窗口的宽度;
		var ih=500; //弹出窗口的高度;
		var it = (window.screen.availHeight-30-ih)/4; //获得窗口的垂直位置;
		var il = (window.screen.availWidth-10-iw)/4; //获得窗口的水平位置;
		var openurl = 'http://connect.qq.com/widget/shareqq/index.html?url='+document.location.href+'?sharesource=qzone&title='+ftit+'&pics='+lk+'&summary='+document.querySelector('meta[name="description"]').getAttribute('content')+'&desc=看雪学院，一个有情怀的安全开发者交流的网站'
		window.open(openurl,"","height="+ih+", width="+iw+", top="+it+", left="+il);
	}
	//生成二维码给微信扫描分享，php生成，也可以用jquery.qrcode.js插件实现二维码生成
	if(stype == 'wechat'){
		
		$.tips('<img width="150" src="bbs_qrcode-http_3A_2F_2Fbbs_2epediy_2ecom_2Fthread_2d253450_2ehtm.htm">',$("#wxshare"),{ tips: [2, '#eee'],time: 5000});
	}
}
$(function() {
	var jform = $('#quick_reply_form');
	var jsubmit = $('#submit');
	jform.on('submit', function() {
		jform.reset();
		jsubmit.button('loading');
		var postdata = jform.serialize();
		$.xpost(jform.attr('action'), postdata, function(code, message) {
			if (code == 0) {
				var s = '<table>' + message + '</table>';
				var jtr = $(s).find('tr');
				jtr.insertBefore($('table.postlist tr').last());
				jsubmit.button('reset');
				$('#message').val('');

				// 楼层 +1
				var jfloor = jform.find('.floor');
				jfloor.html(xn.intval(jfloor.html()) + 1);

				// 回复数 +1
				var jposts = $('.posts');
				jposts.html(xn.intval(jposts.html()) + 1);

			} else if (code < 0) {
				$.alert(message);
				jsubmit.button('reset');
			} else {
				jform.find('[name="' + code + '"]').alert(message).focus();
				jsubmit.button('reset');
			}
		});
		return false;
	});


	//收藏功能
	var jfavorite = $('#favorite');
	var jlikes = $('#likes');
   
	jfavorite.on('click', function() {
		var likenum = jlikes.text();
		likenum_plus = parseInt(likenum) + 1;
		likenum_sub = parseInt(likenum) - 1;
		if(likenum_sub < 0) likenum_sub = 0;
		$.xpost('thread-favorite-253450.htm', function(code, message) {
			if(code == 0) {
				var s = '<a href="javascript:void(0)" title="取消收藏"><i class="icon-star-o" style="color: #0099ee;"></i>&nbsp;<span style="color: #0099ee;">已收藏</span></a>';
				jfavorite.html(s);
				jlikes.text(likenum_plus);

			}else if(code == 1) {
				var s = '<a href="javascript:void(0)" title="点我收藏"><i class="icon-star-o"></i>&nbsp;收藏</a>';
				jfavorite.html(s);
				jlikes.text(likenum_sub);
			} else {
				$.alert(message);
			}
		});
		return false;
	});
	// 缩放图片，适应屏幕大小。
	function resize_image() {
		var jmessagelist = $('div.message');
		var first_width = jmessagelist.width(); // 815 : 746; //  734 746
		jmessagelist.each(function() {
			var jdiv = $(this);
			var maxwidth = jdiv.attr('isfirst') ? first_width : first_width - 79; //  734 746
			var jmessage_width = Math.min(jdiv.width(), maxwidth);
			jdiv.find('img, embed, iframe').each(function() {
				var jimg = $(this);
				//if(jimg.width() < 500) return;
				var img_width = this.org_width;
				var img_height = this.org_height;
				if (!img_width) {
					var img_width = jimg.width();
					var img_height = jimg.height();
					this.org_width = img_width;
					this.org_height = img_height;
				}
				//var percent = xn.min(100, xn.ceil((img_width / jmessage_width) * 100));
				if (img_width > jmessage_width) {
					if (this.tagName == 'IMG') {
						jimg.width(jmessage_width);
						jimg.css('height', 'auto');
					} else {
						jimg.width(jmessage_width);
						var height = (img_height / img_width) * jimg.width();
						jimg.height(height);
					}
				}

			});
			
			jdiv.find('p').each(function() {
				var jp = $(this);
				if($.trim(jp.text()) == '') {
					jp.css('line-height', '1');
				}
			});
		});
	}
	// resize_image();
	// $(window).on('resize', resize_image);


 	//---------by wang start------------------------//
	//取出tr的pid，赋值给tr使name为point_pid
	// $(".post").each(function() {
	// 	var cpid = $(this).attr("pid");
	// 	$(this).attr("id","point_"+ cpid);
	// });
	var url = window.location.toString();
	
	if(url.indexOf("#") != -1){
		var cpid = url.split("#")[1];
		if(cpid) {
			$(".post").each(function(k,v) {
				if($(v).attr("pid") == cpid) {
					var t = $(this).offset() ? $(this).offset().top : 0;
					//$("#frame_right").scrollTop(t);
					$("html,body").animate({scrollTop:t},800)
				}
				
			});
			
		}
	}
	
	//------------by wang end----------------------------//


	
	// 输入框自动伸缩
	var jmessage = $('#message');
	jmessage.on('focus', function() {
		if (jmessage.t) {
			clearTimeout(jmessage.t);
			jmessage.t = null;
		}
		jmessage.css('height', '6rem');
	});
	jmessage.on('blur', function() {
		jmessage.t = setTimeout(function() {
			jmessage.css('height', '2.5rem');
		}, 1000);
	});

	$('#nav_pc li[fid="41"]').addClass('active');
	$('#nav_mobile li[fid="41"]').addClass('active');

	 $(function(){
		$('.emotion').qqFace({
			id : 'facebox',
			assign:'message',
			path:'view/img/face/'
		});
	});

	$("div.message img").css("cursor","pointer");
	$("div.message img").on("click",function() {
		if (window.innerWidth > 768) {
			var img_src = $(this).attr("src");
			window.open(img_src);
		}
	})
	setTimeout(function() {
		$("div.message img").each(function(index, element) {
			if ($(element).width() >= 100) {
				$(element).addClass("div_message_boxShadow");
			}
		})
	}, 2000);
	
	function IsPC() {
		var userAgentInfo = navigator.userAgent;
		var Agents = ["Android", "iPhone", "SymbianOS", "Windows Phone", "iPad", "iPod"];
		var flag = true;
		for (var v = 0; v < Agents.length; v++) {
			if (userAgentInfo.indexOf(Agents[v]) > 0) {
				flag = false;
				break;
			}
		}
		return flag;
	}

	// 弹出分享页面

	$(".bbsshare_btn").on('click', function(event){
		$.open({
			type: 1,
			title: false,
			content: $('.bd-bbsshare-modal-sm'),
			offset: 'auto',
			shadeClose: false,
			shade: false,

		});

	});

	if ($.pdata('collapse_reward') && $.pdata('collapse_reward') == 1) {
		$("#collapse_reward").removeClass('show');
		$(".collapse_btn").find("span").html("展开");
		$(".collapse_btn").find("i").removeClass("icon-angle-up").addClass("icon-angle-down");
		
	} else if( $.pdata('collapse_reward') == 0 || $.pdata('collapse_reward') == '') {
		$("#collapse_reward").addClass('show');
		$(".collapse_btn").find("span").html("收起");
		$(".collapse_btn").find("i").removeClass("icon-angle-down").addClass("icon-angle-up");
	}
	$("#collapse_reward").on('hide.bs.collapse', function () {
		$.pdata('collapse_reward', 1)
		$(".collapse_btn").find("span").html("展开");
		$(".collapse_btn").find("i").removeClass("icon-angle-up").addClass("icon-angle-down");
		
		
	})
	$("#collapse_reward").on('show.bs.collapse', function () {
		$.pdata('collapse_reward', 0)
		$(".collapse_btn").find("span").html("收起");
		$(".collapse_btn").find("i").removeClass("icon-angle-down").addClass("icon-angle-up");
		
	})
	
});


</script>

<div style="position: absolute;top: 50%;left: 50%;transform: translateX(-50%) translateY(-50%);" class="modal fade bd-example-modal-sm" id="wxpay_modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm">

    <div class="modal-content text-center ">
        <div class="" style="height: 55px; border-bottom: 1px solid rgba(204, 204, 204, 0.26); background-image: url(./view/img/pay_s.png); background-repeat: no-repeat; background-position: bottom center;">
            <button type="button" class="close mr-3" style="margin-top: 1.5rem;" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">×</span>
                <span class="sr-only">Close</span>
            </button>
        </div>
        <div class="wxpay_modal_body">

        </div>
    </div>
</div>
</div>
<script>
var jpay_form = $('#pay_kx');
var jkxpay = $('.kx-pay');
var rid = 0;
var check_handle = null;

function topay(){
    clearInterval(check_handle);
    check_handle = null;
    var valtype = $("input[name='reward_type']:checked").val();
    var rmbstype = $("input[name='reward_rmbs']:checked").val();
    if(!valtype) { alert('请您选择一个支付方式!'); return false; }
    if(rmbstype < 1) {
        alert("打赏金额不能少于1元");
        return false;
    }else if(valtype == 1){
        if(_is_weixin) {
            $.alert('请用其它浏览器打开再用赞赏功能!');
            return false;
        }

        window.Popup = window.open('about:blank', '_blank','width='+window.screen.width+',height='+window.screen.height+', ...');
        var ptdata = jpay_form.serialize();
        jkxpay.button('loading');
        $.xpost('reward_pay-charge.htm', ptdata, function(code, message) {
            if(code == 0) {
                Popup.blur();
                Popup.opener.focus();
                Popup.location = 'reward_pay-reward_alipay-'+ message +'.htm';
                jkxpay.button('reset');
                $('.reward').modal('hide');
                check_setInterval(message);
            } else if(code < 0) {
                Popup.close();
                alert(message);
                jkxpay.button('reset');
            } else {
                Popup.close();
                alert(message);
                jkxpay.button('reset');
            }
        });
        return false;
    }else if(valtype == 2){
        var postdata = jpay_form.serialize();
        jkxpay.button('loading');
        $.xpost('reward_pay-reward_remainder.htm', postdata, function(code, message) {
            if(code == 0) {
                $.alert(message);
                jkxpay.button('reset');
                $('.reward').modal('hide');
                window.location.reload();
            } else if(code < 0) {
               $.alert(message);
                jkxpay.button('reset');
            } else {
                $.alert(message);
                jkxpay.button('reset');
            }
        });
        return false;
    }else if(valtype == 3) {

        // $('#wxpay_modal').modal({backdrop: 'static', keyboard: false});
        var ptdata = jpay_form.serialize();
        jkxpay.button('loading');
        $.xpost('reward_pay-charge.htm', ptdata, function(code, message) {
            if(code == 0) {
                //微信支付
                $.xget('reward_pay-wxpay-'+ message +'.htm',function(cd,msg) {
                    if(cd == 0) {
                        check_setInterval(message);

                        //$(".wxpay_code img").attr('src', 'http://paysdk.weixin.qq.com/example/qrcode.php?data='+ msg);
                        var wx_img = '<div class="pt-3 text-center"><img src="./view/img/wxpay2.png" style="height: 40px;"></div>\
                        <div class="modal-body wxpay_code pt-3 pb-3">\
                            <div  style="width: 80%;text-align:center; margin: 0 auto;">\
                                <span class="wx_img"><img alt="扫码支付" style="width: 60%;" src="//bbs.pediy.com/reward_pay-wxcode-'+ xn.urlencode(msg) +'.htm"/></span>\
                                <span class="pay_success_shadow" style="display: none;"></span>\
                            </div>\
                            <div class="text-center text-muted mt-3">打开微信扫一扫，即可完成支付</div>\
                            <div class="swal2-icon swal2-success swal2-animate-success-icon">\
                                <span class="swal2-success-line-tip "></span>\
                                <span class="swal2-success-line-long "></span></div></div>';  
                        $(".wxpay_modal_body").html(wx_img);
                        jkxpay.button('reset');
                        $(".reward").modal('hide');
                        $('#wxpay_modal').modal({backdrop: 'static', keyboard: false});
                        $('#wxpay_modal').modal('show');
                    } else {
                        $.alert(msg);
                        jkxpay.button('reset');
                    }
                })
                return false;
            } else {
                $.alert(message);
                jkxpay.button('reset');
            }
        });
      
        return false;

    }else{
        $('.reward').modal('hide');
        return false;
    }
}

function check_status(rid) {
  var val_type = $("input[name='reward_type']:checked").val();
  $.xpost('reward_pay-check.htm', {checkid: rid}, function(code, message) {
    if(code == 0) {
      if(val_type == 1) {
        Popup.close();
      }
      $.alert('恭喜您，赞赏成功！');
      setTimeout(function() {
                 window.location.reload();
      }, 3000);
      // if(check_handle) {
        clearInterval(check_handle);
        check_handle = null;
      // }
    } else {
      return false;
    }
  });
}

function check_setInterval(rid) {
  check_handle = setInterval(function() {
    check_status(rid);
  }, 3000);
}

window._is_weixin = function() {
  var _ua = window.navigator.userAgent.toLowerCase();
  if (_ua.match(/MicroMessenger/i) == 'micromessenger') {
      return true;
  } else {
      return false;
  }
}()


$("select.reward_reason").change(function(){

    console.log( $("select.reward_reason option:selected").val());
    var reward_reason = $("select.reward_reason option:selected").val()
    if (reward_reason != 0) {
        $(".reward_reason_textarea").val($("select.reward_reason option:selected").val());
    }
    
    
})

</script><script>
var jform_appeal = $('#form_appeal');
var appeal_submit = $('#appeal_submit');

appeal_submit.on('click', function() {
    jform_appeal.reset();
    appeal_submit.button('loading');
    var postdata = jform_appeal.serialize();
    
    $.xpost(jform_appeal.attr('action'), postdata, function(code, message) {
        if(code == 0) {
       	$.alert(message);
       	appeal_submit.button('reset');
       	setTimeout(function(){window.location.reload();
            }, 2000);
        } else {
    	$.alert(message);
    	appeal_submit.button('reset');
        }
    });
    return false;
});

 $('#appeal').on('show.bs.modal', function (event) {
	var button = $(event.relatedTarget)
	var pid = button.data('pid');
	var modal = $(this);
	modal.find('.modal-body #pid').val(pid);

})
</script><script>

var jform_report = $('#form_report');
var report_submit = $('#report_submit');

report_submit.on('click', function() {
    jform_report.reset();
    report_submit.button('loading');
    var postdata = jform_report.serialize();
    
    $.xpost(jform_report.attr('action'), postdata, function(code, message) {
        if(code == 0) {
       	$.alert(message);
       	report_submit.button('reset');
       	setTimeout(function(){window.location.reload();
            }, 1000);
        } else {
    	$.alert(message);
    	report_submit.button('reset');
        }
    });
    return false;
});

$('#report').on('show.bs.modal', function (event) {
	var button = $(event.relatedTarget)
    var tid = button.data('tid');
    var pid = button.data('pid');
    var modal = $(this);

    modal.find('.modal-body #tid').val(tid);
    modal.find('.modal-body #pid').val(pid);
})

</script><!--游客下载附件关注微信公众号-->
<div class="modal fade download_code" id="download_code" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm" role="document">
                <div class="modal-content">
                        <div class="modal-header">
	                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	                                <span aria-hidden="true">×</span>
	                        </button>
	                        <h5 class="modal-title" id="exampleModalLabel">游客下载提示</h5>
                        </div>
                        <form id="form_download" action="https://bbs.pediy.com/thread-253450.htm" method="post" target="_blank">
                                <div class="modal-body text-center">
                                    <input id="aid" name="aid" value="0" type="hidden">
                                    <dl class="row">
                                    	<dd class="text-left" style="width:50%">
                                        	<div style="font-size:14px">
                                        		<div>1.请先关注公众号。</div>
                                        		<div>2.点击菜单"更多"。</div>
                                        		<div>3.选择获取下载码。</div>
                                        	</div>
                                    	</dd>
                                    	<dt><img src="./[原创] 剖析InfinityHook原理 掀起一场更激烈的攻与防恶战-『编程技术』-看雪安全论坛_files/wxgz.jpg" width="80%"></dt>
                                    </dl>
                                    <fieldset class="form-group">
                						<input class="form-control" type="text" id="download_code" name="download_code" placeholder="请输入下载码" value="">
                					</fieldset>
                                </div>
                                <div class="modal-footer">
                                        <button id="download_submit" type="button" class="btn btn-primary" data-loading-text="正在提交...">下载</button>
                                </div>
                        </form>
                </div>
        </div>
</div>

<script>

var jform_download = $('#form_download');
var jdownload_submit = $('#download_submit');

jdownload_submit.on('click', function() {
    jform_download.reset();
    jdownload_submit.button('loading');
    var postdata = jform_download.serialize();

    var aid2 = jform_download.find('.modal-body #aid').val();
    
    $.xpost(jform_download.attr('action'), postdata, function(code, message) {
        if(code == 0) {
	       	jdownload_submit.button('下载中...');
	       	var href = "attach-download-"+aid2+"-"+message+".htm";
		window.location = href;
		setTimeout(function() {
                    jdownload_submit.button('reset');
                    jform_download.find('.modal-body #download_code').val('');
                }, 1500);
		
        } else {
	    	$.alert(message);
	    	jdownload_submit.button('reset');
        }
    });
    return false;
});

$('#download_code').on('show.bs.modal', function (event) {
    var button = $(event.relatedTarget)
    var aid = button.data('aid');
    var modal = $(this);
    var down_action="attach-download_code-"+aid+".htm";

    modal.find('.modal-body #aid').val(aid);
    modal.find('#form_download').attr('action', down_action);
})

</script><script>
var page = '1';
$('#thumb').click(function() {
	var threadid = '253450';
	var type = 1;
	var num = parseInt($('#thread_thumb_num').text());
	var postdata = 'threadid=' + threadid + '&type=1&page='+page;
	var that = this;
	$.xpost('thumbs_up-thumbs.htm', postdata, function(code, message) {
		if(code == 0) {
			var s = '<i class="icon-thumbs-o-up" style="color: #0099ee;"></i>&nbsp;<span style="color: #0099ee;">已赞</span>';
			$('#thumb').children('a').html(s);
			$('#thread_thumb_num').text(num + 1);
			$.tips('感谢您的赏识！您已向主题帖作者发送 '+message+' 个雪币，表达感谢', $(that), {
				tips:1,
				time: 2000,
				tips: [1,'#748691']

			});
		} else {
			$.tips(message, $(that), {
				tips: 1,
				time: 2000,
				tips: [1,'#748691']

			});
		}
	})
})
</script>

<script>
$(document).on('click','.reply_thumb',function(){
	
	var index = $('.reply_thumb').index(this);
	var threadid = $(this).find('input').eq(0).val();
	var praised_uid = $(this).find('input').eq(1).val();
	var pid = $(this).find('input').eq(2).val();
	var num = parseInt($('.thumb_num').eq(index).text());
	
	var postdata = 'threadid=' + threadid + '&praised_uid=' + praised_uid +'&pid=' + pid + '&type=2&page='+page;
	var that = this;
	$.xpost('thumbs_up-thumbs.htm', postdata, function(code, message) {
    	if(code == 0) {
            var s = '<i class="icon-thumbs-o-up" style="color: #0099ee;"></i>';
            var new_num = num + 1;
            $('.reply_thumb').eq(index).children('a').html(s);
	    $('.thumb_num').eq(index).text(num + 1);
	    	$.tips('英雄所见略同！您已向该回帖发送  '+message+' 个雪币，表达感谢', $(that), {
			tips: [1,'#748691'],
			time: 4000,
			
		});
        } else {
		$.tips(message, $(that), {
			
			time: 4000,
			tips: [1,'#748691']
		});
	}
	})
})
</script><script>
xn_read_unread({"253450": "1572605743"}, 253450);
</script><script>
jsearch_form = $('#search_form');
jsearch_form.on('submit', function() {
	var keyword = jsearch_form.find('input[name="keyword"]').val();
	var url = xn.url('search-'+xn.urlencode(keyword));
	window.location = url;
	return false;
});
</script><script>
// 语法高亮
if($('div.message pre').length > 0) {
	$.require_css('plugin/xn_syntax_hightlighter/syntax_hightlighter/syntax.css');
	$.require('plugin/xn_syntax_hightlighter/syntax_hightlighter/syntax.js', function() {
		SyntaxHighlighter.all();
	});
}
</script>

<div id="sel-ext-win" class="sel-text-win" style="display: none;"></div><div class="layui-layer-move"></div></body></html>